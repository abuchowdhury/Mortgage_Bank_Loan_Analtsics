
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Mortgage Bank Loan Analytics}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    # Mortgage Loans Analytics
Banks can now use mortgage loan analytics using Data Science techniques. The system can provide detail information of the mortgage loans and the mortgage loan markets. It is a powerful tool for mortgage brokers to seek counterparties and generate trading interests and is useful for the CFOs to conduct what-ifs scenarios on the balance sheets.

Fill in the follow fields in Loan file template: 

•	Loan ID: to identify the special loan
•	Loan Type: to indicate the loan if fixed rate, or balloon loan , or ARM, or AMP (alternative mortgage product).
•	Balance:
•	Loan program type: to indicate conforming loan, FHA/VA loan, Jumbo loan or sub-prime loan
•	Current coupon rate:
•	Amortization type: the original amortization term
•	Maturity: the maturity loan (the remaining term of the loan)
•	FICO Score: the updated fico score
•	LTV: the current loan to value ratio
•	Loan Size: the loan amount of the loan
•	Loan origination location (City & Zip)
•	Unit Types (Types of property)

    The Random Forest model gave the best result on each of the four
evaluation criteria used to evaluate the models. The Random Forest model
is mortgage applications per day perform best, then Decision Tree model.
The SVR model scored is the worse, SVM on a second place. The percent
error of the Random Forest model is around of the actual amount of
mortgage applications per day. Linear Regression, Logistic Regression
Random Forests (RF) Support Vector Regression (SVR) Support Vector
Machine (SVM) k-Nearest Neighbors Decision Tree Classifier

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{datetime}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        
        \PY{k+kn}{import} \PY{n+nn}{os}                             \PY{c+c1}{\PYZsh{} Library to do things on the filesystem}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}                   \PY{c+c1}{\PYZsh{} Super cool general purpose data handling library}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}       \PY{c+c1}{\PYZsh{} Standard plotting library}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}                    \PY{c+c1}{\PYZsh{} General purpose math library}
        \PY{k+kn}{from} \PY{n+nn}{IPython}\PY{n+nn}{.}\PY{n+nn}{display} \PY{k}{import} \PY{n}{display}   \PY{c+c1}{\PYZsh{} A notebook function to display more complex data (like tables)}
        \PY{k+kn}{import} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{as} \PY{n+nn}{stats}  
        
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{kurtosis}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{skew}
        
        
        \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/scripts/mwb2014.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{header}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cp1252}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{data}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 2501 entries, 0 to 2500
Data columns (total 24 columns):
First Name                2501 non-null object
Last Name                 2501 non-null object
City                      2501 non-null object
State                     2501 non-null object
Zip                       2501 non-null int64
Loan Amount               2501 non-null float64
Estimated Value           2501 non-null int64
Loan Purpose              2501 non-null object
Qualification FICO        2501 non-null int64
Is Primary Wage Earner    2501 non-null bool
Income Type               2501 non-null object
Asset Docs                2501 non-null object
Occupancy                 1846 non-null object
Unit Type                 2501 non-null object
Loan Type                 2501 non-null object
Lender Name               2501 non-null object
Created Date              2501 non-null object
Time                      2501 non-null object
Fix                       2501 non-null bool
ARM                       2501 non-null bool
CLTV                      2501 non-null float64
Loan Number               2501 non-null object
Loan Officer Name         2501 non-null object
LoanInMonth               2501 non-null int64
dtypes: bool(3), float64(2), int64(4), object(15)
memory usage: 417.7+ KB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{n}{data}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}2}]:} (2501, 24)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{c+c1}{\PYZsh{} Print the 5th and 95th percentiles}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{quantile}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.05}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{quantile}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.05}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{quantile}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mf}{0.90}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{quantile}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mf}{0.90}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        
        \PY{n}{St}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NJ}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NY}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PA}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{St}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}DataFrame subsets by State}
        \PY{n}{ct\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{State}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}
        \PY{n}{fl\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{State}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}
        \PY{n}{ny\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{State}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NY}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}
        \PY{n}{nj\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{State}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NJ}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}
        \PY{n}{pa\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{State}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PA}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}
        
        
        \PY{c+c1}{\PYZsh{}Selecting data per column}
        \PY{n}{ct\PYZus{}lo\PYZus{}amount} \PY{o}{=} \PY{n}{ct\PYZus{}data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Last Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{City}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unit\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}
        \PY{n}{fl\PYZus{}lo\PYZus{}amount} \PY{o}{=} \PY{n}{fl\PYZus{}data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Last Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{City}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}
        \PY{n}{nj\PYZus{}lo\PYZus{}amount} \PY{o}{=} \PY{n}{nj\PYZus{}data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Last Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{City}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}
        \PY{n}{ny\PYZus{}lo\PYZus{}amount} \PY{o}{=} \PY{n}{ny\PYZus{}data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Last Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{City}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}
        \PY{n}{pa\PYZus{}lo\PYZus{}amount} \PY{o}{=} \PY{n}{pa\PYZus{}data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Last Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{City}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
          Zip  Loan Amount  Estimated Value  Qualification FICO  \textbackslash{}
0.05   7083.0     150000.0         205275.0               636.0   
0.95  11756.0     840000.0        1400000.0               803.0   

      Is Primary Wage Earner  Fix  ARM  CLTV  LoanInMonth  
0.05                     0.0  0.0  0.0   0.0          3.0  
0.95                     1.0  1.0  1.0  96.0         56.0  
0.05    150000.0
0.95    840000.0
Name: Loan Amount, dtype: float64
0.1    200000.0
0.9    696500.0
Name: Loan Amount, dtype: float64
0.1    200000.0
0.9    696500.0
Name: Loan Amount, dtype: float64
['CT', 'FL', 'NJ', 'NY', 'PA']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}pandas\textbackslash{}core\textbackslash{}indexing.py:870: FutureWarning: 
Passing list-likes to .loc or [] with any missing label will raise
KeyError in the future, you can use .reindex() as an alternative.

See the documentation here:
https://pandas.pydata.org/pandas-docs/stable/indexing.html\#deprecate-loc-reindex-listlike
  return self.\_getitem\_lowerdim(tup)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{c+c1}{\PYZsh{}creating boxplot to see the distribution median and outliers}
        \PY{n}{plt}\PY{o}{.}\PY{n}{boxplot}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Boxplot showing distribution of index of accessbility of Loan Amount}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{l+m+mf}{0.1}\PY{p}{,}\PY{l+m+mi}{1000000}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price (\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_5_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    We can see that mid 50% loan amount between $340000 & $570000
    \section{Mortgage interest rates}\label{mortgage-interest-rates}

Mortgage interest rates have a significant impact on the amount of
mortgage applications. If the interest rates are low, the mortgages are
relatively cheaper for the borrower as they have to pay less interest,
which leads to an increased amount of mortgage applications. A high
mortgage interest rate means the mortgage borrower pays a high amount of
interest to the lender, which makes the mortgage less attractive for the
borrower. Interest rate changes have a significant impact on mortgage
applications, as was seen in November of last year, where a sudden
increase in interest rates led to a large peak in mortgage applications.
The main difference between the mortgages offered by these types of
companies lies in the mortgage interest rates. Even a small difference
in mortgage interest rates can often save or cost the borrower a vast
amount of money, due to the large sum of a mortgage.

In general, there are two types of mortgage interest rate: variable
rates (ARM) and fixed rates. Variable interest rates are generally lower
than fixed interest rates, but can change every month. Fixed interest
rates are slightly higher, but are fixed for a certain period of time. A
fixed interest rate is generally preferred when the mortgage interest
rates are expected to rise, or when the borrower wants to know its
monthly expenses upfront. A variable interest rate (ARM) is preferred
when interest rates are expected to decrease. If a financial institution
has a significantly higher interest rate than its competitors, it will
generally receive fewer mortgage applications as the independent
mortgage advisors will forward its customers to a different mortgage
lender.

Financial institutions sometimes increase their interest rates during
the summer months, and at the end of the year, as there is less
personnel available to handle the requests due to vacations and
holidays. With less personnel available they can handle less mortgage
requests, so in order to keep the processing time the same they choose
to reduce the input, by increasing the interest rates. Financial
institutions may also specifically keep interest rates low for mortgages
with a certain fixed interest period. Interest rate changes are not
always directly influenced by changes in the cost of lending, but can
have numerous reasons.

    Load US 10-Years Treasury Data

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{US10Y} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/scripts/US10Y.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{header}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{index\PYZus{}col}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DATE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cp1252}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{US10Y}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}5}]:}             RATE
        DATE            
        10/14/2014  2.21
        10/15/2014  2.15
        10/16/2014  2.17
        10/17/2014  2.22
        10/20/2014   2.2
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{US10Y}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{99999}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
        
        \PY{n}{US10Y}\PY{o}{=} \PY{n}{US10Y}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{n}{to\PYZus{}replace}\PY{o}{=}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{99999}\PY{p}{]}\PY{p}{,} \PY{n}{value}\PY{o}{=}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{]}\PY{p}{)}
        
        \PY{n}{US10Y}\PY{o}{=} \PY{n}{US10Y}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ffill}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{US10Y}\PY{o}{=} \PY{n}{US10Y}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RATE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{float64}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{US10Y}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
        \PY{n}{US10Y}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
        \PY{n}{US10Y}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
        \PY{n+nb}{type}\PY{p}{(}\PY{n}{US10Y}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Index: 1098 entries, 10/14/2014 to 12/27/2018
Data columns (total 1 columns):
RATE    1098 non-null float64
dtypes: float64(1)
memory usage: 17.2+ KB
<class 'pandas.core.frame.DataFrame'>
Index: 1098 entries, 10/14/2014 to 12/27/2018
Data columns (total 1 columns):
RATE    1098 non-null float64
dtypes: float64(1)
memory usage: 17.2+ KB

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}6}]:} pandas.core.frame.DataFrame
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{total\PYZus{}missing\PYZus{}rate}\PY{o}{=}\PY{n}{US10Y}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{}Checking for missing values}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{total\PYZus{}missing\PYZus{}rate}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
RATE    0
dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{US10Y}\PY{o}{.}\PY{n}{index} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{US10Y}\PY{o}{.}\PY{n}{index}\PY{p}{)}
        \PY{n}{monthly\PYZus{}rate\PYZus{}data}\PY{o}{=}\PY{n}{US10Y}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Interest Rate for 10 Years Treasury \PYZhy{} }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:2: FutureWarning: how in .resample() is deprecated
the new syntax is .resample({\ldots}).mean()
  

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_13_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{Displaying Monthly US Treasury 10 Years
interestRate}\label{displaying-monthly-us-treasury-10-years-interestrate}

Generally, when US 10 Years Treasury Rate fluctuates, that leads lenders
to adjust their internal bank rates accordingly. Also interest rates for
consumers varies on several risk factors, such as DTI (Debt to Income
Ratio), FICO Scores, Recent derogatory events on their credit history,
stable job history, W2 or 1099, Stated Income, Profit or Loss
Statements, Student Loans, Auto Payments, Credit utilization, Property
types, number of households, rental history, etc.

Interest Rate is currently historical low. In the short run rate may go
ups and down but in the long run rate will go up. As housing price goes
up, interest rate will go up to control the housing price.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{k+kn}{import} \PY{n+nn}{os}                             \PY{c+c1}{\PYZsh{} Library to do things on the filesystem}
         \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}                   \PY{c+c1}{\PYZsh{} Super cool general purpose data handling library}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}       \PY{c+c1}{\PYZsh{} Standard plotting library}
         \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}                    \PY{c+c1}{\PYZsh{} General purpose math library}
         \PY{k+kn}{from} \PY{n+nn}{IPython}\PY{n+nn}{.}\PY{n+nn}{display} \PY{k}{import} \PY{n}{display}   \PY{c+c1}{\PYZsh{} A notebook function to display more complex data (like tables)}
         \PY{k+kn}{import} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{as} \PY{n+nn}{stats}  
         
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
         \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{kurtosis}
         \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{skew}
         
         \PY{n}{loan\PYZus{}patterns} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         \PY{n}{loan\PYZus{}patterns}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
         
         \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
         \PY{l+s+sd}{We can create a histogram with 20 bins to show the distribution of purchasing patterns.\PYZsq{}\PYZsq{}\PYZsq{}}
         
         \PY{n}{loan\PYZus{}patterns\PYZus{}plot} \PY{o}{=} \PY{n}{loan\PYZus{}patterns}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.6}\PY{p}{,} \PY{n}{bins}\PY{o}{=}\PY{l+m+mi}{40}\PY{p}{,} \PY{n}{grid}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         
         \PY{n}{loan\PYZus{}patterns\PYZus{}plot} \PY{o}{=} \PY{n}{loan\PYZus{}patterns}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{)}
         
         \PY{n}{param} \PY{o}{=} \PY{n}{stats}\PY{o}{.}\PY{n}{norm}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{loan\PYZus{}patterns\PYZus{}plot}\PY{p}{)} 
         \PY{n}{x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{100000}\PY{p}{,} \PY{l+m+mi}{1250000}\PY{p}{)}      \PY{c+c1}{\PYZsh{} Linear spacing of 100 elements between 0 and 20.}
         \PY{n}{pdf\PYZus{}fitted} \PY{o}{=} \PY{n}{stats}\PY{o}{.}\PY{n}{norm}\PY{o}{.}\PY{n}{pdf}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{o}{*}\PY{n}{param}\PY{p}{)}    \PY{c+c1}{\PYZsh{} Use the fitted paramters to }
         \PY{n}{loan\PYZus{}patterns\PYZus{}plot}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.6}\PY{p}{,} \PY{n}{bins}\PY{o}{=}\PY{l+m+mi}{40}\PY{p}{,} \PY{n}{grid}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{density}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{legend}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} Fit a normal distribution to the data}
         \PY{c+c1}{\PYZsh{} Plot the histogram again}
         \PY{c+c1}{\PYZsh{} Plot some fancy text to show us what the paramters of the distribution are (mean and standard deviation)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{loan\PYZus{}patterns\PYZus{}plot}\PY{p}{)}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+m+mi}{800}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mu=}\PY{l+s+si}{\PYZpc{}0.2f}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{param}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{sigma=}\PY{l+s+si}{\PYZpc{}0.2f}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{param}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Plot a line of the fitted distribution over the top}
         \PY{c+c1}{\PYZsh{} Standard plot stuff}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{75}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{900}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1210000}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Loan Amount(\PYZdl{})}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Loan frequency}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Histogram with fitted normal distribution for Mortgage Bank Loan}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Density Plot with Rug Plot}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{excess kurtosis of normal distribution (should be 0): }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(} \PY{n}{kurtosis}\PY{p}{(}\PY{n}{loan\PYZus{}patterns\PYZus{}plot}\PY{p}{)} \PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{skewness of normal distribution (should be 0): }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(} \PY{n}{skew}\PY{p}{(}\PY{n}{loan\PYZus{}patterns\PYZus{}plot}\PY{p}{)} \PY{p}{)}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{mean : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{loan\PYZus{}patterns\PYZus{}plot}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{var  : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{var}\PY{p}{(}\PY{n}{loan\PYZus{}patterns\PYZus{}plot}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{skew : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{skew}\PY{p}{(}\PY{n}{loan\PYZus{}patterns\PYZus{}plot}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{kurt : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{kurtosis}\PY{p}{(}\PY{n}{loan\PYZus{}patterns\PYZus{}plot}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_15_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
excess kurtosis of normal distribution (should be 0): 10.20423896299732
skewness of normal distribution (should be 0): 1.6231675369974472
mean :  644.086535155362
var  :  30252.443004451427
skew :  1.6231675369974472
kurt :  10.20423896299732

    \end{Verbatim}

    The fancy text to show us what the parameters of the distribution are
(mean and standard deviation). We can create a histogram with 20 bins to
show the distribution of purchasing patterns. Fit a normal distribution
to the data then plot the histogram.

    Now we will compare Monthly Revenue, Monthly Closed Loan Number and
Active Mortgage Loan Originators. We will count number of MLO actively
closing loans on any given month.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{loan\PYZus{}patterns} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         \PY{n}{loan\PYZus{}patterns}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}11}]:}    Loan Amount Created Date
         0     506250.0   10/14/2014
         1     206250.0   10/14/2014
         2     648700.0   10/14/2014
         3     412750.0   10/14/2014
         4     522588.0   10/14/2014
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{mlo\PYZus{}num}\PY{o}{=}\PY{n}{data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Officer Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         \PY{n}{mlo\PYZus{}num}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DatetimeIndex}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{mlo\PYZus{}num} \PY{o}{=} \PY{n}{mlo\PYZus{}num}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{monthly\PYZus{}mlo\PYZus{}num}\PY{o}{=}\PY{n}{mlo\PYZus{}num}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{nunique}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{monthly\PYZus{}loan\PYZus{}num}\PY{o}{=}\PY{n}{data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LoanInMonth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         \PY{n}{monthly\PYZus{}loan\PYZus{}num}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
         \PY{n}{monthly\PYZus{}loan\PYZus{}num}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DatetimeIndex}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{monthly\PYZus{}loan\PYZus{}num} \PY{o}{=} \PY{n}{monthly\PYZus{}loan\PYZus{}num}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{monthly\PYZus{}loan\PYZus{}num\PYZus{}data}\PY{o}{=}\PY{n}{monthly\PYZus{}loan\PYZus{}num}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{last}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Mortgage Bank \PYZhy{} Total Sales by Month}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{legend}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         
         \PY{n}{loan\PYZus{}rev\PYZus{}data}\PY{o}{=}\PY{n}{data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         \PY{n}{loan\PYZus{}rev\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DatetimeIndex}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{loan\PYZus{}rev\PYZus{}data} \PY{o}{=} \PY{n}{loan\PYZus{}rev\PYZus{}data}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{monthly\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{o}{=}\PY{n}{loan\PYZus{}rev\PYZus{}data}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{n+nb}{sum}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Mortgage Bank \PYZhy{} Total Sales by Month}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{legend}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         
         \PY{n+nb}{type}\PY{p}{(}\PY{n}{monthly\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{p}{)}
         \PY{n}{monthly\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{o}{=} \PY{n}{loan\PYZus{}rev\PYZus{}data}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{how}\PY{o}{=}\PY{n+nb}{sum}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\_indexer,col\_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html\#indexing-view-versus-copy
  
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:8: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\_indexer,col\_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html\#indexing-view-versus-copy
  
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:10: FutureWarning: how in .resample() is deprecated
the new syntax is .resample({\ldots}).last()
  \# Remove the CWD from sys.path while we load stuff.
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:13: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\_indexer,col\_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html\#indexing-view-versus-copy
  del sys.path[0]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:15: FutureWarning: how in .resample() is deprecated
the new syntax is .resample({\ldots})..apply(<func>)
  from ipykernel import kernelapp as app
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:18: FutureWarning: how in .resample() is deprecated
the new syntax is .resample({\ldots})..apply(<func>)

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_19_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_19_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
Mortgage Bank Monthly Sales Since October 2014. Sales varies between 12M & 33M per months. Summer seems to be high sales seasons for the Mortgage bank.
Numbers of loans closed per months varies between 30 & 80.
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{monthly\PYZus{}loan\PYZus{}num}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{last}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{monthly\PYZus{}loan\PYZus{}num\PYZus{}data}\PY{o}{=} \PY{n}{monthly\PYZus{}loan\PYZus{}num}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{last}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}monthly\PYZus{}loan\PYZus{}num\PYZus{}plot = monthly\PYZus{}loan\PYZus{}num.resample(\PYZsq{}M\PYZsq{},how=\PYZsq{}count\PYZsq{}).plot(title=\PYZdq{}Mortgage Bank \PYZhy{} Total Sales by Month\PYZdq{},legend=True)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan origination Months}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{60}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loans per Months}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mortgage Bank Monthly Loan numbers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{k+kn}{from} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{lines} \PY{k}{import} \PY{n}{Line2D}
         \PY{n}{colors} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{lines} \PY{o}{=} \PY{p}{[}\PY{n}{Line2D}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{c}\PY{p}{,} \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{for} \PY{n}{c} \PY{o+ow}{in} \PY{n}{colors}\PY{p}{]}
         \PY{n}{labels} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Monthly closed loans}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Monthly Loan Revenue / 400000}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Monthly Active MLO * 4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{monthly\PYZus{}loan\PYZus{}num\PYZus{}data}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{monthly\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{o}{/}\PY{l+m+mi}{400000}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{monthly\PYZus{}mlo\PYZus{}num}\PY{o}{*}\PY{l+m+mi}{4}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{lines}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Comparing Monthly: Revenue, Closed\PYZus{}Loan\PYZus{}Num, Active\PYZus{}MLO\PYZus{}Num}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:1: FutureWarning: how in .resample() is deprecated
the new syntax is .resample({\ldots}).last()
  """Entry point for launching an IPython kernel.
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:2: FutureWarning: how in .resample() is deprecated
the new syntax is .resample({\ldots}).last()
  

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_21_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    As we know that number of producer is essential component in any given
business. MLO (Mortgage loan Originator) is core component in Mortgage
business. Many MLO works indedendently and interect directly to clients,
involve in marketting and grow their business. There could be many MLO
in Mortgage Bank, but active MLO generate more reverue for the bank. As
number of active MLO goes up, which will directly and positively impact
numbers of loan closed per month, eventually mortgage revenue will go
up. On the other hand, once number of active MLO goes down, mortgage
revenue and number of loan per month goes down as well. By visualizing
the graphs, we can see that monthly data of closed loan numbers ,
monthly revenue and active MLO numbers ber months, all moving at the
same direction.

Let's find out interest rate effect on Monthly Closed Loans and Monthly
Revenue.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{US10Y}\PY{o}{.}\PY{n}{index} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{US10Y}\PY{o}{.}\PY{n}{index}\PY{p}{)}
         \PY{n}{monthly\PYZus{}rate\PYZus{}data}\PY{o}{=}\PY{n}{US10Y}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Interest Rate for 10 Years Treasury \PYZhy{} }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{monthly\PYZus{}rate\PYZus{}data}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:2: FutureWarning: how in .resample() is deprecated
the new syntax is .resample({\ldots}).mean()
  

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
AxesSubplot(0.125,0.125;0.775x0.755)

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_23_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{monthly\PYZus{}rate\PYZus{}data}\PY{o}{=}\PY{n}{US10Y}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k+kn}{from} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{lines} \PY{k}{import} \PY{n}{Line2D}
         
         \PY{n}{colors} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{lines} \PY{o}{=} \PY{p}{[}\PY{n}{Line2D}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{c}\PY{p}{,} \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{for} \PY{n}{c} \PY{o+ow}{in} \PY{n}{colors}\PY{p}{]}
         \PY{n}{labels} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Monthly closed loans}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Monthly Loan Revenue / 400000}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{10 Years Interest Rate * 20}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{monthly\PYZus{}loan\PYZus{}num\PYZus{}data}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{monthly\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{o}{/}\PY{l+m+mi}{400000}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{monthly\PYZus{}rate\PYZus{}data}\PY{o}{*}\PY{l+m+mi}{20}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{lines}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Comparing Monthly: Revenue, Closed\PYZus{}Loan\PYZus{}Num, VS US 10 Year Treasury Rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:1: FutureWarning: how in .resample() is deprecated
the new syntax is .resample({\ldots}).mean()
  """Entry point for launching an IPython kernel.

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_24_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    We can see the strong positive correlation between Monthly Closed Loans
and Monthly Revenue. This graph also suggest that, as interest rates
goes down, banks monthly revenue and numbers of loans increases, and
when the Rates goes up, both Monthly Closed Loans and Monthly Revenue
for the Mortgage bank decline. Pearson correlation coefficient between
Monthly Interest \& Monthly loans Closed Data is -0.334, which clearly
proves that Monthly Interest Rates \& Monthly loans Closed Data is
negatively correlated.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{k}{def} \PY{n+nf}{pearson\PYZus{}r}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Compute Pearson correlation coefficient between two arrays.\PYZdq{}\PYZdq{}\PYZdq{}}
             \PY{c+c1}{\PYZsh{} Compute correlation matrix: corr\PYZus{}mat}
             \PY{n}{corr\PYZus{}mat} \PY{o}{=} \PY{n}{scipy}\PY{o}{.}\PY{n}{stats}\PY{o}{.}\PY{n}{pearsonr}\PY{p}{(}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} Return entry [0,1]}
             \PY{k}{return} \PY{n}{corr\PYZus{}mat}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{c+c1}{\PYZsh{}scipy.stats.pearsonr(x, y)}
         \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline 
         
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
         \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
         \PY{k+kn}{import} \PY{n+nn}{scipy}
         \PY{k+kn}{import} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{as} \PY{n+nn}{stats}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         \PY{k+kn}{import} \PY{n+nn}{sklearn}
         
         \PY{n}{fico} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{loan\PYZus{}amount}\PY{o}{=}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{cltv\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CLTV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{scipy}\PY{o}{.}\PY{n}{stats}\PY{o}{.}\PY{n}{pearsonr}\PY{p}{(}\PY{n}{cltv\PYZus{}data}\PY{p}{,} \PY{n}{fico}\PY{p}{)}
         \PY{n}{r\PYZus{}loan\PYZus{}amount\PYZus{}fico} \PY{o}{=} \PY{n}{scipy}\PY{o}{.}\PY{n}{stats}\PY{o}{.}\PY{n}{pearsonr}\PY{p}{(}\PY{n}{loan\PYZus{}amount}\PY{p}{,} \PY{n}{fico}\PY{p}{)}
         \PY{n}{r\PYZus{}cltv\PYZus{}data\PYZus{}fico} \PY{o}{=} \PY{n}{scipy}\PY{o}{.}\PY{n}{stats}\PY{o}{.}\PY{n}{pearsonr}\PY{p}{(}\PY{n}{cltv\PYZus{}data}\PY{p}{,} \PY{n}{fico}\PY{p}{)}
         \PY{n}{r\PYZus{}loan\PYZus{}amount\PYZus{}cltv\PYZus{}data} \PY{o}{=} \PY{n}{scipy}\PY{o}{.}\PY{n}{stats}\PY{o}{.}\PY{n}{pearsonr}\PY{p}{(}\PY{n}{loan\PYZus{}amount}\PY{p}{,} \PY{n}{cltv\PYZus{}data}\PY{p}{)}
         \PY{n}{r\PYZus{}monthly\PYZus{}loan\PYZus{}num\PYZus{}data\PYZus{}monthly\PYZus{}loan\PYZus{}rev} \PY{o}{=} \PY{n}{scipy}\PY{o}{.}\PY{n}{stats}\PY{o}{.}\PY{n}{pearsonr}\PY{p}{(}\PY{n}{monthly\PYZus{}loan\PYZus{}num\PYZus{}data}\PY{p}{,} \PY{n}{monthly\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Print the result}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pearson correlation coefficient between FICO and Loan\PYZus{}Amount: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{r\PYZus{}loan\PYZus{}amount\PYZus{}fico}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pearson correlation coefficient between FICO and CLTV: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{r\PYZus{}cltv\PYZus{}data\PYZus{}fico}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pearson correlation coefficient between Loan Amount and CLTV: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{r\PYZus{}loan\PYZus{}amount\PYZus{}cltv\PYZus{}data}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pearson correlation coefficient between Loan number and Loan Revenue: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{r\PYZus{}monthly\PYZus{}loan\PYZus{}num\PYZus{}data\PYZus{}monthly\PYZus{}loan\PYZus{}rev}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Pearson correlation coefficient between FICO and Loan\_Amount:  (0.007679913675807394, 0.7010628450657441)
Pearson correlation coefficient between FICO and CLTV:  (-0.03706042959216819, 0.06386772845856088)
Pearson correlation coefficient between Loan Amount and CLTV:  (-0.006696250380445668, 0.7378394696435531)
Pearson correlation coefficient between Loan number and Loan Revenue:  (array([0.84472037]), array([6.63988048e-15]))

    \end{Verbatim}

    Acquire 1000 pairs bootstrap replicates of the Pearson correlation
coefficient using the draw\_bs\_pairs() function you wrote in the
previous exercise for CLTV data VS Qualification FICO Data and Monthly
Loan\_num\_data VS. Monthly\_loan\_rev. Compute the 95\% confidence
interval for both using your bootstrap replicates. -We have created a
NumPy array of percentiles to compute. These are the 2.5th, and 97.5th.
By creating a list and convert the list to a NumPy array using
np.array(). For example, np.array({[}2.5, 97.5{]}) would create an array
consisting of the 2.5th and 97.5th percentiles.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{pearson\PYZus{}r0}\PY{o}{=}\PY{n}{scipy}\PY{o}{.}\PY{n}{stats}\PY{o}{.}\PY{n}{pearsonr}\PY{p}{(}\PY{n}{cltv\PYZus{}data}\PY{p}{,} \PY{n}{fico}\PY{p}{)}
         \PY{n}{pearson\PYZus{}r1}\PY{o}{=}\PY{n}{scipy}\PY{o}{.}\PY{n}{stats}\PY{o}{.}\PY{n}{pearsonr}\PY{p}{(}\PY{n}{loan\PYZus{}amount}\PY{p}{,} \PY{n}{fico}\PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{} Print results}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CLTV data VS Qualification FICO Data       :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{pearson\PYZus{}r0}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Monthly Loan\PYZus{}Amount VS. FICO Data          :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{pearson\PYZus{}r1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
CLTV data VS Qualification FICO Data       : (-0.03706042959216819, 0.06386772845856088)
Monthly Loan\_Amount VS. FICO Data          : (0.007679913675807394, 0.7010628450657441)

    \end{Verbatim}

    \section{Random Walk}\label{random-walk}

Are Interest Rates or Monthly Loan Returns Prices a Random Walk?

Most returns prices follow a random walk (perhaps with a drift). We will
look at a time series of Monthly Sales Revenue, and run the 'Augmented
Dickey-Fuller Test' from the statsmodels library to show that it does
indeed follow a random walk. With the ADF test, the "null hypothesis"
(the hypothesis that we either reject or fail to reject) is that the
series follows a random walk. Therefore, a low p-value (say less than
5\%) means we can reject the null hypothesis that the series is a random
walk. Print out just the p-value of the test
(adfuller\_loan\_rev\_data{[}0{]} is the test statistic, and
adfuller\_loan\_rev\_data{[}1{]} is the p-value). Print out the entire
output, which includes the test statistic, the p-values, and the
critical values for tests with 1\%, 10\%, and 5\% levels.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{c+c1}{\PYZsh{} Import the adfuller module from statsmodels}
         \PY{k+kn}{from} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{tsa}\PY{n+nn}{.}\PY{n+nn}{stattools} \PY{k}{import} \PY{n}{adfuller}
         
         \PY{n}{loan\PYZus{}rev\PYZus{}data}\PY{o}{=}\PY{n}{data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         \PY{n}{loan\PYZus{}rev\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DatetimeIndex}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{loan\PYZus{}rev\PYZus{}data} \PY{o}{=} \PY{n}{loan\PYZus{}rev\PYZus{}data}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}monthly\PYZus{}loan\PYZus{}rev\PYZus{}data=loan\PYZus{}rev\PYZus{}data.resample(\PYZsq{}M\PYZsq{}, how=sum).plot(title=\PYZdq{}Mortgage Bank \PYZhy{} Total Sales by Month\PYZdq{},legend=True)}
         
         
         \PY{n}{monthly\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{o}{=} \PY{n}{loan\PYZus{}rev\PYZus{}data}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{monthly\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} Run the ADF test on the monthly\PYZus{}loan\PYZus{}rev\PYZus{}data series and print out the results}
         \PY{n}{adfuller\PYZus{}loan\PYZus{}rev\PYZus{}data} \PY{o}{=} \PY{n}{adfuller}\PY{p}{(}\PY{n}{monthly\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{autolag}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AIC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{adfuller\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} Just print out the p\PYZhy{}value}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The p\PYZhy{}value of the test on loan\PYZus{}rev is: }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{adfuller\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{ Print in different format}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Results of Dickey\PYZhy{}Fuller Test:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{dfoutput} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{adfuller\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{4}\PY{p}{]}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Statistic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p\PYZhy{}value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}Lags Used}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Observations Used}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{k}{for} \PY{n}{key}\PY{p}{,}\PY{n}{value} \PY{o+ow}{in} \PY{n}{adfuller\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{]}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{dfoutput}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Critical Value (}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{k}{key}] = value
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{dfoutput}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
            Loan Amount
date                   
2014-10-31  13039283.00
2014-11-30  16097733.00
2014-12-31  29077334.00
2015-01-31  18361520.00
2015-02-28  22995652.00
2015-03-31  23113902.00
2015-04-30  20157614.00
2015-05-31  26908603.00
2015-06-30  27168128.00
2015-07-31  31152388.00
2015-08-31  22721130.00
2015-09-30  22568772.00
2015-10-31  20532294.94
2015-11-30  15435085.00
2015-12-31  17803144.78
2016-01-31  14742871.44
2016-02-29  20964720.18
2016-03-31  25067907.95
2016-04-30  23077636.38
2016-05-31  16694015.01
2016-06-30  23292710.02
2016-07-31  19373856.81
2016-08-31  27304951.97
2016-09-30  25483878.38
2016-10-31  25610530.03
2016-11-30  22040021.11
2016-12-31  19233711.25
2017-01-31  19737307.19
2017-02-28  19171063.13
2017-03-31  26688922.51
2017-04-30  16037800.83
2017-05-31  30369888.45
2017-06-30  18650153.57
2017-07-31  19215442.75
2017-08-31  23264862.50
2017-09-30  13478278.90
2017-10-31  26391170.94
2017-11-30  22447025.19
2017-12-31  21467493.56
2018-01-31  28767095.56
2018-02-28  26088192.50
2018-03-31  20234996.50
2018-04-30  20860204.00
2018-05-31  24272704.72
2018-06-30  31437031.56
2018-07-31  17767103.14
2018-08-31  19631636.90
2018-09-30  16198070.00
2018-10-31  23847863.16
2018-11-30  23346017.53
2018-12-31  13805150.00
(-4.49967715626648, 0.00019690419763896495, 10, 40, \{'1\%': -3.6055648906249997, '5\%': -2.937069375, '10\%': -2.606985625\}, 1307.285137861741)
The p-value of the test on loan\_rev is: 0.00019690419763896495

 Print in different format
Results of Dickey-Fuller Test:
Test Statistic                 -4.499677
p-value                         0.000197
\#Lags Used                     10.000000
Number of Observations Used    40.000000
Critical Value (1\%)            -3.605565
Critical Value (5\%)            -2.937069
Critical Value (10\%)           -2.606986
dtype: float64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:5: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\_indexer,col\_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html\#indexing-view-versus-copy
  """

    \end{Verbatim}

    According to this test, p-value is very low (lower than 0.05). We reject
the hypothesis that monthly\_loan\_rev\_data follow a random walk.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{loan\PYZus{}rev\PYZus{}data}\PY{o}{=}\PY{n}{data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         \PY{n}{loan\PYZus{}rev\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DatetimeIndex}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{loan\PYZus{}rev\PYZus{}data} \PY{o}{=} \PY{n}{loan\PYZus{}rev\PYZus{}data}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}monthly\PYZus{}loan\PYZus{}rev\PYZus{}data=loan\PYZus{}rev\PYZus{}data.resample(\PYZsq{}M\PYZsq{}, how=sum).plot(title=\PYZdq{}Mortgage Bank \PYZhy{} Total Sales by Month\PYZdq{},legend=True)}
         
         
         \PY{n}{monthly\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{o}{=} \PY{n}{loan\PYZus{}rev\PYZus{}data}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{monthly\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} Run the ADF test on the monthly\PYZus{}loan\PYZus{}rev\PYZus{}data series and print out the results}
         \PY{n}{adfuller\PYZus{}loan\PYZus{}rev\PYZus{}data} \PY{o}{=} \PY{n}{adfuller}\PY{p}{(}\PY{n}{monthly\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{autolag}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AIC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{adfuller\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} Just print out the p\PYZhy{}value}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The p\PYZhy{}value of the test on loan\PYZus{}rev is: }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{adfuller\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{ Print in different format}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Results of Dickey\PYZhy{}Fuller Test:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{dfoutput} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{adfuller\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{4}\PY{p}{]}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Statistic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p\PYZhy{}value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}Lags Used}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Observations Used}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{k}{for} \PY{n}{key}\PY{p}{,}\PY{n}{value} \PY{o+ow}{in} \PY{n}{adfuller\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{]}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{dfoutput}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Critical Value (}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{k}{key}] = value
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{dfoutput}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
            Loan Amount
date                   
2014-10-31  13039283.00
2014-11-30  16097733.00
2014-12-31  29077334.00
2015-01-31  18361520.00
2015-02-28  22995652.00
2015-03-31  23113902.00
2015-04-30  20157614.00
2015-05-31  26908603.00
2015-06-30  27168128.00
2015-07-31  31152388.00
2015-08-31  22721130.00
2015-09-30  22568772.00
2015-10-31  20532294.94
2015-11-30  15435085.00
2015-12-31  17803144.78
2016-01-31  14742871.44
2016-02-29  20964720.18
2016-03-31  25067907.95
2016-04-30  23077636.38
2016-05-31  16694015.01
2016-06-30  23292710.02
2016-07-31  19373856.81
2016-08-31  27304951.97
2016-09-30  25483878.38
2016-10-31  25610530.03
2016-11-30  22040021.11
2016-12-31  19233711.25
2017-01-31  19737307.19
2017-02-28  19171063.13
2017-03-31  26688922.51
2017-04-30  16037800.83
2017-05-31  30369888.45
2017-06-30  18650153.57
2017-07-31  19215442.75
2017-08-31  23264862.50
2017-09-30  13478278.90
2017-10-31  26391170.94
2017-11-30  22447025.19
2017-12-31  21467493.56
2018-01-31  28767095.56
2018-02-28  26088192.50
2018-03-31  20234996.50
2018-04-30  20860204.00
2018-05-31  24272704.72
2018-06-30  31437031.56
2018-07-31  17767103.14
2018-08-31  19631636.90
2018-09-30  16198070.00
2018-10-31  23847863.16
2018-11-30  23346017.53
2018-12-31  13805150.00
(-4.49967715626648, 0.00019690419763896495, 10, 40, \{'1\%': -3.6055648906249997, '5\%': -2.937069375, '10\%': -2.606985625\}, 1307.285137861741)
The p-value of the test on loan\_rev is: 0.00019690419763896495

 Print in different format
Results of Dickey-Fuller Test:
Test Statistic                 -4.499677
p-value                         0.000197
\#Lags Used                     10.000000
Number of Observations Used    40.000000
Critical Value (1\%)            -3.605565
Critical Value (5\%)            -2.937069
Critical Value (10\%)           -2.606986
dtype: float64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\_indexer,col\_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html\#indexing-view-versus-copy
  

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{monthly\PYZus{}rate}\PY{o}{=}\PY{n}{US10Y}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
         \PY{n}{monthly\PYZus{}rate\PYZus{}data}\PY{o}{=}\PY{n}{monthly\PYZus{}rate}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RATE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n+nb}{type}\PY{p}{(}\PY{n}{monthly\PYZus{}rate\PYZus{}data}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Run the ADF test on the monthly\PYZus{}rate\PYZus{}data series and print out the results}
         \PY{n}{adfuller\PYZus{}monthly\PYZus{}rate\PYZus{}data} \PY{o}{=} \PY{n}{adfuller}\PY{p}{(}\PY{n}{monthly\PYZus{}rate\PYZus{}data}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{adfuller\PYZus{}monthly\PYZus{}rate\PYZus{}data}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Just print out the p\PYZhy{}value}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The p\PYZhy{}value of the test on monthly\PYZus{}rate\PYZus{}data is: }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{adfuller\PYZus{}monthly\PYZus{}rate\PYZus{}data}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Results of Dickey\PYZhy{}Fuller Test:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{dfoutput} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{adfuller\PYZus{}monthly\PYZus{}rate\PYZus{}data}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{4}\PY{p}{]}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Statistic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p\PYZhy{}value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}Lags Used}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Observations Used}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{k}{for} \PY{n}{key}\PY{p}{,}\PY{n}{value} \PY{o+ow}{in} \PY{n}{adfuller\PYZus{}monthly\PYZus{}rate\PYZus{}data}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{]}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{dfoutput}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Critical Value (}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{k}{key}] = value
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{dfoutput}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(-1.396544767435691, 0.5839314748568241, 1, 49, \{'1\%': -3.5714715250448363, '5\%': -2.922629480573571, '10\%': -2.5993358475635153\}, -34.97121939430423)
The p-value of the test on monthly\_rate\_data is: 0.5839314748568241
Results of Dickey-Fuller Test:
Test Statistic                 -1.396545
p-value                         0.583931
\#Lags Used                      1.000000
Number of Observations Used    49.000000
Critical Value (1\%)            -3.571472
Critical Value (5\%)            -2.922629
Critical Value (10\%)           -2.599336
dtype: float64

    \end{Verbatim}

    According to this test, p-value is very is higher than 0.05. We cannot
reject the hypothesis that Monthly Interest Rate prices follow a random
walk.

    \section{Are Interest Rates
Autocorrelated?}\label{are-interest-rates-autocorrelated}

When we look at daily changes in interest rates, the autocorrelation is
close to zero. However, if we resample the data and look at annual
changes, the autocorrelation is negative. This implies that while short
term changes in interest rates may be uncorrelated, long term changes in
interest rates are negatively autocorrelated. A daily move up or down in
interest rates is unlikely to tell us anything about interest rates
tomorrow, but a move in interest rates over a year can tell us something
about where interest rates are going over the next year. And this makes
some economic sense: over long horizons, when interest rates go up, the
economy tends to slow down, which consequently causes interest rates to
fall, and vice versa.

One of the really cool things that pandas allows us to do is resample
the data. If we want to look at the data by monthly and anually. We can
easily resample and sum it up. I'm using `M' as the period for
resampling which means the data should be resampled on a month boundary
and 'A' for annual data'. Finally find the The autocorrelation of annual
interest rate changes'''

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{US10Y}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{change\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{US10Y}\PY{o}{.}\PY{n}{diff}\PY{p}{(}\PY{p}{)}
         \PY{n}{US10Y}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{change\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{US10Y}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{change\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}
         \PY{n}{US10Y}\PY{o}{.}\PY{n}{describe}
         
         \PY{c+c1}{\PYZsh{} Compute and print the autocorrelation of daily changes}
         \PY{n}{autocorrelation\PYZus{}daily} \PY{o}{=} \PY{n}{US10Y}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{change\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{autocorr}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The autocorrelation of daily interest rate changes is }\PY{l+s+si}{\PYZpc{}4.2f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{autocorrelation\PYZus{}daily}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{US10Y}\PY{o}{.}\PY{n}{index} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{US10Y}\PY{o}{.}\PY{n}{index}\PY{p}{)}
         
         \PY{n}{monthly\PYZus{}rate\PYZus{}data} \PY{o}{=} \PY{n}{US10Y}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RATE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{n}{rule}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{last}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}annual\PYZus{}data = annual\PYZus{}data.dropna()}
         \PY{c+c1}{\PYZsh{} Repeat above for annual data}
         \PY{n}{monthly\PYZus{}rate\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diff\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{monthly\PYZus{}rate\PYZus{}data}\PY{o}{.}\PY{n}{diff}\PY{p}{(}\PY{p}{)}
         \PY{n}{monthly\PYZus{}rate\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diff\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{monthly\PYZus{}rate\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diff\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{monthly\PYZus{}rate\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diff\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{autocorrelation\PYZus{}monthly} \PY{o}{=} \PY{n}{monthly\PYZus{}rate\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diff\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{autocorr}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The autocorrelation of monthly interest rate changes is }\PY{l+s+si}{\PYZpc{}4.2f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{autocorrelation\PYZus{}monthly}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{US10Y}\PY{o}{.}\PY{n}{index} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{US10Y}\PY{o}{.}\PY{n}{index}\PY{p}{)}
         \PY{n}{annual\PYZus{}rate\PYZus{}data} \PY{o}{=} \PY{n}{US10Y}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RATE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{n}{rule}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{A}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{last}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Repeat above for annual data}
         \PY{n}{annual\PYZus{}rate\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diff\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{annual\PYZus{}rate\PYZus{}data}\PY{o}{.}\PY{n}{diff}\PY{p}{(}\PY{p}{)}
         \PY{n}{annual\PYZus{}rate\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diff\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{annual\PYZus{}rate\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diff\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{annual\PYZus{}rate\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diff\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{autocorrelation\PYZus{}annual} \PY{o}{=} \PY{n}{annual\PYZus{}rate\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diff\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{autocorr}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The autocorrelation of annual interest rate changes is }\PY{l+s+si}{\PYZpc{}4.2f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{autocorrelation\PYZus{}annual}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
The autocorrelation of daily interest rate changes is -0.06
DATE
2014-11-30   -0.17
2014-12-31   -0.01
2015-01-31   -0.49
2015-02-28    0.32
2015-03-31   -0.06
2015-04-30    0.11
2015-05-31    0.07
2015-06-30    0.23
2015-07-31   -0.15
2015-08-31    0.01
2015-09-30   -0.15
2015-10-31    0.10
2015-11-30    0.05
2015-12-31    0.06
2016-01-31   -0.33
2016-02-29   -0.20
2016-03-31    0.04
2016-04-30    0.05
2016-05-31    0.01
2016-06-30   -0.35
2016-07-31   -0.03
2016-08-31    0.12
2016-09-30    0.02
2016-10-31    0.24
2016-11-30    0.53
2016-12-31    0.08
2017-01-31    0.00
2017-02-28   -0.09
2017-03-31    0.04
2017-04-30   -0.11
2017-05-31   -0.08
2017-06-30    0.10
2017-07-31   -0.01
2017-08-31   -0.18
2017-09-30    0.21
2017-10-31    0.05
2017-11-30    0.04
2017-12-31   -0.02
2018-01-31    0.32
2018-02-28    0.15
2018-03-31   -0.13
2018-04-30    0.21
2018-05-31   -0.12
2018-06-30    0.02
2018-07-31    0.11
2018-08-31   -0.10
2018-09-30    0.19
2018-10-31    0.10
2018-11-30   -0.14
2018-12-31   -0.24
Freq: M, Name: RATE, dtype: float64
The autocorrelation of monthly interest rate changes is -0.02
DATE
2015-12-31    0.10
2016-12-31    0.18
2017-12-31   -0.05
2018-12-31    0.37
Freq: A-DEC, Name: RATE, dtype: float64
The autocorrelation of annual interest rate changes is -0.97

    \end{Verbatim}

    '''Notice how the daily and monthly autocorrelation is small but the
annual autocorrelation is large and negative'''

    Visual exploration is the most effective way to extract information
between variables.

We can plot a barplot of the frequency distribution of a categorical
feature using the seaborn package, which shows the frequency
distribution of the mortgage dataset column

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
         \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         \PY{n}{loan\PYZus{}type\PYZus{}count} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{style}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{darkgrid}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{barplot}\PY{p}{(}\PY{n}{loan\PYZus{}type\PYZus{}count}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{loan\PYZus{}type\PYZus{}count}\PY{o}{.}\PY{n}{values}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Frequency Distribution of Loan Types}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Occurrences}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Types}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{45}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_40_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Conventional loan type is top market for the Bank then FHA Loan Type

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
         \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         \PY{n}{unit\PYZus{}type\PYZus{}count} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{style}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{darkgrid}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{barplot}\PY{p}{(}\PY{n}{unit\PYZus{}type\PYZus{}count}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{unit\PYZus{}type\PYZus{}count}\PY{o}{.}\PY{n}{values}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Frequency Distribution of Loan Types}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Occurrences}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Types}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{45}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_42_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    One Family, Two Family and Condos are the top unit types for the Bank

    \section{6. Data Collection}\label{data-collection}

Since we are only interested in the event log data we will only be using
one of the tables. This table contains data about every mortgage
application. Every action performed by the system or by a user on a
mortgage application is logged, and the status before and after that
specific action is logged. For our analysis we are mainly interested in
the date and time at which each of the mortgage applications have
entered the system. Besides Mortgage Application DataSet, we have joined
two separate (10 Years US Treasury Rate, Home Supply Index) with our
existing Mortgage Application DataSet to enhance predictive power of our
model.

    \section{Encoding Categorical Data}\label{encoding-categorical-data}

There are different techniques to encode the categorical features to
numeric quantities.

The techniques are as following:

Replacing values

Encoding labels

One-Hot encoding

Binary encoding

Backward difference encoding

Miscellaneous features

Replace Values

Let's start with the most basic method, which is just replacing the
categories with the desired numbers. This can be achieved with the help
of the replace() function in pandas. The idea is that you have the
liberty to choose whatever numbers we want to assign to the categories
according to the business use case.

    it's a good practice to typecast categorical features to a category
dtype because they make the operations on such columns much faster than
the object dtype. You can do the typecasting by using .astype() method
on your columns like shown below:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{c:/scripts/mwb2014.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index\PYZus{}col}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{header}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cp1252}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{data\PYZus{}lc} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{City}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{City}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{category}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Zip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Zip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{category}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{category}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{category}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}purpose\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Purpose}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{category}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{data\PYZus{}lc}\PY{o}{.}\PY{n}{dtypes}\PY{p}{)}
         \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lo\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Officer Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{category}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{lo\PYZus{}code} \PY{o}{=}\PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lo\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{data\PYZus{}lc}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
First Name                  object
Last Name                   object
City                      category
State                       object
Zip                       category
Loan Amount                float64
Estimated Value              int64
Loan Purpose                object
Qualification FICO           int64
Is Primary Wage Earner        bool
Income Type                 object
Asset Docs                  object
Occupancy                   object
Unit Type                 category
Loan Type                 category
Lender Name                 object
Time                        object
Fix                           bool
ARM                           bool
CLTV                       float64
Loan Number                 object
Loan Officer Name           object
LoanInMonth                  int64
loan\_purpose\_code         category
dtype: object
<class 'pandas.core.frame.DataFrame'>
Index: 2501 entries, 10/14/2014 to 12/27/2018
Data columns (total 25 columns):
First Name                2501 non-null object
Last Name                 2501 non-null object
City                      2501 non-null category
State                     2501 non-null object
Zip                       2501 non-null category
Loan Amount               2501 non-null float64
Estimated Value           2501 non-null int64
Loan Purpose              2501 non-null object
Qualification FICO        2501 non-null int64
Is Primary Wage Earner    2501 non-null bool
Income Type               2501 non-null object
Asset Docs                2501 non-null object
Occupancy                 1846 non-null object
Unit Type                 2501 non-null category
Loan Type                 2501 non-null category
Lender Name               2501 non-null object
Time                      2501 non-null object
Fix                       2501 non-null bool
ARM                       2501 non-null bool
CLTV                      2501 non-null float64
Loan Number               2501 non-null object
Loan Officer Name         2501 non-null object
LoanInMonth               2501 non-null int64
loan\_purpose\_code         2501 non-null category
lo\_code                   2501 non-null category
dtypes: bool(3), category(6), float64(2), int64(3), object(11)
memory usage: 410.7+ KB

    \end{Verbatim}

    \section{Label Encoding}\label{label-encoding}

We can achieve the label encoding using scikit-learn's LabelEncoder:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{LabelEncoder}
         
         \PY{n}{lb\PYZus{}make} \PY{o}{=} \PY{n}{LabelEncoder}\PY{p}{(}\PY{p}{)}
         \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}purpose\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{lb\PYZus{}make}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Purpose}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{lb\PYZus{}make}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unit\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{lb\PYZus{}make}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         
         
         \PY{n}{data\PYZus{}lc}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)} \PY{c+c1}{\PYZsh{}Results in appending a new column to df}
         
         \PY{n}{data\PYZus{}lc}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Index: 2501 entries, 10/14/2014 to 12/27/2018
Data columns (total 27 columns):
First Name                2501 non-null object
Last Name                 2501 non-null object
City                      2501 non-null category
State                     2501 non-null object
Zip                       2501 non-null category
Loan Amount               2501 non-null float64
Estimated Value           2501 non-null int64
Loan Purpose              2501 non-null object
Qualification FICO        2501 non-null int64
Is Primary Wage Earner    2501 non-null bool
Income Type               2501 non-null object
Asset Docs                2501 non-null object
Occupancy                 1846 non-null object
Unit Type                 2501 non-null category
Loan Type                 2501 non-null category
Lender Name               2501 non-null object
Time                      2501 non-null object
Fix                       2501 non-null bool
ARM                       2501 non-null bool
CLTV                      2501 non-null float64
Loan Number               2501 non-null object
Loan Officer Name         2501 non-null object
LoanInMonth               2501 non-null int64
loan\_purpose\_code         2501 non-null int64
lo\_code                   2501 non-null category
loan\_type\_code            2501 non-null int64
unit\_type\_code            2501 non-null int64
dtypes: bool(3), category(5), float64(2), int64(6), object(11)
memory usage: 466.5+ KB

    \end{Verbatim}

    Label Encoding Another approach is to encode categorical values with a
technique called "label encoding", which allows you to convert each
value in a column to a number. Numerical labels are always between 0 and
n\_categories-1.

We can do label encoding via attributes .cat.codes on your DataFrame's
column.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lo\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Officer Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{category}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{lo\PYZus{}code} \PY{o}{=}\PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lo\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{City}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{cat}\PY{o}{.}\PY{n}{codes}
         \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zip\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Zip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{cat}\PY{o}{.}\PY{n}{codes}
         \PY{n}{lo\PYZus{}code} \PY{o}{=} \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lo\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{cat}\PY{o}{.}\PY{n}{codes}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{lo\PYZus{}code}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Created Date
10/14/2014    15
10/14/2014    15
10/14/2014     9
10/14/2014    15
10/14/2014    11
10/14/2014    15
10/15/2014    11
10/15/2014    11
10/15/2014    15
10/16/2014    15
10/16/2014    15
10/16/2014    15
10/16/2014    16
10/17/2014    11
10/20/2014    30
10/20/2014     0
10/20/2014    16
10/20/2014    42
10/21/2014    42
10/21/2014    15
10/22/2014     7
10/22/2014     9
10/22/2014     7
10/23/2014    15
10/27/2014    11
10/27/2014     8
10/27/2014     8
10/27/2014     8
10/28/2014     9
10/28/2014    15
              ..
11/26/2018     3
11/26/2018     8
11/26/2018     8
11/27/2018    26
11/27/2018    31
11/27/2018    32
11/28/2018     1
11/28/2018    30
11/30/2018     9
11/30/2018     9
11/30/2018     0
12/1/2018      9
12/3/2018      9
12/4/2018      9
12/4/2018     17
12/4/2018     16
12/5/2018      9
12/6/2018     17
12/10/2018    26
12/10/2018    17
12/11/2018     9
12/14/2018    35
12/14/2018    35
12/17/2018    17
12/20/2018    34
12/20/2018     9
12/21/2018     0
12/21/2018     0
12/26/2018     3
12/27/2018     3
Length: 2501, dtype: int8

    \end{Verbatim}

    \section{One-Hot encoding}\label{one-hot-encoding}

The basic strategy is to convert each category value into a new column
and assign a 1 or 0 (True/False) value to the column. This has the
benefit of not weighting a value improperly.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{data\PYZus{}lc} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{data\PYZus{}lc}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{prefix} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}False}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
         \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}29}]:} 1    2242
         0     259
         Name: Fix\_True, dtype: int64
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unit\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
         \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unit\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
OneFamily      1276
TwoFamily       707
Condo           216
ThreeFamily     129
Coop             76
FourFamily       36
MixedUse         25
MultiFamily      20
Warehouse         8
PUD               6
Land              1
Industrial        1
Name: Unit Type, dtype: int64 
  7     1276
10     707
0      216
9      129
1       76
2       36
5       25
6       20
11       8
8        6
3        1
4        1
Name: unit\_type\_code, dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
         \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
         \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unit\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Conventional    1736
FHA              418
Residential      215
Commercial       100
Other             31
VA                 1
Name: Loan Type, dtype: int64  
  1    1736
2     418
4     215
0     100
3      31
5       1
Name: loan\_type\_code, dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Purpose}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}purpose\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}32}]:}                Loan Purpose  loan\_purpose\_code
         Created Date                                  
         10/14/2014         Purchase                  4
         10/14/2014         Purchase                  4
         10/14/2014    Cash-Out Refi                  0
         10/14/2014    Cash-Out Refi                  0
         10/14/2014         Purchase                  4
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}purpose\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}33}]:} 4    1707
         0     475
         2     310
         5       5
         3       2
         1       1
         6       1
         Name: loan\_purpose\_code, dtype: int64
\end{Verbatim}
            
    Forward Fill Missing Data

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{c+c1}{\PYZsh{}Categorical value \PYZsq{}loan\PYZus{}purpose\PYZus{}code\PYZsq{} has been update based on frequency of the value\PYZus{}counts}
         
         \PY{n}{data\PYZus{}lc}\PY{o}{=}\PY{n}{data\PYZus{}lc}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ffill}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{total\PYZus{}missing\PYZus{}data\PYZus{}lc}\PY{o}{=}\PY{n}{data\PYZus{}lc}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{US10Y}\PY{o}{=} \PY{n}{US10Y}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ffill}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{data\PYZus{}lc}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Index: 2501 entries, 10/14/2014 to 12/27/2018
Data columns (total 30 columns):
First Name                2501 non-null object
Last Name                 2501 non-null object
City                      2501 non-null category
State                     2501 non-null object
Zip                       2501 non-null category
Loan Amount               2501 non-null float64
Estimated Value           2501 non-null int64
Loan Purpose              2501 non-null object
Qualification FICO        2501 non-null int64
Is Primary Wage Earner    2501 non-null bool
Income Type               2501 non-null object
Asset Docs                2501 non-null object
Occupancy                 1846 non-null object
Unit Type                 2501 non-null category
Loan Type                 2501 non-null category
Lender Name               2501 non-null object
Time                      2501 non-null object
ARM                       2501 non-null bool
CLTV                      2501 non-null float64
Loan Number               2501 non-null object
Loan Officer Name         2501 non-null object
LoanInMonth               2501 non-null int64
loan\_purpose\_code         2501 non-null int64
lo\_code                   2501 non-null category
loan\_type\_code            2501 non-null int64
unit\_type\_code            2501 non-null int64
city\_code                 2501 non-null int16
zip\_code                  2501 non-null int16
Fix\_False                 2501 non-null uint8
Fix\_True                  2501 non-null uint8
dtypes: bool(2), category(5), float64(2), int16(2), int64(6), object(11), uint8(2)
memory usage: 478.7+ KB

    \end{Verbatim}

    For Machine Learning Modeling, we need to create new Data Frame

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{n}{model\PYZus{}data1} \PY{o}{=} \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zip\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}purpose\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unit\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CLTV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LoanInMonth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         \PY{n}{model\PYZus{}data1}\PY{o}{.}\PY{n}{columns}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}35}]:} Index(['Loan Amount', 'city\_code', 'zip\_code', 'loan\_purpose\_code',
                'Qualification FICO', 'unit\_type\_code', 'loan\_type\_code', 'Fix\_True',
                'CLTV', 'LoanInMonth'],
               dtype='object')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{n}{model\PYZus{}data1}\PY{o}{.}\PY{n}{tail}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}36}]:}               Loan Amount  city\_code  zip\_code  loan\_purpose\_code  \textbackslash{}
         Created Date                                                        
         12/11/2018       550000.0        582       351                  0   
         12/14/2018       850000.0         66       312                  2   
         12/14/2018       600000.0        468       335                  0   
         12/17/2018       943800.0         66       300                  4   
         12/20/2018       526500.0        303        95                  4   
         12/20/2018       870000.0        155       318                  0   
         12/21/2018       633750.0         39       286                  4   
         12/21/2018       861750.0        256       358                  4   
         12/26/2018      1190000.0        583       337                  4   
         12/27/2018      1190000.0        256       360                  4   
         
                       Qualification FICO  unit\_type\_code  loan\_type\_code  Fix\_True  \textbackslash{}
         Created Date                                                                 
         12/11/2018                   708              10               1         1   
         12/14/2018                   700               6               0         0   
         12/14/2018                   700               7               0         0   
         12/17/2018                   768              10               1         1   
         12/20/2018                   804               7               3         0   
         12/20/2018                   764              10               1         1   
         12/21/2018                   767              10               1         1   
         12/21/2018                   796              10               1         1   
         12/26/2018                   778              10               0         1   
         12/27/2018                   778              10               1         1   
         
                       CLTV  LoanInMonth  
         Created Date                     
         12/11/2018     0.0           10  
         12/14/2018    65.0           11  
         12/14/2018    74.0           12  
         12/17/2018    78.0           13  
         12/20/2018    65.0           14  
         12/20/2018    60.0           15  
         12/21/2018    75.0           16  
         12/21/2018    75.0           17  
         12/26/2018    70.0           18  
         12/27/2018    70.0           19  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{n}{total\PYZus{}missing\PYZus{}mode\PYZus{}data1}\PY{o}{=}\PY{n}{model\PYZus{}data1}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{total\PYZus{}missing\PYZus{}mode\PYZus{}data1}\PY{p}{)}
         \PY{n}{model\PYZus{}data1}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Loan Amount           0
city\_code             0
zip\_code              0
loan\_purpose\_code     0
Qualification FICO    0
unit\_type\_code        0
loan\_type\_code        0
Fix\_True              0
CLTV                  0
LoanInMonth           0
dtype: int64
<class 'pandas.core.frame.DataFrame'>
Index: 2501 entries, 10/14/2014 to 12/27/2018
Data columns (total 10 columns):
Loan Amount           2501 non-null float64
city\_code             2501 non-null int16
zip\_code              2501 non-null int16
loan\_purpose\_code     2501 non-null int64
Qualification FICO    2501 non-null int64
unit\_type\_code        2501 non-null int64
loan\_type\_code        2501 non-null int64
Fix\_True              2501 non-null uint8
CLTV                  2501 non-null float64
LoanInMonth           2501 non-null int64
dtypes: float64(2), int16(2), int64(5), uint8(1)
memory usage: 168.5+ KB

    \end{Verbatim}

    We can see that there is no missing value in model\_data1

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model\PYZus{}data1 Keys: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{model\PYZus{}data1}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model\PYZus{}data1 shape: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{model\PYZus{}data1}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n}{model\PYZus{}data1}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
model\_data1 Keys:  Index(['Loan Amount', 'city\_code', 'zip\_code', 'loan\_purpose\_code',
       'Qualification FICO', 'unit\_type\_code', 'loan\_type\_code', 'Fix\_True',
       'CLTV', 'LoanInMonth'],
      dtype='object')
model\_data1 shape:  (2501, 10)
<class 'pandas.core.frame.DataFrame'>
Index: 2501 entries, 10/14/2014 to 12/27/2018
Data columns (total 10 columns):
Loan Amount           2501 non-null float64
city\_code             2501 non-null int16
zip\_code              2501 non-null int16
loan\_purpose\_code     2501 non-null int64
Qualification FICO    2501 non-null int64
unit\_type\_code        2501 non-null int64
loan\_type\_code        2501 non-null int64
Fix\_True              2501 non-null uint8
CLTV                  2501 non-null float64
LoanInMonth           2501 non-null int64
dtypes: float64(2), int16(2), int64(5), uint8(1)
memory usage: 168.5+ KB

    \end{Verbatim}

    Let's find out quaterly auto corellation of Loan amount

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{n}{loan\PYZus{}amt}\PY{o}{=}\PY{n}{model\PYZus{}data1}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         \PY{n}{pd}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{autocorrelation\PYZus{}plot}\PY{p}{(}\PY{n}{loan\PYZus{}amt}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}39}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x25648065518>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{Joining DataFrame}\label{joining-dataframe}

Join two DataFrames model\_data1 \& US10Y save the results in
model\_data2

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{n}{US10Y} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/scripts/US10Y.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{header}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{index\PYZus{}col}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DATE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cp1252}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}index\PYZus{}col=\PYZsq{}DATE\PYZsq{}}
         \PY{n}{US10Y}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{99999}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         
         \PY{n}{US10Y}\PY{o}{=} \PY{n}{US10Y}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{n}{to\PYZus{}replace}\PY{o}{=}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{99999}\PY{p}{]}\PY{p}{,} \PY{n}{value}\PY{o}{=}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{US10Y}\PY{o}{.}\PY{n}{tail}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}40}]:}             RATE
         DATE            
         12/21/2018  2.79
         12/24/2018  2.74
         12/25/2018   NaN
         12/26/2018  2.81
         12/27/2018  2.77
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{n}{US10Y}\PY{o}{=} \PY{n}{US10Y}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ffill}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{US10Y}\PY{o}{=} \PY{n}{US10Y}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RATE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{float64}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{total\PYZus{}missing\PYZus{}rate}\PY{o}{=}\PY{n}{US10Y}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{total\PYZus{}missing\PYZus{}rate}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
RATE    0
dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} \PY{n}{model\PYZus{}data2} \PY{o}{=} \PY{n}{model\PYZus{}data1}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{US10Y}\PY{p}{)}
         \PY{n}{total\PYZus{}missing}\PY{o}{=}\PY{n}{model\PYZus{}data2}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n}{model\PYZus{}data2}\PY{o}{=} \PY{n}{model\PYZus{}data2}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ffill}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{total\PYZus{}missing\PYZus{}model\PYZus{}data2}\PY{o}{=}\PY{n}{model\PYZus{}data2}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{total\PYZus{}missing\PYZus{}model\PYZus{}data2}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Loan Amount           0
city\_code             0
zip\_code              0
loan\_purpose\_code     0
Qualification FICO    0
unit\_type\_code        0
loan\_type\_code        0
Fix\_True              0
CLTV                  0
LoanInMonth           0
RATE                  0
dtype: int64

    \end{Verbatim}

    \section{Home Supply}\label{home-supply}

US Home Supply directly impact Housing Market and Mortgage Market. We
have collected the data from FRED Integrate Monthly housing supply index
data and merging with current dataset

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}43}]:} \PY{n}{home\PYZus{}supply} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{c:/scripts/MonHouseSupply.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{header}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{index\PYZus{}col}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DATE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cp1252}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{home\PYZus{}supply}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Index: 51 entries, 10/14/2014 to 12/1/2018
Data columns (total 1 columns):
Home    51 non-null float64
dtypes: float64(1)
memory usage: 816.0+ bytes

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{n}{total\PYZus{}missing\PYZus{}home\PYZus{}supply}\PY{o}{=}\PY{n}{home\PYZus{}supply}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{model\PYZus{}data} \PY{o}{=} \PY{n}{model\PYZus{}data2}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{home\PYZus{}supply}\PY{p}{)}
         \PY{n}{total\PYZus{}missing}\PY{o}{=}\PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n}{model\PYZus{}data}\PY{o}{=} \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ffill}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{total\PYZus{}missing\PYZus{}home\PYZus{}supply}\PY{o}{=}\PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{total\PYZus{}missing\PYZus{}home\PYZus{}supply}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Loan Amount           0
city\_code             0
zip\_code              0
loan\_purpose\_code     0
Qualification FICO    0
unit\_type\_code        0
loan\_type\_code        0
Fix\_True              0
CLTV                  0
LoanInMonth           0
RATE                  0
Home                  0
dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}45}]:} \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}45}]:}            Loan Amount  city\_code  zip\_code  loan\_purpose\_code  \textbackslash{}
         1/1/2018      454800.0         80       330                  4   
         1/1/2018      960000.0         39       287                  0   
         1/10/2018     409500.0         66       286                  4   
         1/10/2018     472500.0         39       293                  4   
         1/11/2016     300000.0        613       351                  4   
         
                    Qualification FICO  unit\_type\_code  loan\_type\_code  Fix\_True  CLTV  \textbackslash{}
         1/1/2018                  777               7               0         0  60.0   
         1/1/2018                  680              10               0         1  60.0   
         1/10/2018                 702              10               1         1  70.0   
         1/10/2018                 645               7               1         1  63.0   
         1/11/2016                 788              10               1         1  50.0   
         
                    LoanInMonth  RATE  Home  
         1/1/2018            40  2.40   5.6  
         1/1/2018            40  2.40   5.6  
         1/10/2018           11  2.55   5.6  
         1/10/2018           12  2.55   5.6  
         1/11/2016           11  2.17   5.6  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{n}{model\PYZus{}data3}\PY{o}{=}\PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{n}{model\PYZus{}data3}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}46}]:}            Loan Amount  city\_code  zip\_code  loan\_purpose\_code  \textbackslash{}
         1/1/2018      454800.0         80       330                  4   
         1/1/2018      960000.0         39       287                  0   
         1/10/2018     409500.0         66       286                  4   
         1/10/2018     472500.0         39       293                  4   
         1/11/2016     300000.0        613       351                  4   
         
                    Qualification FICO  unit\_type\_code  loan\_type\_code  Fix\_True  CLTV  \textbackslash{}
         1/1/2018                  777               7               0         0  60.0   
         1/1/2018                  680              10               0         1  60.0   
         1/10/2018                 702              10               1         1  70.0   
         1/10/2018                 645               7               1         1  63.0   
         1/11/2016                 788              10               1         1  50.0   
         
                    LoanInMonth  RATE  Home  
         1/1/2018            40  2.40   5.6  
         1/1/2018            40  2.40   5.6  
         1/10/2018           11  2.55   5.6  
         1/10/2018           12  2.55   5.6  
         1/11/2016           11  2.17   5.6  
\end{Verbatim}
            
    \section{5.2 DATA EXPLORATION}\label{data-exploration}

Since our dataset can be grouped per day to create meaningful
visualizations. The dataset contains data from October 2014 until
December 2018. In order to get a feel of the amount of mortgage
applications per day and the distribution of the mortgage applications,
different visualizations can be made using Python. Two graphs have been
created, which can be found in Figure 1 and Figure 2. Both of these
graphs only contain the amount of mortgage applications on the weekdays.
As there are almost no applications coming in on the weekends they have
been excluded from the graphs. As can be seen from the graphs, there
seems to be a seasonal pattern on a monthly level, but from these graphs
it is not very clear. It also seems like there are some outliers, so
these data points will have to be investigated to see if they will have
to be included in our model, as there can be multiple underlying reasons
for outliers in our dataset. It also seems there is an increase in
mortgage applications during the last few months of each year. The
amount of applications per day during these months is higher compared to
the other months. This can have multiple explanations so this will have
to be accounted for in the model.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{n}{loan\PYZus{}amount\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{St}\PY{p}{)}\PY{p}{]}
         \PY{n}{loan\PYZus{}amount\PYZus{}data}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{ct\PYZus{}loan\PYZus{}amount}\PY{o}{=}\PY{n+nb}{sum}\PY{p}{(}\PY{n}{ct\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{fl\PYZus{}loan\PYZus{}amount}\PY{o}{=}\PY{n+nb}{sum}\PY{p}{(}\PY{n}{fl\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{ny\PYZus{}loan\PYZus{}amount}\PY{o}{=}\PY{n+nb}{sum}\PY{p}{(}\PY{n}{ny\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{nj\PYZus{}loan\PYZus{}amount}\PY{o}{=}\PY{n+nb}{sum}\PY{p}{(}\PY{n}{nj\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{pa\PYZus{}loan\PYZus{}amount}\PY{o}{=}\PY{n+nb}{sum}\PY{p}{(}\PY{n}{pa\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{loan\PYZus{}amount\PYZus{}per\PYZus{}state} \PY{o}{=} \PY{p}{[}\PY{n}{ct\PYZus{}loan\PYZus{}amount}\PY{p}{,} \PY{n}{fl\PYZus{}loan\PYZus{}amount}\PY{p}{,} \PY{n}{nj\PYZus{}loan\PYZus{}amount}\PY{p}{,} \PY{n}{ny\PYZus{}loan\PYZus{}amount}\PY{p}{,} \PY{n}{pa\PYZus{}loan\PYZus{}amount}\PY{p}{]}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{====================================================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{=========    Total Sales by State     ==============}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total Sales in Cunnecticut   : \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ct\PYZus{}loan\PYZus{}amount}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total Sales in Florida       : \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fl\PYZus{}loan\PYZus{}amount}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total Sales in New York      : \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ny\PYZus{}loan\PYZus{}amount}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total Sales in New Jersey    : \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{nj\PYZus{}loan\PYZus{}amount}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total Sales in Pennsylvania  : \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{pa\PYZus{}loan\PYZus{}amount}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{====================================================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{n}{loan\PYZus{}types}\PY{o}{=}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
         \PY{n}{group\PYZus{}loan\PYZus{}types}\PY{o}{=}\PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unique Loan Types        : }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{loan\PYZus{}types}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{====================================================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of loan per Types : }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{group\PYZus{}loan\PYZus{}types}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{====================================================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
====================================================
=========    Total Sales by State     ==============
 
Total Sales in Cunnecticut   : \$ 3604641.0
Total Sales in Florida       : \$ 3371495.0
Total Sales in New York      : \$ 868836552.2799997
Total Sales in New Jersey    : \$ 236456261.05999997
Total Sales in Pennsylvania  : \$ 600920.0
 
====================================================
 
Unique Loan Types        :  ['Residential' 'FHA' 'Commercial' 'Conventional' 'Other' 'VA']
 
====================================================
Number of loan per Types :  Loan Type
Commercial       100
Conventional    1736
FHA              418
Other             31
Residential      215
VA                 1
dtype: int64
 
====================================================
 

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}48}]:} \PY{k+kn}{from} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{ticker} \PY{k}{import} \PY{n}{FuncFormatter}
         
         
         \PY{n}{x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
         \PY{n}{money} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{1.5e5}\PY{p}{,} \PY{l+m+mf}{2.5e6}\PY{p}{,} \PY{l+m+mf}{5.5e6}\PY{p}{,} \PY{l+m+mf}{1.0e7}\PY{p}{,} \PY{l+m+mf}{2.0e7}\PY{p}{,} \PY{l+m+mf}{3.0e7}\PY{p}{,} \PY{l+m+mf}{4.0e7}\PY{p}{,} \PY{l+m+mf}{5.0e7}\PY{p}{,} \PY{l+m+mf}{6.0e7}\PY{p}{]}
         
         
         \PY{k}{def} \PY{n+nf}{millions}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{pos}\PY{p}{)}\PY{p}{:}
             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The two args are the value and tick position}\PY{l+s+s1}{\PYZsq{}}
             \PY{k}{return} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+si}{\PYZpc{}1.1f}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{x} \PY{o}{*} \PY{l+m+mf}{1e\PYZhy{}6}\PY{p}{)}
         
         
         \PY{n}{formatter} \PY{o}{=} \PY{n}{FuncFormatter}\PY{p}{(}\PY{n}{millions}\PY{p}{)}
         
         \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{formatter}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{St}\PY{p}{,} \PY{n}{loan\PYZus{}amount\PYZus{}per\PYZus{}state}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Connecticut}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Florida}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{New Jersey}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{New York}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pennsylvania}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Origination per State}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{60}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mortgage Bank Loans per State}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Eventhough Bank is Licensed for business in NY, NJ, CT, PA and FL, their
strong mortgage market is in NY \& NI

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{c:/scripts/mwb2014.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{header}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cp1252}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{quantile}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.05}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{quantile}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.05}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{quantile}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mf}{0.90}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{quantile}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mf}{0.90}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{St}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NJ}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NY}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PA}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{St}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}DataFrame subsets by State}
         \PY{n}{ct\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{State}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}
         \PY{n}{fl\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{State}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}
         \PY{n}{ny\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{State}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NY}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}
         \PY{n}{nj\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{State}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NJ}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}
         \PY{n}{pa\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{State}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PA}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}
         
         
         \PY{c+c1}{\PYZsh{}Selecting data per column}
         \PY{n}{ct\PYZus{}lo\PYZus{}amount} \PY{o}{=} \PY{n}{ct\PYZus{}data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Last Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{City}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unit\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}
         \PY{n}{fl\PYZus{}lo\PYZus{}amount} \PY{o}{=} \PY{n}{fl\PYZus{}data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Last Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{City}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}
         \PY{n}{nj\PYZus{}lo\PYZus{}amount} \PY{o}{=} \PY{n}{nj\PYZus{}data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Last Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{City}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}
         \PY{n}{ny\PYZus{}lo\PYZus{}amount} \PY{o}{=} \PY{n}{ny\PYZus{}data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Last Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{City}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}
         \PY{n}{pa\PYZus{}lo\PYZus{}amount} \PY{o}{=} \PY{n}{pa\PYZus{}data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Last Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{City}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}
         \PY{c+c1}{\PYZsh{}subset = df.loc[:,(\PYZsq{}A\PYZsq{}:\PYZsq{}C\PYZsq{}, \PYZsq{}E\PYZsq{}, \PYZsq{}G\PYZsq{}:\PYZsq{}I\PYZsq{})]}
         \PY{c+c1}{\PYZsh{}print(ct\PYZus{}data[[1], [2], [8]])}
         
         \PY{c+c1}{\PYZsh{}Plot loan amount per Statae}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan origination Data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{60}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MWB Loan Data for CT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ct\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{ct\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
          Zip  Loan Amount  Estimated Value  Qualification FICO  \textbackslash{}
0.05   7083.0     150000.0         205275.0               636.0   
0.95  11756.0     840000.0        1400000.0               803.0   

      Is Primary Wage Earner  Fix  ARM  CLTV  LoanInMonth  
0.05                     0.0  0.0  0.0   0.0          3.0  
0.95                     1.0  1.0  1.0  96.0         56.0  
0.05    150000.0
0.95    840000.0
Name: Loan Amount, dtype: float64
0.1    200000.0
0.9    696500.0
Name: Loan Amount, dtype: float64
0.1    200000.0
0.9    696500.0
Name: Loan Amount, dtype: float64
['CT', 'FL', 'NJ', 'NY', 'PA']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}pandas\textbackslash{}core\textbackslash{}indexing.py:870: FutureWarning: 
Passing list-likes to .loc or [] with any missing label will raise
KeyError in the future, you can use .reindex() as an alternative.

See the documentation here:
https://pandas.pydata.org/pandas-docs/stable/indexing.html\#deprecate-loc-reindex-listlike
  return self.\_getitem\_lowerdim(tup)

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}49}]:} [<matplotlib.lines.Line2D at 0x25645fece10>]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_82_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Here is the Loan amount Distribution for CT State

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}50}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{==============================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Unit Type Loan Data}
         \PY{n}{total\PYZus{}unit\PYZus{}type} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan originated in all States per unit types : }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{total\PYZus{}unit\PYZus{}type}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{==============================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Unit Type Loan Data for CT}
         \PY{n}{ct\PYZus{}data\PYZus{}unit\PYZus{}type}\PY{o}{=}\PY{n}{ct\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan originated in Cunnecticut per unit types : }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ct\PYZus{}data\PYZus{}unit\PYZus{}type}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{==============================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Unit Type Loan Data for FL}
         \PY{n}{fl\PYZus{}data\PYZus{}unit\PYZus{}type}\PY{o}{=}\PY{n}{fl\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan originated in Florida per unit types : }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fl\PYZus{}data\PYZus{}unit\PYZus{}type}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{==============================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Unit Type Loan Data for NJ}
         \PY{n}{nj\PYZus{}data\PYZus{}unit\PYZus{}type}\PY{o}{=}\PY{n}{nj\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan originated in New Jersey per unit types : }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{nj\PYZus{}data\PYZus{}unit\PYZus{}type}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{==============================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{}Unit Type Loan Data for NY}
         \PY{n}{ny\PYZus{}data\PYZus{}unit\PYZus{}type}\PY{o}{=}\PY{n}{ny\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan originated in New York per unit types : }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ny\PYZus{}data\PYZus{}unit\PYZus{}type}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{==============================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Unit Type Loan Data for PA}
         \PY{n}{pa\PYZus{}data\PYZus{}unit\PYZus{}type}\PY{o}{=}\PY{n}{pa\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan originated in Pennsylvania per unit types : }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{pa\PYZus{}data\PYZus{}unit\PYZus{}type}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{==============================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Unit Type Loan Data for CT}
         \PY{n}{ct\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
==============================
 
Loan originated in all States per unit types : 
 Unit Type
Condo           216
Coop             76
FourFamily       36
Industrial        1
Land              1
MixedUse         25
MultiFamily      20
OneFamily      1276
PUD               6
ThreeFamily     129
TwoFamily       707
Warehouse         8
dtype: int64
==============================
 
Loan originated in Cunnecticut per unit types : 
 Unit Type
OneFamily      9
ThreeFamily    3
Name: Loan Amount, dtype: int64
==============================
 
Loan originated in Florida per unit types : 
 Unit Type
Condo         1
OneFamily    11
Name: Loan Amount, dtype: int64
==============================
 
Loan originated in New Jersey per unit types : 
 Unit Type
Condo          140
FourFamily       2
OneFamily      448
PUD              1
ThreeFamily     10
TwoFamily       70
Name: Loan Amount, dtype: int64
==============================
 
Loan originated in New York per unit types : 
 Unit Type
Condo           75
Coop            76
FourFamily      34
Industrial       1
Land             1
MixedUse        25
MultiFamily     20
OneFamily      805
PUD              5
ThreeFamily    116
TwoFamily      636
Warehouse        8
Name: Loan Amount, dtype: int64
==============================
 
Loan originated in Pennsylvania per unit types : 
 Unit Type
OneFamily    2
TwoFamily    1
Name: Loan Amount, dtype: int64
==============================
 

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}50}]:} Unit Type
         OneFamily      9
         ThreeFamily    3
         Name: Loan Amount, dtype: int64
\end{Verbatim}
            
    Loan data based on Unit Types (One Fami, Two Family etc) per State

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}51}]:} \PY{n}{lo\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{c:/scripts/mwb2014.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{header}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{index\PYZus{}col} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Officer Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cp1252}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Create a separate dataframe with the columns [\PYZsq{}\PYZsq{}, \PYZsq{}total\PYZsq{}, \PYZsq{}voters\PYZsq{}]: results}
         \PY{n}{lo\PYZus{}df} \PY{o}{=} \PY{n}{lo\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{City}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Zip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} Print the output of results.head()}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{lo\PYZus{}df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{lo\PYZus{}df}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{=======================================================================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{**********************  Loan Statistics for Mortgage Bank ***********************}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{n}{lo\PYZus{}df}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{lo\PYZus{}df}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}
         
         \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{scoreatpercentile}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
         
         \PY{n}{q0} \PY{o}{=} \PY{n}{scoreatpercentile}\PY{p}{(}\PY{n}{lo\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}
         \PY{n}{q1} \PY{o}{=} \PY{n}{scoreatpercentile}\PY{p}{(}\PY{n}{lo\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{25}\PY{p}{)}
         \PY{n}{q2} \PY{o}{=} \PY{n}{scoreatpercentile}\PY{p}{(}\PY{n}{lo\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{55}\PY{p}{)}
         \PY{n}{q3} \PY{o}{=} \PY{n}{scoreatpercentile}\PY{p}{(}\PY{n}{lo\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{75}\PY{p}{)}
         \PY{n}{q4} \PY{o}{=} \PY{n}{scoreatpercentile}\PY{p}{(}\PY{n}{lo\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{90}\PY{p}{)}
         
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Average Loan Amount is               :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{lo\PYZus{}df}[\PYZsq{}Loan Amount\PYZsq{}].mean())
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Median Loan Amount is                :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{lo\PYZus{}df}[\PYZsq{}Loan Amount\PYZsq{}].median())
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Standard deviation of Loan Amount is :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{lo\PYZus{}df}[\PYZsq{}Loan Amount\PYZsq{}].std())
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Minimum Loan Amount is               :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{lo\PYZus{}df}[\PYZsq{}Loan Amount\PYZsq{}].min())
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Maximum Loan Amount is               :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{lo\PYZus{}df}[\PYZsq{}Loan Amount\PYZsq{}].max())
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total of Loan Amount is              :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{lo\PYZus{}df}[\PYZsq{}Loan Amount\PYZsq{}].sum())
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{10}\PY{l+s+si}{\PYZpc{} o}\PY{l+s+s1}{f Loan Amount is below               :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{q0})
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{25}\PY{l+s+si}{\PYZpc{} o}\PY{l+s+s1}{f Loan Amount is below               :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{q1})
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{50}\PY{l+s+si}{\PYZpc{} o}\PY{l+s+s1}{f Loan Amount is below               :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{q2})
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{75}\PY{l+s+si}{\PYZpc{} o}\PY{l+s+s1}{f Loan Amount is below               :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{q3})
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{90}\PY{l+s+si}{\PYZpc{} o}\PY{l+s+s1}{f Loan Amount is below               :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{q4})
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{==========================================================================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
                  Created Date  Loan Amount  Unit Type    Loan Type  \textbackslash{}
Loan Officer Name                                                     
73ch126 61g45d3s    10/14/2014     506250.0  TwoFamily  Residential   
73ch126 61g45d3s    10/14/2014     206250.0      Condo  Residential   
63s1 63             10/14/2014     648700.0  TwoFamily  Residential   
73ch126 61g45d3s    10/14/2014     412750.0  TwoFamily  Residential   
7189r22t Bh1s38     10/14/2014     522588.0  TwoFamily          FHA   

                              City    Zip  
Loan Officer Name                          
73ch126 61g45d3s         Edgewater   7020  
73ch126 61g45d3s    EAST BRUNSWICK   8816  
63s1 63                   WOODSIDE  11377  
73ch126 61g45d3s   Jackson Heights  11370  
7189r22t Bh1s38     Queens Village  10461  
Created Date    2501
Loan Amount     2501
Unit Type       2501
Loan Type       2501
City            2501
Zip             2501
dtype: int64
=======================================================================
**********************  Loan Statistics for Mortgage Bank ***********************
 
Average Loan Amount is               :  \$ 445099.91
Median Loan Amount is                :  \$ 400000.00
 
Standard deviation of Loan Amount is :  \$ 288803.96
 
Minimum Loan Amount is               :  \$ 23600.00
Maximum Loan Amount is               :  \$ 6125000.00
 
Total of Loan Amount is              :  \$ 1113194869.34
 
10\% of Loan Amount is below               :  \$ 200000.00
25\% of Loan Amount is below               :  \$ 292500.00
50\% of Loan Amount is below               :  \$ 417000.00
75\% of Loan Amount is below               :  \$ 533000.00
90\% of Loan Amount is below               :  \$ 696500.00
 
==========================================================================

    \end{Verbatim}

    Loan Statistics for the Bank

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}52}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{=======================================================================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{**************** Qualification FICO  Statistics for Mortgage Bank ***************}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{n}{lo\PYZus{}df}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{fico} \PY{o}{=} \PY{n}{lo\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         \PY{n}{fico}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
         
         \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{scoreatpercentile}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
         
         \PY{n}{fico\PYZus{}q7} \PY{o}{=} \PY{n}{scoreatpercentile}\PY{p}{(}\PY{n}{lo\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}
         \PY{n}{fico\PYZus{}q0} \PY{o}{=} \PY{n}{scoreatpercentile}\PY{p}{(}\PY{n}{lo\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}
         \PY{n}{fico\PYZus{}q1} \PY{o}{=} \PY{n}{scoreatpercentile}\PY{p}{(}\PY{n}{lo\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{25}\PY{p}{)}
         \PY{n}{fico\PYZus{}q5} \PY{o}{=} \PY{n}{scoreatpercentile}\PY{p}{(}\PY{n}{lo\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{fico\PYZus{}q2} \PY{o}{=} \PY{n}{scoreatpercentile}\PY{p}{(}\PY{n}{lo\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{)}
         \PY{n}{fico\PYZus{}q6} \PY{o}{=} \PY{n}{scoreatpercentile}\PY{p}{(}\PY{n}{lo\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{65}\PY{p}{)}
         \PY{n}{fico\PYZus{}q3} \PY{o}{=} \PY{n}{scoreatpercentile}\PY{p}{(}\PY{n}{lo\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{75}\PY{p}{)}
         \PY{n}{fico\PYZus{}q4} \PY{o}{=} \PY{n}{scoreatpercentile}\PY{p}{(}\PY{n}{lo\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{90}\PY{p}{)}
         \PY{n}{fico\PYZus{}q8} \PY{o}{=} \PY{n}{scoreatpercentile}\PY{p}{(}\PY{n}{lo\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{95}\PY{p}{)}
         
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Average FICO is                  :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{lo\PYZus{}data}[\PYZsq{}Qualification FICO\PYZsq{}].mean())
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Median FICO is                   :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{lo\PYZus{}data}[\PYZsq{}Qualification FICO\PYZsq{}].median())
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Standard deviation is            :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{lo\PYZus{}data}[\PYZsq{}Qualification FICO\PYZsq{}].std())
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Minimum FICO is                  :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{lo\PYZus{}data}[\PYZsq{}Qualification FICO\PYZsq{}].min())
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Maximum FICO is                  :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{lo\PYZus{}data}[\PYZsq{}Qualification FICO\PYZsq{}].max())
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{5}\PY{l+s+si}{\PYZpc{} o}\PY{l+s+s1}{f FICO is below              :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{fico\PYZus{}q7})
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{10}\PY{l+s+si}{\PYZpc{} o}\PY{l+s+s1}{f FICO is below             :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{fico\PYZus{}q0})
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{25}\PY{l+s+si}{\PYZpc{} o}\PY{l+s+s1}{f FICO is below             :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{fico\PYZus{}q1})
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{40}\PY{l+s+si}{\PYZpc{} o}\PY{l+s+s1}{f FICO is below             :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{fico\PYZus{}q5})
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{50}\PY{l+s+si}{\PYZpc{} o}\PY{l+s+s1}{f FICO is below             :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{fico\PYZus{}q2})
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{65}\PY{l+s+si}{\PYZpc{} o}\PY{l+s+s1}{f FICO is below             :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{fico\PYZus{}q6})
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{75}\PY{l+s+si}{\PYZpc{} o}\PY{l+s+s1}{f FICO is below             :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{fico\PYZus{}q3})
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{90}\PY{l+s+si}{\PYZpc{} o}\PY{l+s+s1}{f FICO is below             :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{fico\PYZus{}q4})
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{95}\PY{l+s+si}{\PYZpc{} o}\PY{l+s+s1}{f FICO is below             :  \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{fico\PYZus{}q8})
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{==========================================================================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{n}{fico\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{n}{fico\PYZus{}q7}\PY{p}{,} \PY{n}{fico\PYZus{}q0}\PY{p}{,} \PY{n}{fico\PYZus{}q1}\PY{p}{,} \PY{n}{fico\PYZus{}q5}\PY{p}{,} \PY{n}{fico\PYZus{}q2}\PY{p}{,} \PY{n}{fico\PYZus{}q6}\PY{p}{,} \PY{n}{fico\PYZus{}q3}\PY{p}{,} \PY{n}{fico\PYZus{}q4}\PY{p}{,} \PY{n}{fico\PYZus{}q8}\PY{p}{]}
         \PY{n}{fico\PYZus{}pct}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{5}\PY{l+s+si}{\PYZpc{} Lo}\PY{l+s+s1}{an Below}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{10}\PY{l+s+si}{\PYZpc{} Lo}\PY{l+s+s1}{an Below}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{25}\PY{l+s+si}{\PYZpc{} Lo}\PY{l+s+s1}{an Below}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{40}\PY{l+s+si}{\PYZpc{} Lo}\PY{l+s+s1}{an Below}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{50}\PY{l+s+si}{\PYZpc{} Lo}\PY{l+s+s1}{an Below}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{65}\PY{l+s+si}{\PYZpc{} Lo}\PY{l+s+s1}{an Below}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{75}\PY{l+s+si}{\PYZpc{} Lo}\PY{l+s+s1}{an Below}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{90}\PY{l+s+si}{\PYZpc{} Lo}\PY{l+s+s1}{an Below}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{95}\PY{l+s+si}{\PYZpc{} Lo}\PY{l+s+s1}{an Below}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{75}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{850}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{fico\PYZus{}pct}\PY{p}{,} \PY{n}{fico\PYZus{}score}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO Scores}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO (}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mortgage Loans Qualification FICO  Statistics}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
=======================================================================
**************** Qualification FICO  Statistics for Mortgage Bank ***************
 
Average FICO is                  :  \$ 727.81
Median FICO is                   :  \$ 732.00
Standard deviation is            :  \$ 56.61
Minimum FICO is                  :  \$ 0.00
Maximum FICO is                  :  \$ 825.00
 
5\% of FICO is below              :  \$ 636.00
10\% of FICO is below             :  \$ 653.00
25\% of FICO is below             :  \$ 693.00
40\% of FICO is below             :  \$ 716.00
50\% of FICO is below             :  \$ 732.00
65\% of FICO is below             :  \$ 755.00
75\% of FICO is below             :  \$ 771.00
90\% of FICO is below             :  \$ 795.00
95\% of FICO is below             :  \$ 803.00
 
==========================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Mortgage Bank FICO Score Statistics

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{==============================================================================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{**************** Mortgage Loan Ofiicer}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Sales Volume per Loan Type ***************}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         
         \PY{n}{lo\PYZus{}loan} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Officer Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{}We can use groupby to organize the data by category and name.}
         \PY{n}{lo\PYZus{}loan\PYZus{}group} \PY{o}{=} \PY{n}{lo\PYZus{}loan}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Officer Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{lo\PYZus{}loan\PYZus{}group\PYZus{}count} \PY{o}{=} \PY{n}{lo\PYZus{}loan}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Officer Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{lo\PYZus{}loan\PYZus{}group}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{lo\PYZus{}loan\PYZus{}group\PYZus{}count}\PY{p}{)}
         
         \PY{n}{lo\PYZus{}loan}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
         
         \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}The category representation looks good but we need to break it apart}
         \PY{l+s+sd}{to graph it as a stacked bar graph. unstack can do this for us.\PYZsq{}\PYZsq{}\PYZsq{}}
         
         \PY{n}{lo\PYZus{}loan\PYZus{}group}\PY{o}{.}\PY{n}{unstack}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{lo\PYZus{}loan\PYZus{}group\PYZus{}plot} \PY{o}{=} \PY{n}{lo\PYZus{}loan\PYZus{}group}\PY{o}{.}\PY{n}{unstack}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{stacked}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Total Sales by Loan Officers by Loan Type}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{9}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{)}\PY{p}{)}
         \PY{n}{lo\PYZus{}loan\PYZus{}group\PYZus{}plot}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Loan Officers}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{lo\PYZus{}loan\PYZus{}group\PYZus{}plot}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Sales per Loan Type}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{lo\PYZus{}loan\PYZus{}group\PYZus{}plot}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Commercial}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Conventional}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{FHA}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Other}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{VA}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{ncol}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{l+m+mi}{10000000}\PY{p}{,} \PY{l+m+mi}{140000000}\PY{p}{)}
         
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{==============================================================================}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{**************** MWB Loan Ofiicers Sales Volume per Unit Type ***************}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{lo\PYZus{}unit} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Officer Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         
         \PY{n}{lo\PYZus{}unit\PYZus{}group} \PY{o}{=} \PY{n}{lo\PYZus{}unit}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Officer Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{lo\PYZus{}unit\PYZus{}group\PYZus{}count} \PY{o}{=} \PY{n}{lo\PYZus{}unit}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Officer Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{lo\PYZus{}unit\PYZus{}group}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{lo\PYZus{}unit\PYZus{}group\PYZus{}count}\PY{p}{)}
         
         \PY{n}{lo\PYZus{}unit}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
         
         
         \PY{n}{lo\PYZus{}unit\PYZus{}group}\PY{o}{.}\PY{n}{unstack}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{lo\PYZus{}unit\PYZus{}group\PYZus{}plot} \PY{o}{=} \PY{n}{lo\PYZus{}unit\PYZus{}group}\PY{o}{.}\PY{n}{unstack}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{stacked}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Total Sales by Loan Officers by Unit Type}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{9}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{)}\PY{p}{)}
         \PY{n}{lo\PYZus{}unit\PYZus{}group\PYZus{}plot}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Loan Officers}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{lo\PYZus{}loan\PYZus{}group\PYZus{}plot}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Sales per Unit Type}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
==============================================================================
**************** Mortgage Loan Ofiicer Sales Volume per Loan Type ***************
 
                                Loan Amount
Loan Officer Name Loan Type                
17281 Kh18        Commercial      990000.00
                  Conventional  17532050.00
                  FHA            7120707.00
                  Residential    4305900.00
185j t2st t2st2r  Conventional    963500.00
18g261 B5c3ch     Commercial      640000.00
                  Conventional    975000.00
1b5 Ch4wdh5ry     Commercial     1190000.00
                  Conventional  12606550.75
                  FHA            4841882.10
                  Other           559375.00
1s3f Kh18         Conventional   1461750.00
26g38 B528c48s2j4 Conventional   1165000.00
2d758d 9393t482   Conventional   1466550.00
2dw38 81v1rr2t2   Commercial     1659000.00
                  Conventional   8812068.00
                  FHA            3661645.68
                  Residential    1201500.00
6366y 622         Commercial     2120000.00
                  Conventional  23681675.00
                  FHA             862559.50
                  Residential    9965100.00
63s1 63           Commercial    10890550.00
                  Conventional  97425143.00
                  Other          5727000.00
                  Residential   25456150.00
63sh1 63          Conventional   6400000.00
                  Residential    5610000.00
7189r22t Bh1s38   Commercial     3400000.00
                  Conventional  49052251.00
{\ldots}                                     {\ldots}
J2ss3c1 Ch58g     Residential    8747200.00
J377y V1tt2s      Conventional   5664150.00
                  FHA             325000.00
                  Residential    3060000.00
J48g Y44k B12     Conventional    912000.00
                  FHA             191098.71
                  Other          1063500.00
J4h8 61g45d3s     Commercial    35513750.00
                  Conventional  13318000.00
                  FHA            1765647.00
                  Residential    6452000.00
J4s29h B5r2k      Conventional   1433450.00
                  FHA            2166395.94
K288y W5          Commercial     1215000.00
                  Conventional   3702700.00
R282 91671        Conventional   9010026.25
                  FHA            2468480.45
R2z1 74d3r3       Commercial      982000.00
                  Conventional   9280700.00
                  FHA            3134620.00
                  Residential     320000.00
St29h28 92ts2s    Conventional   6084000.00
                  FHA            2500287.65
                  Residential     500000.00
T47 Y35f13 8g     Conventional   1004900.00
V3v318 D2g531     Commercial      135920.00
                  Conventional  12104832.03
                  FHA           10876691.87
                  Residential    2131525.00
W48s24k 622       Conventional    901000.00

[121 rows x 1 columns]
                                Created Date  Loan Amount
Loan Officer Name Loan Type                              
17281 Kh18        Commercial               3            3
                  Conventional            44           44
                  FHA                     14           14
                  Residential              9            9
185j t2st t2st2r  Conventional             2            2
18g261 B5c3ch     Commercial               1            1
                  Conventional             2            2
1b5 Ch4wdh5ry     Commercial               1            1
                  Conventional            24           24
                  FHA                     10           10
                  Other                    2            2
1s3f Kh18         Conventional             2            2
26g38 B528c48s2j4 Conventional             2            2
2d758d 9393t482   Conventional             5            5
2dw38 81v1rr2t2   Commercial               3            3
                  Conventional            22           22
                  FHA                      9            9
                  Residential              3            3
6366y 622         Commercial               3            3
                  Conventional            57           57
                  FHA                      2            2
                  Residential             24           24
63s1 63           Commercial              14           14
                  Conventional           219          219
                  Other                    8            8
                  Residential             61           61
63sh1 63          Conventional            14           14
                  Residential             11           11
7189r22t Bh1s38   Commercial               1            1
                  Conventional           125          125
{\ldots}                                      {\ldots}          {\ldots}
J2ss3c1 Ch58g     Residential             28           28
J377y V1tt2s      Conventional            15           15
                  FHA                      1            1
                  Residential              5            5
J48g Y44k B12     Conventional             3            3
                  FHA                      1            1
                  Other                    2            2
J4h8 61g45d3s     Commercial              39           39
                  Conventional            22           22
                  FHA                      4            4
                  Residential             14           14
J4s29h B5r2k      Conventional             5            5
                  FHA                      6            6
K288y W5          Commercial               3            3
                  Conventional             6            6
R282 91671        Conventional            27           27
                  FHA                      7            7
R2z1 74d3r3       Commercial               2            2
                  Conventional            21           21
                  FHA                      7            7
                  Residential              1            1
St29h28 92ts2s    Conventional             5            5
                  FHA                      4            4
                  Residential              1            1
T47 Y35f13 8g     Conventional             3            3
V3v318 D2g531     Commercial               1            1
                  Conventional            46           46
                  FHA                     38           38
                  Residential              6            6
W48s24k 622       Conventional             2            2

[121 rows x 2 columns]
==============================================================================
**************** MWB Loan Ofiicers Sales Volume per Unit Type ***************
 
                               Loan Amount
Loan Officer Name Unit Type               
17281 Kh18        Condo         1322400.00
                  Coop           605600.00
                  FourFamily    1118000.00
                  OneFamily     6875515.25
                  PUD            390000.00
                  ThreeFamily   1298750.00
                  TwoFamily    18338391.75
185j t2st t2st2r  FourFamily     682500.00
                  ThreeFamily    281000.00
18g261 B5c3ch     OneFamily     1160000.00
                  ThreeFamily    455000.00
1b5 Ch4wdh5ry     Condo          159375.00
                  Coop           172000.00
                  OneFamily    12156944.10
                  ThreeFamily    695970.00
                  TwoFamily     6013518.75
1s3f Kh18         TwoFamily     1461750.00
26g38 B528c48s2j4 OneFamily      325000.00
                  TwoFamily      840000.00
2d758d 9393t482   Condo          331550.00
                  OneFamily      347000.00
                  PUD            268000.00
                  TwoFamily      520000.00
2dw38 81v1rr2t2   Condo          326000.00
                  Coop           105000.00
                  FourFamily     302706.00
                  MultiFamily    800000.00
                  OneFamily     3638713.63
                  PUD            300000.00
                  ThreeFamily   2003200.00
{\ldots}                                    {\ldots}
J4h8 61g45d3s     ThreeFamily   3260500.00
                  TwoFamily    11072000.00
                  Warehouse     4200000.00
J4s29h B5r2k      Condo          377800.00
                  OneFamily     2906620.94
                  TwoFamily      315425.00
K288y W5          OneFamily     2322700.00
                  ThreeFamily    282000.00
                  TwoFamily     2313000.00
R282 91671        Coop           453100.00
                  OneFamily    10620406.70
                  TwoFamily      405000.00
R2z1 74d3r3       Condo          653000.00
                  Coop           404000.00
                  FourFamily    1276100.00
                  Industrial     496000.00
                  OneFamily     4910190.00
                  ThreeFamily   1968000.00
                  TwoFamily     4010030.00
St29h28 92ts2s    FourFamily    1815750.00
                  OneFamily     4684537.65
                  PUD            300000.00
                  TwoFamily     2284000.00
T47 Y35f13 8g     Coop           580800.00
                  OneFamily      424100.00
V3v318 D2g531     Condo         1876590.03
                  FourFamily     880800.00
                  OneFamily    18247695.81
                  TwoFamily     4243883.06
W48s24k 622       Condo          901000.00

[189 rows x 1 columns]
                               Created Date  Loan Amount
Loan Officer Name Unit Type                             
17281 Kh18        Condo                   5            5
                  Coop                    5            5
                  FourFamily              2            2
                  OneFamily              15           15
                  PUD                     1            1
                  ThreeFamily             4            4
                  TwoFamily              38           38
185j t2st t2st2r  FourFamily              1            1
                  ThreeFamily             1            1
18g261 B5c3ch     OneFamily               2            2
                  ThreeFamily             1            1
1b5 Ch4wdh5ry     Condo                   1            1
                  Coop                    1            1
                  OneFamily              25           25
                  ThreeFamily             1            1
                  TwoFamily               9            9
1s3f Kh18         TwoFamily               2            2
26g38 B528c48s2j4 OneFamily               1            1
                  TwoFamily               1            1
2d758d 9393t482   Condo                   1            1
                  OneFamily               2            2
                  PUD                     1            1
                  TwoFamily               1            1
2dw38 81v1rr2t2   Condo                   1            1
                  Coop                    1            1
                  FourFamily              1            1
                  MultiFamily             1            1
                  OneFamily              12           12
                  PUD                     1            1
                  ThreeFamily             4            4
{\ldots}                                     {\ldots}          {\ldots}
J4h8 61g45d3s     ThreeFamily             6            6
                  TwoFamily              18           18
                  Warehouse               3            3
J4s29h B5r2k      Condo                   3            3
                  OneFamily               7            7
                  TwoFamily               1            1
K288y W5          OneFamily               5            5
                  ThreeFamily             1            1
                  TwoFamily               3            3
R282 91671        Coop                    1            1
                  OneFamily              31           31
                  TwoFamily               2            2
R2z1 74d3r3       Condo                   2            2
                  Coop                    1            1
                  FourFamily              2            2
                  Industrial              1            1
                  OneFamily              13           13
                  ThreeFamily             4            4
                  TwoFamily               8            8
St29h28 92ts2s    FourFamily              2            2
                  OneFamily               5            5
                  PUD                     1            1
                  TwoFamily               2            2
T47 Y35f13 8g     Coop                    2            2
                  OneFamily               1            1
V3v318 D2g531     Condo                  10           10
                  FourFamily              1            1
                  OneFamily              65           65
                  TwoFamily              15           15
W48s24k 622       Condo                   2            2

[189 rows x 2 columns]

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}53}]:} Text(0,0.5,'Sales per Unit Type')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_90_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_90_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    MWB Loan Ofiicers Sales Volume per Unit Type

The category representation looks good also displayed stacked bar graph
and. unstack can do this for us.''' Mortgage Loan Ofiicer'' Sales Volume
per Loan Type displayed and grahically displayed Loan Officer's Sales
Volume per Unit Type.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}54}]:} \PY{c+c1}{\PYZsh{}Importing data with date as without index}
         \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{c:/scripts/mwb2014.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{header}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cp1252}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    One of the really cool things that Pandas allows us to do is resample
the data. We want to look at the data by month, we can easily resample
and sum it all up. I'm using `M' as the period for resampling which
means the data should be resampled on a month boundary.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}55}]:} \PY{n}{loan\PYZus{}patterns} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         \PY{n}{loan\PYZus{}patterns}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
         \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
         \PY{l+s+sd}{If we want to analyze the data by date,}
         \PY{l+s+sd}{we need to set the date column as the index using set\PYZus{}index .}
         \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
         \PY{c+c1}{\PYZsh{}Convert Date Index}
         \PY{n}{loan\PYZus{}patterns}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DatetimeIndex}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{loan\PYZus{}patterns} \PY{o}{=} \PY{n}{loan\PYZus{}patterns}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{loan\PYZus{}patterns}\PY{o}{.}\PY{n}{index}
         \PY{n}{loan\PYZus{}patterns}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
         \PY{n}{monthly\PYZus{}loan\PYZus{}rev}\PY{o}{=}\PY{n}{loan\PYZus{}patterns}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n}{loan\PYZus{}patterns}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
         \PY{n}{loan\PYZus{}patterns\PYZus{}month\PYZus{}plot} \PY{o}{=} \PY{n}{loan\PYZus{}patterns}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{how}\PY{o}{=}\PY{n+nb}{sum}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Mortgage Bank \PYZhy{} Total Sales by Month}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{legend}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{loan\PYZus{}patterns\PYZus{}month\PYZus{}plot}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Months}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{loan\PYZus{}patterns\PYZus{}month\PYZus{}plot}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Monthly Slaes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{45}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{12000000}\PY{p}{,} \PY{l+m+mi}{35000000}\PY{p}{)}\PY{p}{)}
         \PY{n}{fig} \PY{o}{=} \PY{n}{loan\PYZus{}patterns\PYZus{}month\PYZus{}plot}\PY{o}{.}\PY{n}{get\PYZus{}figure}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 2501 entries, 2014-10-14 to 2018-12-27
Data columns (total 2 columns):
Loan Amount     2501 non-null float64
Created Date    2501 non-null object
dtypes: float64(1), object(1)
memory usage: 138.6+ KB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:8: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\_indexer,col\_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html\#indexing-view-versus-copy
  
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:15: FutureWarning: how in .resample() is deprecated
the new syntax is .resample({\ldots})..apply(<func>)
  from ipykernel import kernelapp as app

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_94_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    We can see that monthly mortgage loan sales volume varies between 15Mand
15Mand 32M. Another interesting find is Loan sales are at the peak
during summer seasons. Winter sales are normally slow but 2018 was an
exception.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{n}{loan\PYZus{}patterns}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Q}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n}{monthly\PYZus{}loan\PYZus{}rev}\PY{o}{=}\PY{n}{loan\PYZus{}patterns}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Q}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n}{loan\PYZus{}patterns}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
         \PY{n}{loan\PYZus{}patterns\PYZus{}month\PYZus{}plot} \PY{o}{=} \PY{n}{loan\PYZus{}patterns}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Q}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Mortgage Bank \PYZhy{} Total Sales by Quaters}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{legend}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{loan\PYZus{}patterns\PYZus{}month\PYZus{}plot}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Quaters}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{loan\PYZus{}patterns\PYZus{}month\PYZus{}plot}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Quaterly Slaes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{45}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{50000000}\PY{p}{,} \PY{l+m+mi}{80000000}\PY{p}{)}\PY{p}{)}
         \PY{n}{fig} \PY{o}{=} \PY{n}{loan\PYZus{}patterns\PYZus{}month\PYZus{}plot}\PY{o}{.}\PY{n}{get\PYZus{}figure}\PY{p}{(}\PY{p}{)}
         \PY{n}{fig}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c:/scripts/MWB/loan\PYZus{}patterns\PYZus{}month\PYZus{}plot.png}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 2501 entries, 2014-10-14 to 2018-12-27
Data columns (total 2 columns):
Loan Amount     2501 non-null float64
Created Date    2501 non-null object
dtypes: float64(1), object(1)
memory usage: 138.6+ KB

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_96_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Mortgage Bank's Quarterly Sales Revenue varies between 50 (millions) and
77 (millions)

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}57}]:} \PY{c+c1}{\PYZsh{}Monthy Sales Sorted}
         \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
         \PY{l+s+sd}{Grouping on a function of the index}
         \PY{l+s+sd}{Groupby operations can also be performed on transformations}
         \PY{l+s+sd}{of the index values. In the case of a DateTimeIndex,}
         \PY{l+s+sd}{we can extract portions of the datetime over which to group.}
         \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
         
         \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{c:/scripts/mwb2014.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index\PYZus{}col}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{parse\PYZus{}dates}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cp1252}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{} Create a groupby object: by\PYZus{}day}
         \PY{n}{by\PYZus{}month} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{strftime}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{B}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{by\PYZus{}year} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{strftime}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{by\PYZus{}day} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{strftime}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{a}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
         \PY{l+s+sd}{\PYZpc{}a \PYZhy{} day}
         \PY{l+s+sd}{\PYZpc{}m \PYZhy{} month (01 to 12)}
         \PY{l+s+sd}{\PYZpc{}b \PYZhy{} abbreviated month name}
         \PY{l+s+sd}{\PYZpc{}B \PYZhy{} full month name}
         \PY{l+s+sd}{\PYZpc{}y \PYZhy{} year without a century (range 00 to 99)}
         \PY{l+s+sd}{\PYZpc{}Y \PYZhy{} year including the century}
         \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
         
         
         \PY{c+c1}{\PYZsh{} Create sum: units\PYZus{}sum}
         \PY{n}{monthly\PYZus{}loan\PYZus{}amount\PYZus{}sum} \PY{o}{=} \PY{n}{by\PYZus{}month}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n}{daily\PYZus{}loan\PYZus{}amount\PYZus{}sum} \PY{o}{=} \PY{n}{by\PYZus{}day}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{yearly\PYZus{}loan\PYZus{}amount\PYZus{}sum} \PY{o}{=} \PY{n}{by\PYZus{}year}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{monthly\PYZus{}loan\PYZus{}amount\PYZus{}sum} \PY{o}{=} \PY{n}{monthly\PYZus{}loan\PYZus{}amount\PYZus{}sum}
         
         \PY{c+c1}{\PYZsh{} Print units\PYZus{}sum}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{monthly\PYZus{}loan\PYZus{}amount\PYZus{}sum}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{yearly\PYZus{}loan\PYZus{}amount\PYZus{}sum}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{daily\PYZus{}loan\PYZus{}amount\PYZus{}sum}\PY{p}{)}
         
         \PY{n}{formatter} \PY{o}{=} \PY{n}{FuncFormatter}\PY{p}{(}\PY{n}{millions}\PY{p}{)}
         \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{formatter}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Origination Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mortgage Bank : 48 Months Total \PYZhy{} Monthly Loan Sales}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{monthly\PYZus{}loan\PYZus{}amount\PYZus{}sum}\PY{p}{)}
         
         
         \PY{n}{monthly\PYZus{}loan\PYZus{}amount\PYZus{}sum\PYZus{}sorted}\PY{o}{=} \PY{n}{monthly\PYZus{}loan\PYZus{}amount\PYZus{}sum}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Print units\PYZus{}sum}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{monthly\PYZus{}loan\PYZus{}amount\PYZus{}sum}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{yearly\PYZus{}loan\PYZus{}amount\PYZus{}sum}\PY{p}{)}
         
         \PY{n}{formatter} \PY{o}{=} \PY{n}{FuncFormatter}\PY{p}{(}\PY{n}{millions}\PY{p}{)}
         \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{formatter}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Origination Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MWB : 24 Months Total \PYZhy{} Monthly Loan Sales (Sorted)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{monthly\PYZus{}loan\PYZus{}amount\PYZus{}sum\PYZus{}sorted}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
April        8.013326e+07
August       9.292258e+07
December     1.013868e+08
February     8.921963e+07
January      8.160879e+07
July         8.750879e+07
June         1.005480e+08
March        9.510573e+07
May          9.824521e+07
November     9.936588e+07
October      1.094211e+08
September    7.772900e+07
Name: Loan Amount, dtype: float64
Y    1.113195e+09
Name: Loan Amount, dtype: float64
Fri    2.052834e+08
Mon    2.048027e+08
Sat    1.376921e+07
Sun    1.584283e+07
Thu    2.190100e+08
Tue    2.355647e+08
Wed    2.189220e+08
Name: Loan Amount, dtype: float64
April        8.013326e+07
August       9.292258e+07
December     1.013868e+08
February     8.921963e+07
January      8.160879e+07
July         8.750879e+07
June         1.005480e+08
March        9.510573e+07
May          9.824521e+07
November     9.936588e+07
October      1.094211e+08
September    7.772900e+07
Name: Loan Amount, dtype: float64
Y    1.113195e+09
Name: Loan Amount, dtype: float64

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}57}]:} [<matplotlib.lines.Line2D at 0x2564926a588>]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_98_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_98_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Monthly Worst Sales: January, April and September and Best is June,
December and October.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}58}]:} \PY{n}{lo\PYZus{}zip}\PY{o}{=}\PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Officer Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Zip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{lo\PYZus{}zip\PYZus{}count} \PY{o}{=} \PY{n}{lo\PYZus{}zip}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Zip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}
         \PY{n}{lo\PYZus{}zip\PYZus{}filt} \PY{o}{=} \PY{n}{lo\PYZus{}zip}\PY{o}{.}\PY{n}{filter}\PY{p}{(}\PY{k}{lambda} \PY{n}{c}\PY{p}{:}\PY{n}{c}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Zip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{3}\PY{p}{)}
         
         \PY{n}{lo\PYZus{}zip\PYZus{}filt\PYZus{}top10}\PY{o}{=} \PY{p}{(}\PY{n}{lo\PYZus{}zip\PYZus{}filt}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Zip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Top 10 marketing location by Zip Codes : }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lo\PYZus{}zip\PYZus{}filt\PYZus{}top10}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Top 10 marketing location by Zip Codes :  Zip
7650     79
11223    62
11229    50
11432    37
11208    33
7621     30
11355    30
11103    29
11203    28
11420    25
dtype: int64

    \end{Verbatim}

    Top Ten Loan Origination Zip COde. Bank can focus more on marketting to
generate more revenue

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}59}]:} \PY{k+kn}{import} \PY{n+nn}{datetime}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
         \PY{k+kn}{import} \PY{n+nn}{calendar}
         \PY{k+kn}{from} \PY{n+nn}{time} \PY{k}{import} \PY{n}{strptime}
         \PY{c+c1}{\PYZsh{}data = pd.read\PYZus{}csv(\PYZsq{}c:/scripts/mwb2014.csv\PYZsq{}, index\PYZus{}col=\PYZsq{}Created Date\PYZsq{}, header=0, encoding=\PYZsq{}cp1252\PYZsq{})}
         \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{c:/scripts/mwb2014.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{header}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cp1252}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{M\PYZus{}loan\PYZus{}city\PYZus{}num}\PY{o}{=}\PY{n}{data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LoanInMonth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         \PY{n}{M\PYZus{}loan\PYZus{}city\PYZus{}num}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DatetimeIndex}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{M\PYZus{}loan\PYZus{}city\PYZus{}num} \PY{o}{=} \PY{n}{M\PYZus{}loan\PYZus{}city\PYZus{}num}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{M\PYZus{}loan\PYZus{}city\PYZus{}num\PYZus{}2017} \PY{o}{=} \PY{n}{M\PYZus{}loan\PYZus{}city\PYZus{}num}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2017\PYZhy{}1\PYZhy{}1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2017\PYZhy{}9\PYZhy{}16}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{c+c1}{\PYZsh{}lender\PYZus{}loan\PYZus{}amount\PYZus{}sum\PYZus{}2017 = lender\PYZus{}loan\PYZus{}amount\PYZus{}2017.groupby([\PYZsq{}Lender Name\PYZsq{}]).sum()}
         \PY{c+c1}{\PYZsh{}lender\PYZus{}loan\PYZus{}amount\PYZus{}sum\PYZus{}2017 = lender\PYZus{}loan\PYZus{}amount\PYZus{}sum\PYZus{}2017[\PYZsq{}Loan Amount\PYZsq{}].sort\PYZus{}values(ascending=False)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2017 : }\PY{l+s+s1}{\PYZsq{}} \PY{p}{,} \PY{n}{M\PYZus{}loan\PYZus{}city\PYZus{}num\PYZus{}2017}\PY{p}{)}
         \PY{n}{M\PYZus{}loan\PYZus{}city\PYZus{}num\PYZus{}2018} \PY{o}{=} \PY{n}{M\PYZus{}loan\PYZus{}city\PYZus{}num}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2018\PYZhy{}1\PYZhy{}1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2018\PYZhy{}9\PYZhy{}16}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{c+c1}{\PYZsh{}lender\PYZus{}loan\PYZus{}amount\PYZus{}sum\PYZus{}2018 = lender\PYZus{}loan\PYZus{}amount\PYZus{}2018.groupby([\PYZsq{}Lender Name\PYZsq{}]).sum()}
         \PY{c+c1}{\PYZsh{}lender\PYZus{}loan\PYZus{}amount\PYZus{}sum\PYZus{}2018 = lender\PYZus{}loan\PYZus{}amount\PYZus{}sum\PYZus{}2018[\PYZsq{}Loan Amount\PYZsq{}].sort\PYZus{}values(ascending=False)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2018 : }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{M\PYZus{}loan\PYZus{}city\PYZus{}num\PYZus{}2018}\PY{p}{)}
         
         \PY{n}{M17}\PY{o}{=} \PY{n}{M\PYZus{}loan\PYZus{}city\PYZus{}num\PYZus{}2017}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{M17}\PY{o}{.}\PY{n}{index}\PY{o}{=}\PY{n}{M17}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{month}
         \PY{n}{M18}\PY{o}{=} \PY{n}{M\PYZus{}loan\PYZus{}city\PYZus{}num\PYZus{}2018}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{M18}\PY{o}{.}\PY{n}{index}\PY{o}{=}\PY{n}{M18}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{month}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{M\PYZus{}loan\PYZus{}city\PYZus{}num\PYZus{}2017}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{M\PYZus{}loan\PYZus{}city\PYZus{}num\PYZus{}2018}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{M\PYZus{}loan\PYZus{}city\PYZus{}num\PYZus{}2017\PYZus{}plot} \PY{o}{=} \PY{n}{M\PYZus{}loan\PYZus{}city\PYZus{}num\PYZus{}2017}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MWB Total Monthly Sales for 2017}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{legend}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan origination Quarters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{60}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loans per Quarters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MWB Monthly Loan numbers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{M\PYZus{}loan\PYZus{}city\PYZus{}num\PYZus{}2018\PYZus{}plot} \PY{o}{=} \PY{n}{M\PYZus{}loan\PYZus{}city\PYZus{}num\PYZus{}2018}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MWB Total Monthly Sales for  2018}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{legend}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{M17}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{p}{[}\PY{n}{calendar}\PY{o}{.}\PY{n}{month\PYZus{}name}\PY{p}{[}\PY{n}{month}\PY{p}{]} \PY{k}{for} \PY{n}{month} \PY{o+ow}{in} \PY{n}{M17}\PY{p}{]}\PY{p}{,} \PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{60}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan origination Months}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{60}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loans per Months}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MWB Monthly Loan numbers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xticks(x, (\PYZsq{}Jan\PYZsq{}, \PYZsq{}Feb\PYZsq{}, \PYZsq{}Mar\PYZsq{}, \PYZsq{}Apr\PYZsq{}, \PYZsq{}May\PYZsq{}, \PYZsq{}Jun\PYZsq{}, \PYZsq{}Jul\PYZsq{}, \PYZsq{}Aug\PYZsq{}, \PYZsq{}Sep\PYZsq{}))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:12: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\_indexer,col\_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html\#indexing-view-versus-copy
  if sys.path[0] == '':
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:24: FutureWarning: how in .resample() is deprecated
the new syntax is .resample({\ldots}).count()
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:26: FutureWarning: how in .resample() is deprecated
the new syntax is .resample({\ldots}).count()
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:28: FutureWarning: how in .resample() is deprecated
the new syntax is .resample({\ldots}).count()
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:29: FutureWarning: how in .resample() is deprecated
the new syntax is .resample({\ldots}).count()
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:31: FutureWarning: how in .resample() is deprecated
the new syntax is .resample({\ldots}).count()
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:38: FutureWarning: how in .resample() is deprecated
the new syntax is .resample({\ldots}).count()

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
2017 :             Created Date  LoanInMonth
date                                
2017-01-02     1/2/2017            1
2017-01-03     1/3/2017            2
2017-01-03     1/3/2017            3
2017-01-04     1/4/2017            4
2017-01-04     1/4/2017            5
2017-01-04     1/4/2017            6
2017-01-04     1/4/2017            7
2017-01-04     1/4/2017            8
2017-01-05     1/5/2017            9
2017-01-05     1/5/2017           10
2017-01-09     1/9/2017           11
2017-01-09     1/9/2017           12
2017-01-11    1/11/2017           13
2017-01-11    1/11/2017           14
2017-01-12    1/12/2017           15
2017-01-13    1/13/2017           31
2017-01-16    1/16/2017           17
2017-01-16    1/16/2017           18
2017-01-16    1/16/2017           19
2017-01-17    1/17/2017           20
2017-01-17    1/17/2017           21
2017-01-17    1/17/2017           22
2017-01-18    1/18/2017           23
2017-01-19    1/19/2017           24
2017-01-19    1/19/2017           25
2017-01-19    1/19/2017           26
2017-01-20    1/20/2017           27
2017-01-20    1/20/2017           28
2017-01-23    1/23/2017           29
2017-01-23    1/23/2017           30
{\ldots}                 {\ldots}          {\ldots}
2017-08-23    8/23/2017           39
2017-08-23    8/23/2017           40
2017-08-24    8/24/2017           41
2017-08-25    8/25/2017           42
2017-08-25    8/25/2017           43
2017-08-28    8/28/2017            7
2017-08-28    8/28/2017           44
2017-08-29    8/29/2017           46
2017-08-29    8/29/2017           47
2017-08-29    8/29/2017           48
2017-08-30    8/30/2017           49
2017-08-30    8/30/2017           50
2017-08-31    8/31/2017           51
2017-09-01     9/1/2017            1
2017-09-05     9/5/2017            2
2017-09-07     9/7/2017            3
2017-09-07     9/7/2017            4
2017-09-07     9/7/2017            7
2017-09-07     9/7/2017            5
2017-09-11    9/11/2017            6
2017-09-12    9/12/2017            8
2017-09-12    9/12/2017            9
2017-09-12    9/12/2017           10
2017-09-12    9/12/2017           11
2017-09-13    9/13/2017           12
2017-09-13    9/13/2017           13
2017-09-13    9/13/2017           14
2017-09-13    9/13/2017           15
2017-09-14    9/14/2017           16
2017-09-16    9/16/2017           17

[412 rows x 2 columns]
2018 :             Created Date  LoanInMonth
date                                
2018-01-01     1/1/2018           40
2018-01-01     1/1/2018           40
2018-01-02     1/2/2018            4
2018-01-02     1/2/2018            3
2018-01-03     1/3/2018            5
2018-01-04     1/4/2018            6
2018-01-04     1/4/2018            7
2018-01-08     1/8/2018            8
2018-01-08     1/8/2018            9
2018-01-09     1/9/2018           10
2018-01-10    1/10/2018           11
2018-01-10    1/10/2018           12
2018-01-11    1/11/2018           13
2018-01-11    1/11/2018           16
2018-01-11    1/11/2018           14
2018-01-11    1/11/2018           19
2018-01-12    1/12/2018           15
2018-01-12    1/12/2018           17
2018-01-12    1/12/2018           18
2018-01-17    1/17/2018           20
2018-01-17    1/17/2018           21
2018-01-17    1/17/2018           22
2018-01-18    1/18/2018           23
2018-01-19    1/19/2018           24
2018-01-19    1/19/2018           25
2018-01-19    1/19/2018           26
2018-01-19    1/19/2018           27
2018-01-22    1/22/2018           28
2018-01-23    1/23/2018           29
2018-01-23    1/23/2018           30
{\ldots}                 {\ldots}          {\ldots}
2018-08-21    8/21/2018           26
2018-08-21    8/21/2018           27
2018-08-21    8/21/2018           28
2018-08-22    8/22/2018           29
2018-08-22    8/22/2018           30
2018-08-23    8/23/2018           31
2018-08-23    8/23/2018           32
2018-08-24    8/24/2018           33
2018-08-27    8/27/2018           34
2018-08-27    8/27/2018           35
2018-08-28    8/28/2018           36
2018-08-28    8/28/2018           37
2018-08-28    8/28/2018           38
2018-08-28    8/28/2018           39
2018-08-28    8/28/2018           40
2018-08-29    8/29/2018           41
2018-08-31    8/31/2018           42
2018-09-04     9/4/2018            1
2018-09-05     9/5/2018            2
2018-09-05     9/5/2018            3
2018-09-05     9/5/2018            4
2018-09-05     9/5/2018            5
2018-09-06     9/6/2018            6
2018-09-07     9/7/2018            7
2018-09-07     9/7/2018            8
2018-09-07     9/7/2018            9
2018-09-07     9/7/2018           10
2018-09-11    9/11/2018           11
2018-09-13    9/13/2018           12
2018-09-14    9/14/2018           13

[384 rows x 2 columns]
            Created Date  LoanInMonth
date                                 
2017-01-31            42           42
2017-02-28            47           47
2017-03-31            68           68
2017-04-30            36           36
2017-05-31            70           70
2017-06-30            44           44
2017-07-31            37           37
2017-08-31            51           51
2017-09-30            17           17
            Created Date  LoanInMonth
date                                 
2018-01-31            49           49
2018-02-28            47           47
2018-03-31            46           46
2018-04-30            39           39
2018-05-31            50           50
2018-06-30            59           59
2018-07-31            39           39
2018-08-31            42           42
2018-09-30            13           13

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        TypeError                                 Traceback (most recent call last)

        <ipython-input-59-5cb763a00499> in <module>()
         37 
         38 M\_loan\_city\_num\_2018\_plot = M\_loan\_city\_num\_2018.resample('M',how='count').plot(title="MWB Total Monthly Sales for  2018",legend=True)
    ---> 39 plt.xticks(range(len(M17)),[calendar.month\_name[month] for month in M17], rotation=60)
         40 
         41 plt.xlabel('Loan origination Months')
    

        <ipython-input-59-5cb763a00499> in <listcomp>(.0)
         37 
         38 M\_loan\_city\_num\_2018\_plot = M\_loan\_city\_num\_2018.resample('M',how='count').plot(title="MWB Total Monthly Sales for  2018",legend=True)
    ---> 39 plt.xticks(range(len(M17)),[calendar.month\_name[month] for month in M17], rotation=60)
         40 
         41 plt.xlabel('Loan origination Months')
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}calendar.py in \_\_getitem\_\_(self, i)
         57 
         58     def \_\_getitem\_\_(self, i):
    ---> 59         funcs = self.\_months[i]
         60         if isinstance(i, slice):
         61             return [f(self.format) for f in funcs]
    

        TypeError: list indices must be integers or slices, not str

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_102_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_102_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    We can see number of loan closed per month (Comparing data for 2017 \&
2018)

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}61}]:} \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{patches} \PY{k}{as} \PY{n+nn}{mpatches}
         \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{c:/scripts/mwb2014.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cp1252}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{M\PYZus{}loan\PYZus{}amount\PYZus{}num}\PY{o}{=}\PY{n}{data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         
         \PY{n}{M\PYZus{}loan\PYZus{}amount\PYZus{}num}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DatetimeIndex}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{M\PYZus{}loan\PYZus{}amount\PYZus{}num} \PY{o}{=} \PY{n}{M\PYZus{}loan\PYZus{}amount\PYZus{}num}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{M\PYZus{}loan\PYZus{}amount\PYZus{}num\PYZus{}2017} \PY{o}{=} \PY{n}{M\PYZus{}loan\PYZus{}amount\PYZus{}num}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2017\PYZhy{}1\PYZhy{}1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2017\PYZhy{}9\PYZhy{}30}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{c+c1}{\PYZsh{}print(\PYZsq{}2017 : \PYZsq{} , M\PYZus{}loan\PYZus{}amount\PYZus{}num\PYZus{}2017)}
         \PY{n}{M\PYZus{}loan\PYZus{}amount\PYZus{}num\PYZus{}2018} \PY{o}{=} \PY{n}{M\PYZus{}loan\PYZus{}amount\PYZus{}num}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2018\PYZhy{}1\PYZhy{}1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2018\PYZhy{}9\PYZhy{}30}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{c+c1}{\PYZsh{}print(\PYZsq{}2018 : \PYZsq{}, M\PYZus{}loan\PYZus{}amount\PYZus{}num\PYZus{}2018)}
         
         \PY{c+c1}{\PYZsh{} =============================================================================}
         \PY{c+c1}{\PYZsh{} by\PYZus{}month = data.groupby(data.index.strftime(\PYZsq{}\PYZpc{}B\PYZsq{}))}
         \PY{c+c1}{\PYZsh{} by\PYZus{}year = data.groupby(data.index.strftime(\PYZsq{}Y\PYZsq{}))}
         \PY{c+c1}{\PYZsh{} by\PYZus{}day = data.groupby(data.index.strftime(\PYZsq{}\PYZpc{}a\PYZsq{}))}
         \PY{c+c1}{\PYZsh{}}
         \PY{c+c1}{\PYZsh{} =============================================================================}
         \PY{n}{M\PYZus{}amount\PYZus{}17}\PY{o}{=} \PY{n}{M\PYZus{}loan\PYZus{}amount\PYZus{}num\PYZus{}2017}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n}{M\PYZus{}amount\PYZus{}17}\PY{o}{.}\PY{n}{index}\PY{o}{=}\PY{n}{M\PYZus{}amount\PYZus{}17}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{month}
         \PY{n}{M\PYZus{}amount\PYZus{}18}\PY{o}{=} \PY{n}{M\PYZus{}loan\PYZus{}amount\PYZus{}num\PYZus{}2018}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n}{M\PYZus{}amount\PYZus{}18}\PY{o}{.}\PY{n}{index}\PY{o}{=}\PY{n}{M\PYZus{}amount\PYZus{}18}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{month}
         \PY{n}{M\PYZus{}amount\PYZus{}17}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n}{M\PYZus{}amount\PYZus{}18}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         
         \PY{k+kn}{from} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{ticker} \PY{k}{import} \PY{n}{FuncFormatter}
         
         
         \PY{n}{x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
         \PY{n}{money} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{1.5e5}\PY{p}{,} \PY{l+m+mf}{2.5e6}\PY{p}{,} \PY{l+m+mf}{5.5e6}\PY{p}{,} \PY{l+m+mf}{1.0e7}\PY{p}{,} \PY{l+m+mf}{2.0e7}\PY{p}{,} \PY{l+m+mf}{3.0e7}\PY{p}{,} \PY{l+m+mf}{4.0e7}\PY{p}{,} \PY{l+m+mf}{5.0e7}\PY{p}{,} \PY{l+m+mf}{6.0e7}\PY{p}{]}
         
         
         \PY{k}{def} \PY{n+nf}{millions}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{pos}\PY{p}{)}\PY{p}{:}
             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The two args are the value and tick position}\PY{l+s+s1}{\PYZsq{}}
             \PY{k}{return} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+si}{\PYZpc{}1.1f}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{x} \PY{o}{*} \PY{l+m+mf}{1e\PYZhy{}6}\PY{p}{)}
         
         
         \PY{n}{formatter} \PY{o}{=} \PY{n}{FuncFormatter}\PY{p}{(}\PY{n}{millions}\PY{p}{)}
         
         \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{formatter}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{M\PYZus{}amount\PYZus{}17}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{M\PYZus{}amount\PYZus{}18}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{red\PYZus{}patch} \PY{o}{=} \PY{n}{mpatches}\PY{o}{.}\PY{n}{Patch}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2017 Loans (Jan \PYZhy{} Sep) Total: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{M\PYZus{}amount\PYZus{}17}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{p}{)}
         
         \PY{n}{blue\PYZus{}patch} \PY{o}{=} \PY{n}{mpatches}\PY{o}{.}\PY{n}{Patch}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2018 Loans (Jan \PYZhy{} Sep) Total: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}  \PY{n}{M\PYZus{}amount\PYZus{}18}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{handles}\PY{o}{=}\PY{p}{[}\PY{n}{red\PYZus{}patch}\PY{p}{,} \PY{n}{blue\PYZus{}patch}\PY{p}{]}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print(\PYZsq{}Total Loans in 2017 :\PYZsq{}, M17[\PYZsq{}Created Date\PYZsq{}].sum(), \PYZsq{}\PYZbs{}nTotal Loans in 2018 :\PYZsq{}, M18[\PYZsq{}Created Date\PYZsq{}].sum())}
         
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{M17}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{p}{[}\PY{n}{calendar}\PY{o}{.}\PY{n}{month\PYZus{}name}\PY{p}{[}\PY{n}{month}\PY{p}{]} \PY{k}{for} \PY{n}{month} \PY{o+ow}{in} \PY{n}{M17}\PY{o}{.}\PY{n}{index}\PY{p}{]}\PY{p}{,} \PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{60}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan origination Months}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xticks(rotation=60)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loans per Months}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mortgage Monthly Loan numbers 2017 \PYZam{} 2018: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:6: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\_indexer,col\_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html\#indexing-view-versus-copy
  

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_104_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Comparing Mortgage Monthly Loan numbers 2017 \& 2018

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}62}]:} \PY{n}{M\PYZus{}amount\PYZus{}17}\PY{o}{=} \PY{n}{M\PYZus{}loan\PYZus{}amount\PYZus{}num\PYZus{}2017}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n}{M\PYZus{}amount\PYZus{}17}\PY{o}{.}\PY{n}{index}\PY{o}{=}\PY{n}{M\PYZus{}amount\PYZus{}17}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{month}
         \PY{n}{M\PYZus{}amount\PYZus{}18}\PY{o}{=} \PY{n}{M\PYZus{}loan\PYZus{}amount\PYZus{}num\PYZus{}2018}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n}{M\PYZus{}amount\PYZus{}18}\PY{o}{.}\PY{n}{index}\PY{o}{=}\PY{n}{M\PYZus{}amount\PYZus{}18}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{month}
         \PY{n}{M\PYZus{}amount\PYZus{}17}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n}{M\PYZus{}amount\PYZus{}18}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         
         \PY{k+kn}{from} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{ticker} \PY{k}{import} \PY{n}{FuncFormatter}
         
         
         \PY{n}{x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
         \PY{n}{money} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{1.5e5}\PY{p}{,} \PY{l+m+mf}{2.5e6}\PY{p}{,} \PY{l+m+mf}{5.5e6}\PY{p}{,} \PY{l+m+mf}{1.0e7}\PY{p}{,} \PY{l+m+mf}{2.0e7}\PY{p}{,} \PY{l+m+mf}{3.0e7}\PY{p}{,} \PY{l+m+mf}{4.0e7}\PY{p}{,} \PY{l+m+mf}{5.0e7}\PY{p}{,} \PY{l+m+mf}{6.0e7}\PY{p}{]}
         
         
         \PY{k}{def} \PY{n+nf}{millions}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{pos}\PY{p}{)}\PY{p}{:}
             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The two args are the value and tick position}\PY{l+s+s1}{\PYZsq{}}
             \PY{k}{return} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+si}{\PYZpc{}1.1f}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{x} \PY{o}{*} \PY{l+m+mf}{1e\PYZhy{}6}\PY{p}{)}
         
         
         \PY{n}{formatter} \PY{o}{=} \PY{n}{FuncFormatter}\PY{p}{(}\PY{n}{millions}\PY{p}{)}
         
         \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{formatter}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{M\PYZus{}amount\PYZus{}17}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{M\PYZus{}amount\PYZus{}18}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{red\PYZus{}patch} \PY{o}{=} \PY{n}{mpatches}\PY{o}{.}\PY{n}{Patch}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2017 Loans (Jan \PYZhy{} Sep) Total: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{M\PYZus{}amount\PYZus{}17}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{p}{)}
         
         \PY{n}{blue\PYZus{}patch} \PY{o}{=} \PY{n}{mpatches}\PY{o}{.}\PY{n}{Patch}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2018 Loans (Jan \PYZhy{} Sep) Total: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}  \PY{n}{M\PYZus{}amount\PYZus{}18}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{handles}\PY{o}{=}\PY{p}{[}\PY{n}{red\PYZus{}patch}\PY{p}{,} \PY{n}{blue\PYZus{}patch}\PY{p}{]}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print(\PYZsq{}Total Loans in 2017 :\PYZsq{}, M17[\PYZsq{}Created Date\PYZsq{}].sum(), \PYZsq{}\PYZbs{}nTotal Loans in 2018 :\PYZsq{}, M18[\PYZsq{}Created Date\PYZsq{}].sum())}
         
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{M17}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{p}{[}\PY{n}{calendar}\PY{o}{.}\PY{n}{month\PYZus{}name}\PY{p}{[}\PY{n}{month}\PY{p}{]} \PY{k}{for} \PY{n}{month} \PY{o+ow}{in} \PY{n}{M17}\PY{o}{.}\PY{n}{index}\PY{p}{]}\PY{p}{,} \PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{60}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan origination Months}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xticks(rotation=60)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loans per Months}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Caomparing Mortgage Monthly Loan Sales Revenue between 2017 \PYZam{} 2018: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_106_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    In 2017, Mortgage Bank sales revenue was (M\_amount\_17.sum()) = \$180M

In 2018, Mortgage Bank sales revenue was (M\_amount\_18.sum()) = \$197M

We have seen numbers of loan closed went down, but sales revenue went
up. Main reason behind this, housing price went up, which drive average
loan amount to increase. As a result total sales went up for 2018
comparing 2017

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}63}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pearson correlation coefficient between Loan number and Loan Revenue: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{r\PYZus{}monthly\PYZus{}loan\PYZus{}num\PYZus{}data\PYZus{}monthly\PYZus{}loan\PYZus{}rev}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Pearson correlation coefficient between Loan number and Loan Revenue:  (array([0.84472037]), array([6.63988048e-15]))

    \end{Verbatim}

    As we have seen earlier earlier, there is positive strong correlation
(0.844) between Loan number and Loan Revenue.

Monthly Loan numbers and Monthly Sales volumes are strongly positively
correlated. Once we analyze number of the loans closed per month, we
find the similarity between sales volume and loan numbers. As average
loan numbers goes up, total monthly sales volume goes up. Any given
months, if the number of loans closed are higher; we find that average
loan amounts are low for that particular months. In other words, this
may suggest that loan processing requirements and guidelines loans with
higher loan amount take longer time to close the loans with lower loan
amounts.

    '''Visual exploration is the most effective way to extract information
between variables.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}64}]:} \PY{k+kn}{import} \PY{n+nn}{pylab}  \PY{c+c1}{\PYZsh{}Plotting}
         \PY{k+kn}{import} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{as} \PY{n+nn}{stats} \PY{c+c1}{\PYZsh{} scintific calculation}
         \PY{n}{stats}\PY{o}{.}\PY{n}{probplot}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{dist}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{norm}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{plot}\PY{o}{=}\PY{n}{pylab}\PY{p}{)}
         \PY{n}{pylab}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{n+nb}{type}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}type(model)}
         \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
         \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_111_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Index: 2501 entries, 1/1/2018 to 9/9/2016
Data columns (total 12 columns):
Loan Amount           2501 non-null float64
city\_code             2501 non-null int16
zip\_code              2501 non-null int16
loan\_purpose\_code     2501 non-null int64
Qualification FICO    2501 non-null int64
unit\_type\_code        2501 non-null int64
loan\_type\_code        2501 non-null int64
Fix\_True              2501 non-null uint8
CLTV                  2501 non-null float64
LoanInMonth           2501 non-null int64
RATE                  2501 non-null float64
Home                  2501 non-null float64
dtypes: float64(4), int16(2), int64(5), uint8(1)
memory usage: 207.6+ KB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{columns}
         \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{columns} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{5}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{index}\PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{n}{columns}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_112_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_112_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_112_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_112_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subparagraph{Print the scatter plot for each (Column 1-5) feature with
respect to Loan
Amount}\label{print-the-scatter-plot-for-each-column-1-5-feature-with-respect-to-loan-amount}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}66}]:} \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{columns} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{l+m+mi}{6}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{index}\PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{n}{columns}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_114_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_114_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_114_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_114_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subparagraph{Print the scatter plot for each (Column 6-10) feature with
respect to Loan
Amount}\label{print-the-scatter-plot-for-each-column-6-10-feature-with-respect-to-loan-amount}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}67}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RATE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RATE}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{US10Y Rate Distribution}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Frequency}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Home}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{New Home Supply}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Hosing Supplyn}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Frequency}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_116_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_116_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}68}]:} \PY{c+c1}{\PYZsh{}This distribution is somewhat normal distribution}
         
         \PY{c+c1}{\PYZsh{}The distribution is somewhat left skewed with a mean to the left}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}69}]:} \PY{c+c1}{\PYZsh{}Plot \PYZsq{}10 Years T\PYZhy{}RATE\PYZsq{} and \PYZsq{}House Supply\PYZsq{} on the same Axis}
         \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(} \PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RATE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{blue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{US 10 Years Treasury Rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(} \PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Home}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{green}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{New Home Supply}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{US 10 Years Treasury Rate vs. New Home Supply}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}matplotlib\textbackslash{}axes\textbackslash{}\_axes.py:6462: UserWarning: The 'normed' kwarg is deprecated, and has been replaced by the 'density' kwarg.
  warnings.warn("The 'normed' kwarg is deprecated, and has been "
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}matplotlib\textbackslash{}axes\textbackslash{}\_axes.py:6462: UserWarning: The 'normed' kwarg is deprecated, and has been replaced by the 'density' kwarg.
  warnings.warn("The 'normed' kwarg is deprecated, and has been "

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_118_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    
    \begin{verbatim}
<Figure size 1080x864 with 0 Axes>
    \end{verbatim}

    
    ''' Home Supply goes up, RATE goes up '''

The distribution plot comparing US 10 Years Treasury Rate \& New Home
Supply shows that US 10Y RATE is normally distributed and New Home
Supply is skewed to the right. Rate is the key component for the
government to keep rising housing price in check. Once rate goes up,
borrowers buying power will go down, that will keep housing price in
check.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}74}]:} \PY{n}{fit\PYZus{}data} \PY{o}{=} \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}purpose\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}} \PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{p}{,} \PY{n}{hue} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{diag\PYZus{}kind} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kde}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                      \PY{n}{plot\PYZus{}kws} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mf}{0.6}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{80}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{edgecolor}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
                      \PY{n}{size} \PY{o}{=} \PY{l+m+mi}{6}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Plot colored by continent for years 2000\PYZhy{}2007}
         \PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{p}{[}\PY{n}{fit\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CLTV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mi}{8}\PY{p}{]}\PY{p}{,}
                      \PY{n+nb}{vars} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LoanInMonth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                      \PY{n}{hue} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unit\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{diag\PYZus{}kind} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kde}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                      \PY{n}{plot\PYZus{}kws} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mf}{0.6}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{80}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{edgecolor}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
                      \PY{n}{size} \PY{o}{=} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{;}
         \PY{c+c1}{\PYZsh{} Title}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pair Plot of Mortgage Data for 2014\PYZhy{}2018 for CLTV over 80}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                      \PY{n}{size} \PY{o}{=} \PY{l+m+mi}{40}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}numpy\textbackslash{}core\textbackslash{}\_methods.py:135: RuntimeWarning: Degrees of freedom <= 0 for slice
  keepdims=keepdims)
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}numpy\textbackslash{}core\textbackslash{}\_methods.py:127: RuntimeWarning: invalid value encountered in double\_scalars
  ret = ret.dtype.type(ret / rcount)
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}statsmodels\textbackslash{}nonparametric\textbackslash{}kde.py:488: RuntimeWarning: invalid value encountered in true\_divide
  binned = fast\_linbin(X, a, b, gridsize) / (delta * nobs)
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}statsmodels\textbackslash{}nonparametric\textbackslash{}kdetools.py:34: RuntimeWarning: invalid value encountered in double\_scalars
  FAC1 = 2*(np.pi*bw/RANGE)**2

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_120_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_120_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}71}]:} \PY{c+c1}{\PYZsh{} Function to calculate correlation coefficient between two arrays}
         \PY{k}{def} \PY{n+nf}{corr}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)}\PY{p}{:}
         
             \PY{c+c1}{\PYZsh{} Calculate the value}
             \PY{n}{coef} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{corrcoef}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
             \PY{c+c1}{\PYZsh{} Make the label}
             \PY{n}{label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{rho\PYZdl{} = }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n}{coef}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} Add the label to the plot}
             \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}
             \PY{n}{ax}\PY{o}{.}\PY{n}{annotate}\PY{p}{(}\PY{n}{label}\PY{p}{,} \PY{n}{xy} \PY{o}{=} \PY{p}{(}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{)}\PY{p}{,} \PY{n}{size} \PY{o}{=} \PY{l+m+mi}{20}\PY{p}{,} \PY{n}{xycoords} \PY{o}{=} \PY{n}{ax}\PY{o}{.}\PY{n}{transAxes}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Create a pair grid instance}
         \PY{n}{grid} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{PairGrid}\PY{p}{(}\PY{n}{data}\PY{o}{=} \PY{n}{fit\PYZus{}data}\PY{p}{[}\PY{n}{fit\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CLTV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{l+m+mi}{8}\PY{p}{]}\PY{p}{,}
                             \PY{n+nb}{vars} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unit\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LoanInMonth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{size} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Map the plots to the locations}
         \PY{n}{grid} \PY{o}{=} \PY{n}{grid}\PY{o}{.}\PY{n}{map\PYZus{}upper}\PY{p}{(}\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{darkred}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{grid} \PY{o}{=} \PY{n}{grid}\PY{o}{.}\PY{n}{map\PYZus{}upper}\PY{p}{(}\PY{n}{corr}\PY{p}{)}
         \PY{n}{grid} \PY{o}{=} \PY{n}{grid}\PY{o}{.}\PY{n}{map\PYZus{}lower}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{kdeplot}\PY{p}{,} \PY{n}{cmap} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Reds}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{grid} \PY{o}{=} \PY{n}{grid}\PY{o}{.}\PY{n}{map\PYZus{}diag}\PY{p}{(}\PY{n}{plt}\PY{o}{.}\PY{n}{hist}\PY{p}{,} \PY{n}{bins} \PY{o}{=} \PY{l+m+mi}{10}\PY{p}{,} \PY{n}{edgecolor} \PY{o}{=}  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{darkred}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}matplotlib\textbackslash{}contour.py:960: UserWarning: The following kwargs were not used by contour: 'label', 'color'
  s)
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}matplotlib\textbackslash{}contour.py:960: UserWarning: The following kwargs were not used by contour: 'label', 'color'
  s)
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}matplotlib\textbackslash{}contour.py:960: UserWarning: The following kwargs were not used by contour: 'label', 'color'
  s)
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}matplotlib\textbackslash{}contour.py:960: UserWarning: The following kwargs were not used by contour: 'label', 'color'
  s)
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}matplotlib\textbackslash{}contour.py:960: UserWarning: The following kwargs were not used by contour: 'label', 'color'
  s)
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}matplotlib\textbackslash{}contour.py:960: UserWarning: The following kwargs were not used by contour: 'label', 'color'
  s)

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_121_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    Calculated correlation coefficient between two arrays:
data and vars=['Loan Amount', 'unit_type_code', 'loan_type_code', 'LoanInMonth']# 6.3 FEATURE SELECTION
Feature Selection is one of the core concepts in machine learning which hugely impacts the performance of your model. The data features that you use to train your machine learning models have a huge influence on the performance you can achieve.

How to select features and what are Benefits of performing feature selection before modeling your data?
Reduces Overfitting: Less redundant data means less opportunity to make decisions based on noise.
Improves Accuracy: Less misleading data means modeling accuracy improves.Reduces 
Training Time: fewer data points reduce algorithm complexity and algorithms train faster.

Feature Selection Methods:

I will share 3 Feature selection techniques that are easy to use and also gives good results.

•	Univariate Selection

•	Feature Importance

•	Correlation Matrix with Heatmap

    \section{6.3.1. Univariate Selection}\label{univariate-selection}

Statistical tests can be used to select those features that have the
strongest relationship with the output variable. The scikit-learn
library provides the SelectKBest class that can be used with a suite of
different statistical tests to select a specific number of features.

The example below uses the chi-squared (chi²) statistical test for
non-negative features to select 10 of the best features from the Mobile
Price Range Prediction Dataset.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}75}]:} \PY{n}{model\PYZus{}data}\PY{o}{=}\PY{n}{model\PYZus{}data3}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{int64}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}75}]:}            Loan Amount  city\_code  zip\_code  loan\_purpose\_code  \textbackslash{}
         1/1/2018      454800.0         80       330                  4   
         1/1/2018      960000.0         39       287                  0   
         1/10/2018     409500.0         66       286                  4   
         1/10/2018     472500.0         39       293                  4   
         1/11/2016     300000.0        613       351                  4   
         
                    Qualification FICO  unit\_type\_code  loan\_type\_code  Fix\_True  CLTV  \textbackslash{}
         1/1/2018                  777               7               0         0  60.0   
         1/1/2018                  680              10               0         1  60.0   
         1/10/2018                 702              10               1         1  70.0   
         1/10/2018                 645               7               1         1  63.0   
         1/11/2016                 788              10               1         1  50.0   
         
                    LoanInMonth  RATE  Home  
         1/1/2018            40  2.40   5.6  
         1/1/2018            40  2.40   5.6  
         1/10/2018           11  2.55   5.6  
         1/10/2018           12  2.55   5.6  
         1/11/2016           11  2.17   5.6  
\end{Verbatim}
            
    Making sure Target Variable (Qualification FICO) is integer. In order to
reduce the weight, we will be scalling.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}76}]:} \PY{c+c1}{\PYZsh{}Scalling data}
         \PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{l+m+mi}{100000}
         \PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{float64}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{l+m+mi}{100}
         \PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{float64}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zip\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zip\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{l+m+mi}{100}
         \PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zip\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zip\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{float64}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{l+m+mi}{100}
         \PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CLTV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CLTV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{l+m+mi}{10}
         \PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CLTV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CLTV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{float64}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LoanInMonth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LoanInMonth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{l+m+mi}{10}
         \PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LoanInMonth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LoanInMonth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{float64}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{float64}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}76}]:}            Loan Amount  city\_code  zip\_code  loan\_purpose\_code  \textbackslash{}
         1/1/2018         4.548       0.80      3.30                  4   
         1/1/2018         9.600       0.39      2.87                  0   
         1/10/2018        4.095       0.66      2.86                  4   
         1/10/2018        4.725       0.39      2.93                  4   
         1/11/2016        3.000       6.13      3.51                  4   
         
                    Qualification FICO  unit\_type\_code  loan\_type\_code  Fix\_True  CLTV  \textbackslash{}
         1/1/2018                 7.77               7               0         0   6.0   
         1/1/2018                 6.80              10               0         1   6.0   
         1/10/2018                7.02              10               1         1   7.0   
         1/10/2018                6.45               7               1         1   6.3   
         1/11/2016                7.88              10               1         1   5.0   
         
                    LoanInMonth  RATE  Home  
         1/1/2018           4.0  2.40   5.6  
         1/1/2018           4.0  2.40   5.6  
         1/10/2018          1.1  2.55   5.6  
         1/10/2018          1.2  2.55   5.6  
         1/11/2016          1.1  2.17   5.6  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}77}]:} \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}selection} \PY{k}{import} \PY{n}{SelectKBest}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}selection} \PY{k}{import} \PY{n}{chi2}
         
         \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}apply SelectKBest class to extract top 10 best features}
         \PY{n}{bestfeatures} \PY{o}{=} \PY{n}{SelectKBest}\PY{p}{(}\PY{n}{score\PYZus{}func}\PY{o}{=}\PY{n}{chi2}\PY{p}{,} \PY{n}{k}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{all}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{fit} \PY{o}{=} \PY{n}{bestfeatures}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{y}\PY{p}{)}
         
         \PY{n}{dfscores} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{fit}\PY{o}{.}\PY{n}{scores\PYZus{}}\PY{p}{)}
         \PY{n}{dfcolumns} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}concat two dataframes for better visualization}
         \PY{n}{featureScores} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{dfcolumns}\PY{p}{,}\PY{n}{dfscores}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{featureScores}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Specs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{}naming the dataframe columns}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{featureScores}\PY{o}{.}\PY{n}{nlargest}\PY{p}{(}\PY{l+m+mi}{11}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}  \PY{c+c1}{\PYZsh{}print 10 best features}
         
         \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
         \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         \PY{n}{sns}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{style}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{darkgrid}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{barplot}\PY{p}{(}\PY{n}{featureScores}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Specs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{featureScores}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Frequency Distribution of Features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Occurrences}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Specs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{45}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Index: 2501 entries, 1/1/2018 to 9/9/2016
Data columns (total 12 columns):
Loan Amount           2501 non-null float64
city\_code             2501 non-null float64
zip\_code              2501 non-null float64
loan\_purpose\_code     2501 non-null int64
Qualification FICO    2501 non-null float64
unit\_type\_code        2501 non-null int64
loan\_type\_code        2501 non-null int64
Fix\_True              2501 non-null uint8
CLTV                  2501 non-null float64
LoanInMonth           2501 non-null float64
RATE                  2501 non-null float64
Home                  2501 non-null float64
dtypes: float64(8), int64(3), uint8(1)
memory usage: 236.9+ KB
                 Specs      Score
0          Loan Amount  83.072449
1            city\_code  29.972507
3    loan\_purpose\_code  23.663874
7             Fix\_True   8.930081
2             zip\_code   5.529163
8                 CLTV   5.020901
9          LoanInMonth   4.579280
6       loan\_type\_code   3.235441
5       unit\_type\_code   1.079576
4   Qualification FICO   0.001570
10                RATE   0.001486

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_128_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{6.3.2. Feature Importance}\label{feature-importance}

The feature importance of each feature of our dataset by using the
feature importance property of the model. Feature importance gives us a
score for each feature of our data, the higher the score more important
or relevant is the feature towards your output variable. Feature
importance is an inbuilt class that comes with Tree Based Classifiers,
we will be using Extra Tree Classifier for extracting the top 10
features for the dataset.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}78}]:} \PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CLTV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CLTV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{int64}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
         
         \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CLTV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}X = np.array(model\PYZus{}data.drop([\PYZsq{}loan\PYZus{}purpose\PYZus{}code\PYZsq{}],1))}
         
         \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CLTV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}    \PY{c+c1}{\PYZsh{}target column}
         \PY{n}{Z} \PY{o}{=} \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}purpose\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)} \PY{c+c1}{\PYZsh{}Max Col = 10}
         
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{ExtraTreesClassifier}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         \PY{n}{model} \PY{o}{=} \PY{n}{ExtraTreesClassifier}\PY{p}{(}\PY{p}{)}
         \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{y}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{feature\PYZus{}importances\PYZus{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}use inbuilt class feature\PYZus{}importances of tree based classifiers}
         \PY{c+c1}{\PYZsh{}plot graph of feature importances for better visualization}
         \PY{n}{feat\PYZus{}importances} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{feature\PYZus{}importances\PYZus{}}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{Z}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
         \PY{n}{feat\PYZus{}importances}\PY{o}{.}\PY{n}{nlargest}\PY{p}{(}\PY{l+m+mi}{11}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{barh}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[0.12628179 0.11898728 0.11821426 0.03390029 0.1277225  0.05288519
 0.06363727 0.0144152  0.12811489 0.12625031 0.08959101]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_130_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{6.3.3. Correlation Matrix with
Heatmap}\label{correlation-matrix-with-heatmap}

Correlation states how the features are related to each other or the
target variable.

Correlation can be positive (increase in one value of feature increases
the value of the target variable) or negative (increase in one value of
feature decreases the value of the target variable)

Heatmap makes it easy to identify which features are most related to the
target variable, we will plot heatmap of correlated features using the
seaborn library.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}79}]:} \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
         \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
         \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CLTV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CLTV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}    \PY{c+c1}{\PYZsh{}target column}
         
         \PY{c+c1}{\PYZsh{}get correlations of each features in dataset}
         \PY{n}{corrmat} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
         \PY{n}{top\PYZus{}corr\PYZus{}features} \PY{o}{=} \PY{n}{corrmat}\PY{o}{.}\PY{n}{index}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plot heat map}
         \PY{n}{g}\PY{o}{=}\PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{n}{top\PYZus{}corr\PYZus{}features}\PY{p}{]}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RdYlGn}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{} Let\PYZsq{}s Drop Fretures that are not important \PYZsq{}\PYZsq{}\PYZsq{}}
         \PY{n}{fit\PYZus{}data} \PY{o}{=} \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}purpose\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}} \PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
         \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}    \PY{c+c1}{\PYZsh{}target column}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{5}\PY{p}{,}\PY{p}{]}\PY{p}{)}  \PY{c+c1}{\PYZsh{}print 1st 5 row of input}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Target variable is based on the five input rows above. }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Fix Mortgage = 1 \PYZam{} ARM (Adjustable Rate Mortgage) = 0 : }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{y}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{5}\PY{p}{,}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Index: 2501 entries, 1/1/2018 to 9/9/2016
Data columns (total 10 columns):
Loan Amount       2501 non-null float64
city\_code         2501 non-null float64
zip\_code          2501 non-null float64
unit\_type\_code    2501 non-null int64
loan\_type\_code    2501 non-null int64
Fix\_True          2501 non-null uint8
CLTV              2501 non-null int64
LoanInMonth       2501 non-null float64
RATE              2501 non-null float64
Home              2501 non-null float64
dtypes: float64(6), int64(3), uint8(1)
memory usage: 197.8+ KB
[[ 4.548  0.8    3.3    7.     0.     6.     4.     2.4    5.6  ]
 [ 9.6    0.39   2.87  10.     0.     6.     4.     2.4    5.6  ]
 [ 4.095  0.66   2.86  10.     1.     7.     1.1    2.55   5.6  ]
 [ 4.725  0.39   2.93   7.     1.     6.     1.2    2.55   5.6  ]
 [ 3.     6.13   3.51  10.     1.     5.     1.1    2.17   5.6  ]]
Target variable is based on the five input rows above. 
Fix Mortgage = 1 \& ARM (Adjustable Rate Mortgage) = 0 : 
 [0 1 1 1 1]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_132_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{6.4 PCA (Principal Component
Analysis)}\label{pca-principal-component-analysis}

PCA use PCA to de-correlate these measurements, then plot the
de-correlated points and measure their Pearson correlation. Compute
Pearson correlation coefficient between two arrays.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}80}]:} \PY{k}{def} \PY{n+nf}{pearson\PYZus{}r}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} Compute correlation matrix: corr\PYZus{}mat}
             \PY{n}{corr\PYZus{}mat} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{corrcoef}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} Return entry [0,1]}
             \PY{k}{return} \PY{n}{corr\PYZus{}mat}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} Import PCA}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{decomposition} \PY{k}{import} \PY{n}{PCA}
         \PY{c+c1}{\PYZsh{} Create PCA instance: model}
         \PY{n}{model} \PY{o}{=} \PY{n}{PCA}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} Apply the fit\PYZus{}transform method of model to grains: pca\PYZus{}features}
         \PY{n}{pca\PYZus{}features} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} Assign 0th column of pca\PYZus{}features: xs}
         \PY{n}{xs} \PY{o}{=} \PY{n}{pca\PYZus{}features}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{c+c1}{\PYZsh{} Assign 1st column of pca\PYZus{}features: ys}
         \PY{n}{ys} \PY{o}{=} \PY{n}{pca\PYZus{}features}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{xs}\PY{p}{,} \PY{n}{ys}\PY{p}{)} \PY{c+c1}{\PYZsh{} Scatter plot xs vs ys}
         \PY{n}{plt}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{equal}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_134_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{Variance of the PCA
features}\label{variance-of-the-pca-features}

The dataset is 10-dimensional. But what is its intrinsic dimension? Make
a plot of the variances of the PCA features to find out. As before,
samples is a 2D array, where each row represents a fish. You'll need to
standardize the features first. Tthe use of principal component analysis
for dimensionality reduction, for visualization of high-dimensional
data, for noise filtering, and for feature selection within
high-dimensional data. Because of the versatility and interpretability
of PCA, it has been shown to be effective in a wide variety of contexts
and disciplines. Given any high-dimensional dataset, I tend to start
with PCA in order to visualize the relationship between points ), to
understand the main variance in the data and to understand the intrinsic
dimensionality (by plotting the explained variance ratio).

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}81}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{decomposition} \PY{k}{import} \PY{n}{PCA}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{StandardScaler}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{pipeline} \PY{k}{import} \PY{n}{make\PYZus{}pipeline}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
         
         
         \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{o}{.}\PY{n}{shape}
         \PY{c+c1}{\PYZsh{} Create scaler: scaler}
         \PY{n}{scaler} \PY{o}{=} \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Create a PCA instance: pca}
         \PY{n}{pca} \PY{o}{=} \PY{n}{PCA}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Create pipeline: pipeline}
         \PY{n}{pipeline} \PY{o}{=} \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{scaler}\PY{p}{,} \PY{n}{pca}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Fit the pipeline to \PYZsq{}samples\PYZsq{}}
         \PY{n}{pipeline}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{p}{)}
         \PY{n}{pca}\PY{o}{.}\PY{n}{n\PYZus{}components\PYZus{}}
         
         \PY{c+c1}{\PYZsh{} Plot the explained variances}
         \PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zip\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}purpose\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unit\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CLTV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RATE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Home}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
         
         \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{ax}\PY{o}{.}\PY{n}{get\PYZus{}xticklabels}\PY{p}{(}\PY{n}{minor}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{:}
             \PY{n}{columns}\PY{o}{.}\PY{n}{set\PYZus{}rotation}\PY{p}{(}\PY{l+m+mi}{45}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{x}\PY{p}{)}
         
         \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{index}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{p}{[}\PY{n}{case} \PY{k}{for} \PY{n}{case} \PY{o+ow}{in} \PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{columns}\PY{p}{]}\PY{p}{,} \PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{30}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}81}]:} [Text(0,0,'Loan Amount'),
          Text(1,0,'city\_code'),
          Text(2,0,'zip\_code'),
          Text(3,0,'unit\_type\_code'),
          Text(4,0,'loan\_type\_code'),
          Text(5,0,'Fix\_True'),
          Text(6,0,'CLTV'),
          Text(7,0,'LoanInMonth'),
          Text(8,0,'RATE'),
          Text(0,0,'Home')]
\end{Verbatim}
            
    Now we want to know how many principal components we can choose for our
new feature subspace? A useful measure is the so-called ``explained
variance ratio``. The explained variance ratio tells us how much
information (variance) can be attributed to each of the principal
components. We can plot bar graph between no. of features on X axis and
variance ratio on Y axis

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}82}]:} \PY{n}{features} \PY{o}{=} \PY{n+nb}{range}\PY{p}{(}\PY{n}{pca}\PY{o}{.}\PY{n}{n\PYZus{}components\PYZus{}}\PY{p}{)}
         \PY{n}{feature\PYZus{}names} \PY{o}{=} \PY{n}{features} \PY{o}{=} \PY{n+nb}{range}\PY{p}{(}\PY{n}{pca}\PY{o}{.}\PY{n}{n\PYZus{}components\PYZus{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{pca}\PY{o}{.}\PY{n}{explained\PYZus{}variance\PYZus{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PCA feature}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{variance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{9}\PY{p}{]}\PY{p}{)}
         \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}
         \PY{n}{labels} \PY{o}{=} \PY{n}{ax}\PY{o}{.}\PY{n}{get\PYZus{}xticklabels}\PY{p}{(}\PY{p}{)}
         \PY{k}{for} \PY{n}{label} \PY{o+ow}{in} \PY{n}{labels}\PY{p}{:}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{label}\PY{p}{)}
         
         \PY{n}{pca}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{pca}\PY{o}{.}\PY{n}{mean\PYZus{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{pca}\PY{o}{.}\PY{n}{components\PYZus{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{pca}\PY{o}{.}\PY{n}{explained\PYZus{}variance\PYZus{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{pca}\PY{o}{.}\PY{n}{explained\PYZus{}variance\PYZus{}ratio\PYZus{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{pca}\PY{o}{.}\PY{n}{singular\PYZus{}values\PYZus{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{pca}\PY{o}{.}\PY{n}{n\PYZus{}components\PYZus{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{pca}\PY{o}{.}\PY{n}{noise\PYZus{}variance\PYZus{}}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_138_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Text(0,0,'')
Text(0,0,'')
Text(0,0,'')
Text(0,0,'')
Text(0,0,'')
Text(0,0,'')
Text(0,0,'')
Text(0,0,'')
[4.45099908 2.78884446 2.59613754 7.07676929 1.41143543 6.18192723
 2.66541383 2.27612555 5.84162335]
[[ 6.74631158e-01 -1.42558887e-01  9.47144178e-02  7.15100575e-01
  -6.06926841e-03 -5.83982496e-02 -2.36003998e-02  1.04425183e-02
   9.84355581e-03]
 [ 6.24676971e-01 -3.39271890e-02 -3.63329138e-02 -5.46747569e-01
  -2.79653254e-02  5.54415690e-01 -1.46261205e-02  8.51674717e-04
   1.08518038e-03]
 [ 3.57335110e-01 -6.33451485e-02 -2.18323287e-02 -4.18052138e-01
  -6.39237795e-02 -8.25592495e-01 -7.95718612e-02  2.91204431e-02
   1.36334785e-02]
 [ 1.41995704e-01  9.86633070e-01  2.51691455e-02  5.62644035e-02
  -2.18679814e-02 -4.32461578e-02  1.18712611e-02 -9.30813486e-03
  -4.15073885e-03]
 [ 4.89655127e-02 -2.23000695e-02  5.89480870e-02 -3.00364922e-02
  -3.27211458e-02 -5.76526444e-02  9.93626306e-01 -1.40120500e-02
  -2.90507042e-02]
 [ 3.70608522e-02  1.14319728e-02 -9.90040458e-01  9.93517298e-02
  -6.84259300e-02 -9.86495743e-03  5.66659554e-02 -1.30116095e-02
  -1.68870163e-02]
 [ 3.51813048e-02  1.62475088e-02 -6.29575543e-02 -2.41658456e-02
   7.86270830e-01 -2.69872226e-02  4.38808760e-02  4.33127762e-03
   6.10783295e-01]
 [ 4.11327008e-02  3.19275513e-03 -2.70133316e-02 -1.98134488e-02
   6.03185866e-01 -3.54983945e-02 -8.00519762e-03 -1.40336347e-01
  -7.82511288e-01]
 [-9.97850080e-03  1.28968245e-02 -1.58304568e-02  3.93352125e-03
   8.25158028e-02  1.81686176e-02  1.62052135e-02  9.89382078e-01
  -1.14845823e-01]]
[10.26745402  6.93543827  6.82999328  3.91074715  2.68754743  1.25011306
  0.94337535  0.65752734  0.1609216 ]
[0.30518735 0.20614731 0.20301309 0.11624212 0.07988402 0.03715806
 0.02804066 0.01954419 0.0047832 ]
[160.21434099 131.67610134 130.6712792   98.87804545  81.96870482
  55.9042275   48.5637557   40.54402963  20.05751701]
9
0.0

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_138_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    Features with high variance ratio
Text(0,0,'Loan Amount')     = 4.45
Text(3,0,'unit_type_code')  = 7.1
Text(5,0,'Fix_True')        = 4.2

Finding Correlation between Features and Target Variable in mortgage Dataset using Heatmap
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}85}]:} \PY{n}{correlation} \PY{o}{=} \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{correlation}\PY{p}{,} \PY{n}{vmax}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{square}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{viridis}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Correlation between Features and Target Variable in mortgage Dataset}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}85}]:} Text(0.5,1,'Correlation between Features and Target Variable in mortgage Dataset')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_140_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}86}]:} \PY{c+c1}{\PYZsh{}Let us load the basic packages needed for the PCA analysis}
         
         \PY{n}{pca} \PY{o}{=} \PY{n}{PCA}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{n}{pca}\PY{o}{.}\PY{n}{explained\PYZus{}variance\PYZus{}ratio\PYZus{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{number of components}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cumulative explained variance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_141_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    We can reduce to six to get the 100% accurary 
    \section{PCA as dimensionality
reduction}\label{pca-as-dimensionality-reduction}

Using PCA for dimensionality reduction involves zeroing out one or more
of the smallest principal components, resulting in a lower-dimensional
projection of the data that preserves the maximal data variance.

Here is an example of using PCA as a dimensionality reduction transform:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}87}]:} \PY{n}{pca} \PY{o}{=} \PY{n}{PCA}\PY{p}{(}\PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{6}\PY{p}{)}
         \PY{n}{pca}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{)}
         \PY{n}{X\PYZus{}pca} \PY{o}{=} \PY{n}{pca}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{original shape:   }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{X}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transformed shape:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{X\PYZus{}pca}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
original shape:    (2501, 9)
transformed shape: (2501, 6)

    \end{Verbatim}

    The transformed data has been reduced to a 6 dimension. To understand
the effect of this dimensionality reduction, we can perform the inverse
transform of this reduced data and plot it along with the original data:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}88}]:} \PY{n}{X\PYZus{}new} \PY{o}{=} \PY{n}{pca}\PY{o}{.}\PY{n}{inverse\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}pca}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{]}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.7}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{X\PYZus{}new}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{X\PYZus{}new}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{]}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{equal}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_146_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    
    \begin{verbatim}
<Figure size 1440x720 with 0 Axes>
    \end{verbatim}

    
    The light points are the original data, while the dark points are the
projected version. This makes clear what a PCA dimensionality reduction
means: the information along the least important principal axis or axes
is removed, leaving only the component(s) of the data with the highest
variance. The fraction of variance that is cut out (proportional to the
spread of points about the line formed in this figure) is roughly a
measure of how much "information" is discarded in this reduction of
dimensionality.

This reduced-dimension dataset is in some senses "good enough" to encode
the most important relationships between the points: despite reducing
the dimension of the data by 50\%, the overall relationship between the
data points are mostly preserved.

    \section{7 MODELING}\label{modeling}

In the Modeling stage we discuss the activities related to the model
building part of our project. A selection of five modeling techniques is
made that are applicable to our capstone project. From each of these
five modeling techniques, a model is built with the feature set provided
earlier, and the models are validated using repeated cross-validation.

7.1 SELECTION OF MODELING TECHNIQUES

For our modeling we use a combination of predictive techniques. Multiple
techniques are selected and applied on the data. For the non-linear
regression techniques, we use Support Vector Regression (SVR) and Neural
Networks (NN). SVR has shown to obtain excellent performances in
regression and time series applications. Neural Networks are a widely
used method for time series data that generally gives mixed results.

Another technique we use is Classification and Decession Trees, which is
a simple technique that is easy to visualize. Also two ensemble
techniques are included, in order to improve the performance of the
Classification and Regression Trees. These ensemble techniques are
Gradient Boosting Machines (GBM) and Random Forests (RF). These
techniques create a multitude of regression trees and select a
combination of them in order to maximize the performance.

7.2 MODEL BUILDING

Using these five techniques (ARIMA, Linear Regression, Logistic
Regression, SVM, SVR, Decision Tree, RF, and KNN) we can create five
models. We use the list of features mentioned in section 6.3 as input
for our models. A total of 12 features are included, the remaining
features were excluded after performing feature selection. For each of
the five models hyperparameters were tuned, using grid search.
Hyperparameters are the model-specific parameters that are used for
optimizing the model. They generally have to be tuned in order to
optimize the model's performance, and reduce the variance and bias of
the model. By training the model with different values of the size and
the decay, and evaluating its performance, we can select the
hyperparameters that result in the best performing model in terms of
predictive power.

    \section{ARMA Model}\label{arma-model}

Estimating an AR Model

We will estimate the AR(1) parameter, ϕ, of one of the Rate, Revenue,
Loan\_num, series that generated in the earlier . Since the parameters
are known for a series, it is a good way to understand the stimation
routines before applying it to real data. For monthly\_rate\_data with a
true ϕ of 0.9, we will print out the estimate of ϕ. In addition, we will
also print out the entire output that is produced when you fit a time
series, so we can get an idea of what other tests and summary statistics
are available in statsmodels.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}89}]:} \PY{n}{US10Y}\PY{o}{.}\PY{n}{index} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{US10Y}\PY{o}{.}\PY{n}{index}\PY{p}{)}
         
         \PY{n}{monthly\PYZus{}rate\PYZus{}data} \PY{o}{=} \PY{n}{US10Y}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RATE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{n}{rule}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{last}\PY{p}{(}\PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{} Import the ARMA module from statsmodels}
         \PY{k+kn}{from} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{tsa}\PY{n+nn}{.}\PY{n+nn}{arima\PYZus{}model} \PY{k}{import} \PY{n}{ARMA}
         
         \PY{c+c1}{\PYZsh{} Fit an AR(1) model to the first simulated data}
         \PY{n}{mod\PYZus{}rate} \PY{o}{=} \PY{n}{ARMA}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{asarray}\PY{p}{(}\PY{n}{monthly\PYZus{}rate\PYZus{}data}\PY{p}{)}\PY{p}{,} \PY{n}{order}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}
         \PY{n}{res\PYZus{}rate} \PY{o}{=} \PY{n}{mod\PYZus{}rate}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Print out summary information on the fit}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{res\PYZus{}rate}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Print out the estimate for the constant and for phi}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{When the true phi=0.9, the estimate of phi (and the constant) are:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{res\PYZus{}rate}\PY{o}{.}\PY{n}{params}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
                              ARMA Model Results                              
==============================================================================
Dep. Variable:                      y   No. Observations:                   51
Model:                     ARMA(1, 0)   Log Likelihood                  15.789
Method:                       css-mle   S.D. of innovations              0.175
Date:                Mon, 04 Feb 2019   AIC                            -25.579
Time:                        00:15:41   BIC                            -19.783
Sample:                             0   HQIC                           -23.364
                                                                              
==============================================================================
                 coef    std err          z      P>|z|      [0.025      0.975]
------------------------------------------------------------------------------
const          2.3612      0.224     10.558      0.000       1.923       2.800
ar.L1.y        0.9057      0.053     16.978      0.000       0.801       1.010
                                    Roots                                    
=============================================================================
                  Real          Imaginary           Modulus         Frequency
-----------------------------------------------------------------------------
AR.1            1.1041           +0.0000j            1.1041            0.0000
-----------------------------------------------------------------------------

When the true phi=0.9, the estimate of phi (and the constant) are:
[2.3611952  0.90574768]

    \end{Verbatim}

    Forecasting with an AR Model

In addition to estimating the parameters of a model, we can also do
forecasting using statsmodels. The in-sample is a forecast of the next
data point using the data up to that point, and the out-of-sample
forecasts any number of data points in the future. These forecasts can
be made using either the predict() method if we want the forecasts in
the form of a series of data, or using the plot\_predict() method we you
want a plot of the forecasted data. We will supply the starting point
for forecasting and the ending point, which can be any number of data
points after the data set ends. For the simulated series Monthly
Interest Rate with ϕ=0.9, we will plot in-sample and out-of-sample
forecasts.

Being able to forecast interest rates is of enormous importance, not
only for bond investors but also for individuals like new homeowners who
must decide between fixed and floating rate mortgages.

There is some mean reversion in interest rates over long horizons. In
other words, when interest rates are high, they tend to drop and when
they are low, they tend to rise over time. Currently they are below
long-term rates, so they are expected to rise, but an AR model attempts
to quantify how much they are expected to rise.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}90}]:} \PY{k+kn}{from} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{tsa}\PY{n+nn}{.}\PY{n+nn}{arima\PYZus{}model} \PY{k}{import} \PY{n}{ARMA}
         
         \PY{c+c1}{\PYZsh{} Forecast interest rates using an AR(1) model}
         \PY{n}{mod\PYZus{}monthly\PYZus{}rate\PYZus{}data} \PY{o}{=} \PY{n}{ARMA}\PY{p}{(}\PY{n}{monthly\PYZus{}rate\PYZus{}data}\PY{p}{,} \PY{n}{order}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}
         \PY{n}{res} \PY{o}{=} \PY{n}{mod\PYZus{}monthly\PYZus{}rate\PYZus{}data}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Plot the original series and the forecasted series}
         \PY{n}{res}\PY{o}{.}\PY{n}{plot\PYZus{}predict}\PY{p}{(}\PY{n}{start}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2020}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{8}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_152_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Since we have only used only FOUR years of Monthly Interest Rate Data,
we can see the short term downward momentum on the interest rate

    A daily move up or down in interest rates is unlikely to tell us
anything about interest rates tomorrow, but a move in interest rates
over a year can tell us something about where interest rates are going
over the next year. The DataFrame daily\_data contains daily data of
10-year interest rates from 1962 to 2017

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}91}]:} \PY{n}{daily\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{c:/scripts/DGS10.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index\PYZus{}col}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DATE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Data Cleaning}
         \PY{n}{daily\PYZus{}data}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{99999}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         
         \PY{n}{daily\PYZus{}data}\PY{o}{=} \PY{n}{daily\PYZus{}data}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{n}{to\PYZus{}replace}\PY{o}{=}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{99999}\PY{p}{]}\PY{p}{,} \PY{n}{value}\PY{o}{=}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{daily\PYZus{}data} \PY{o}{=} \PY{n}{daily\PYZus{}data}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{daily\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DGS10}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=} \PY{n}{daily\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DGS10}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{float64}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{daily\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{change\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{daily\PYZus{}data}\PY{o}{.}\PY{n}{diff}\PY{p}{(}\PY{p}{)}
         \PY{n}{daily\PYZus{}data} \PY{o}{=} \PY{n}{daily\PYZus{}data}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Convert index to datetime}
         \PY{n}{daily\PYZus{}data}\PY{o}{.}\PY{n}{index} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{daily\PYZus{}data}\PY{o}{.}\PY{n}{index}\PY{p}{)}
         
         \PY{n}{annual\PYZus{}data} \PY{o}{=} \PY{n}{daily\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DGS10}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{n}{rule}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{A}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{last}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{type}\PY{p}{(}\PY{n}{annual\PYZus{}data}\PY{p}{)}
         \PY{n}{annual\PYZus{}data} \PY{o}{=} \PY{n}{annual\PYZus{}data}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} Repeat above for annual data}
         \PY{n}{annual\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diff\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{annual\PYZus{}data}\PY{o}{.}\PY{n}{diff}\PY{p}{(}\PY{p}{)}
         \PY{n}{annual\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diff\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{annual\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diff\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{annual\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diff\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}annual\PYZus{}data= annual\PYZus{}data.astype(\PYZsq{}float64\PYZsq{})}
         
         \PY{c+c1}{\PYZsh{} Compute and print the autocorrelation of daily changes}
         \PY{n}{autocorrelation\PYZus{}daily} \PY{o}{=} \PY{n}{daily\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{change\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{autocorr}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The autocorrelation of daily interest rate changes is }\PY{l+s+si}{\PYZpc{}4.2f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{autocorrelation\PYZus{}daily}\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Compute and print the autocorrelation of annual changes}
         \PY{n}{autocorrelation\PYZus{}annual} \PY{o}{=} \PY{n}{annual\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diff\PYZus{}rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{autocorr}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The autocorrelation of annual interest rate changes is }\PY{l+s+si}{\PYZpc{}4.2f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{autocorrelation\PYZus{}annual}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
DATE
1963-12-31    0.29
1964-12-31    0.07
1965-12-31    0.44
1966-12-31   -0.01
1967-12-31    1.06
1968-12-31    0.46
1969-12-31    1.72
1970-12-31   -1.38
1971-12-31   -0.61
1972-12-31    0.52
1973-12-31    0.49
1974-12-31    0.50
1975-12-31    0.36
1976-12-31   -0.95
1977-12-31    0.97
1978-12-31    1.37
1979-12-31    1.18
1980-12-31    2.10
1981-12-31    1.55
1982-12-31   -3.62
1983-12-31    1.46
1984-12-31   -0.27
1985-12-31   -2.55
1986-12-31   -1.77
1987-12-31    1.60
1988-12-31    0.31
1989-12-31   -1.21
1990-12-31    0.15
1991-12-31   -1.37
1992-12-31   -0.01
1993-12-31   -0.87
1994-12-31    2.01
1995-12-31   -2.26
1996-12-31    0.85
1997-12-31   -0.68
1998-12-31   -1.10
1999-12-31    1.80
2000-12-31   -1.33
2001-12-31   -0.05
2002-12-31   -1.24
2003-12-31    0.44
2004-12-31   -0.03
2005-12-31    0.15
2006-12-31    0.32
2007-12-31   -0.67
2008-12-31   -1.79
2009-12-31    1.60
2010-12-31   -0.55
2011-12-31   -1.41
2012-12-31   -0.11
2013-12-31    1.26
2014-12-31   -0.87
2015-12-31    0.10
2016-12-31    0.18
2017-12-31   -0.05
2018-12-31    0.29
2019-12-31    0.06
Freq: A-DEC, Name: DGS10, dtype: float64
The autocorrelation of daily interest rate changes is 0.07
The autocorrelation of annual interest rate changes is -0.22

    \end{Verbatim}

    Notice how the daily autocorrelation is small (0.07) but the annual
autocorrelation is large and negative (-0.22)

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}92}]:} \PY{n}{annual\PYZus{}rate}\PY{o}{=}\PY{n}{daily\PYZus{}data}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{A}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}type(annual\PYZus{}rate)}
         \PY{n}{annual\PYZus{}rate\PYZus{}data}\PY{o}{=}\PY{n}{annual\PYZus{}rate}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DGS10}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} Import the ARMA module from statsmodels}
         \PY{k+kn}{from} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{tsa}\PY{n+nn}{.}\PY{n+nn}{arima\PYZus{}model} \PY{k}{import} \PY{n}{ARMA}
         
         \PY{c+c1}{\PYZsh{} Forecast interest rates using an AR(1) model}
         \PY{n}{mod\PYZus{}annual\PYZus{}rate} \PY{o}{=} \PY{n}{ARMA}\PY{p}{(}\PY{n}{annual\PYZus{}rate\PYZus{}data}\PY{p}{,} \PY{n}{order}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}
         \PY{n}{res\PYZus{}annual\PYZus{}rate} \PY{o}{=} \PY{n}{mod\PYZus{}annual\PYZus{}rate}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Plot the original series and the forecasted series}
         \PY{n}{res\PYZus{}annual\PYZus{}rate}\PY{o}{.}\PY{n}{plot\PYZus{}predict}\PY{p}{(}\PY{n}{start}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2024}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{8}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_157_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Over long horizons, when interest rates go up, the economy tends to slow
down, which consequently causes interest rates to fall, and vice versa.

According to an AR(1) model, 10-year interest rates are forecasted to
rise from 2.16\%, towards the end of 2017 to 3.35\% in five years

    \section{Forecast expected monthly closed
loans}\label{forecast-expected-monthly-closed-loans}

Our Mortgage DataSet contains data from Oct 2014 to December 2018. Let's
forecast Monthly Closed Loans and Monthly Revenue. We will forecast
monthly\_loan\_num\_data using an AR(1) model

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}93}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} Import the ARMA module from statsmodels}
         \PY{k+kn}{from} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{tsa}\PY{n+nn}{.}\PY{n+nn}{arima\PYZus{}model} \PY{k}{import} \PY{n}{ARMA}
         \PY{n}{monthly\PYZus{}loan\PYZus{}num}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{last}\PY{p}{(}\PY{p}{)}
         \PY{n}{monthly\PYZus{}loan\PYZus{}num\PYZus{}data}\PY{o}{=} \PY{n}{monthly\PYZus{}loan\PYZus{}num}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{last}\PY{p}{(}\PY{p}{)}
         \PY{n}{monthly\PYZus{}loan\PYZus{}num\PYZus{}data}\PY{o}{=}\PY{n}{monthly\PYZus{}loan\PYZus{}num\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LoanInMonth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{c+c1}{\PYZsh{} Forecast monthly\PYZus{}loan\PYZus{}num\PYZus{}data using an AR(1) model}
         \PY{n}{mod\PYZus{}monthly\PYZus{}loan\PYZus{}num\PYZus{}data} \PY{o}{=} \PY{n}{ARMA}\PY{p}{(}\PY{n}{monthly\PYZus{}loan\PYZus{}num\PYZus{}data}\PY{p}{,} \PY{n}{order}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}
         \PY{n}{res\PYZus{}monthly\PYZus{}loan\PYZus{}num\PYZus{}data} \PY{o}{=} \PY{n}{mod\PYZus{}monthly\PYZus{}loan\PYZus{}num\PYZus{}data}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Plot the original series and the forecasted series}
         \PY{n}{res\PYZus{}monthly\PYZus{}loan\PYZus{}num\PYZus{}data}\PY{o}{.}\PY{n}{plot\PYZus{}predict}\PY{p}{(}\PY{n}{start}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2020}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Monthly Loan Application Forecast}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_160_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    '''Above we have plotted the original series and the forecasted series.
With 95\% confidence interval, Expected Loans per month will be around
50. Low end is 28 \& High End is 70'''

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}94}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} Import the ARMA module from statsmodels}
         \PY{k+kn}{from} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{tsa}\PY{n+nn}{.}\PY{n+nn}{arima\PYZus{}model} \PY{k}{import} \PY{n}{ARMA}
         \PY{n}{monthly\PYZus{}loan\PYZus{}num}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Q}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{last}\PY{p}{(}\PY{p}{)}
         \PY{n}{Q\PYZus{}loan\PYZus{}num\PYZus{}data}\PY{o}{=} \PY{n}{monthly\PYZus{}loan\PYZus{}num}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Q}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{last}\PY{p}{(}\PY{p}{)}
         \PY{n}{Q\PYZus{}loan\PYZus{}num\PYZus{}data}\PY{o}{=}\PY{n}{Q\PYZus{}loan\PYZus{}num\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LoanInMonth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{c+c1}{\PYZsh{} Forecast quaterly\PYZus{}loan\PYZus{}num\PYZus{}data using an AR(1) model}
         \PY{n}{mod\PYZus{}Q\PYZus{}loan\PYZus{}num\PYZus{}data} \PY{o}{=} \PY{n}{ARMA}\PY{p}{(}\PY{n}{Q\PYZus{}loan\PYZus{}num\PYZus{}data}\PY{p}{,} \PY{n}{order}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}
         \PY{n}{res\PYZus{}mod\PYZus{}Q\PYZus{}loan\PYZus{}num\PYZus{}data} \PY{o}{=} \PY{n}{mod\PYZus{}Q\PYZus{}loan\PYZus{}num\PYZus{}data}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Plot the original series and the forecasted series}
         \PY{n}{res\PYZus{}mod\PYZus{}Q\PYZus{}loan\PYZus{}num\PYZus{}data}\PY{o}{.}\PY{n}{plot\PYZus{}predict}\PY{p}{(}\PY{n}{start}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2020}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{14}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Quaterly Loan Application Forecast}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_162_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    ''Above we have plotted the original series and the forecasted series.
With 95\% confidence interval, Expected Loans per month will be around
47. Low end is 20 \& High End is 75'''

    \section{Forecast expected monthly
revenue}\label{forecast-expected-monthly-revenue}

Similarly, we may forecast expected monthly revenue and plot original
series and the forecasted series

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}95}]:} \PY{n}{mod\PYZus{}monthly\PYZus{}loan\PYZus{}rev\PYZus{}data} \PY{o}{=} \PY{n}{ARMA}\PY{p}{(}\PY{n}{monthly\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{p}{,} \PY{n}{order}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{res\PYZus{}monthly\PYZus{}loan\PYZus{}rev\PYZus{}data} \PY{o}{=} \PY{n}{mod\PYZus{}monthly\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The AIC for an AR(1) is: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{res\PYZus{}monthly\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{o}{.}\PY{n}{aic}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} Plot the original series and the forecasted series}
         \PY{n}{res\PYZus{}monthly\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{o}{.}\PY{n}{plot\PYZus{}predict}\PY{p}{(}\PY{n}{start}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2020}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Monthly Sales Revenue Forecast}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
The AIC for an AR(1) is:  1715.9386048157016

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_165_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    With 95\% confidence interval, Expected Revenue per month will be around
22M. Low end is 13M \& High End is 32M

    \section{Forecasting Quarterly Sales
Revenue}\label{forecasting-quarterly-sales-revenue}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}96}]:} \PY{n}{loan\PYZus{}patterns}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DatetimeIndex}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Created Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{loan\PYZus{}patterns} \PY{o}{=} \PY{n}{loan\PYZus{}patterns}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{loan\PYZus{}patterns}\PY{o}{.}\PY{n}{index}
         
         \PY{n}{quarterly\PYZus{}revenue\PYZus{}data} \PY{o}{=} \PY{n}{loan\PYZus{}patterns}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{n}{rule}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Q}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{mod\PYZus{}quarterly\PYZus{}loan\PYZus{}rev\PYZus{}data} \PY{o}{=} \PY{n}{ARMA}\PY{p}{(}\PY{n}{quarterly\PYZus{}revenue\PYZus{}data}\PY{p}{,} \PY{n}{order}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{res\PYZus{}quarterly\PYZus{}loan\PYZus{}rev\PYZus{}data} \PY{o}{=} \PY{n}{mod\PYZus{}quarterly\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Plot the original series and the forecasted series}
         \PY{n}{res\PYZus{}quarterly\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{o}{.}\PY{n}{plot\PYZus{}predict}\PY{p}{(}\PY{n}{start}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2020}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Quarterly Sales Revenue Forecast}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_168_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    '''With 95\% confidence interval, Expected Revenue per Quarters will be
around 67M. Low end is 52M \& High End is 80M'''

    \section{Forecasting Annual Sales
Revenue}\label{forecasting-annual-sales-revenue}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}97}]:} \PY{n}{annual\PYZus{}revenue\PYZus{}data} \PY{o}{=} \PY{n}{loan\PYZus{}patterns}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{n}{rule}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{A}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{mod\PYZus{}annual\PYZus{}loan\PYZus{}rev\PYZus{}data} \PY{o}{=} \PY{n}{ARMA}\PY{p}{(}\PY{n}{annual\PYZus{}revenue\PYZus{}data}\PY{p}{,} \PY{n}{order}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{res\PYZus{}annual\PYZus{}loan\PYZus{}rev\PYZus{}data} \PY{o}{=} \PY{n}{mod\PYZus{}annual\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Plot the original series and the forecasted series}
         \PY{n}{res\PYZus{}annual\PYZus{}loan\PYZus{}rev\PYZus{}data}\PY{o}{.}\PY{n}{plot\PYZus{}predict}\PY{p}{(}\PY{n}{start}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2021}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{14}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Annual Sales Revenue Forecast}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_171_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    In the above graph, we have plotted the original series and the
forecasted series. We are expecting little drop in annual mortgage
revene. Our current annual revenue is \$270M. By end of 2021, with 95\%
confidence interval, Expected Revenue per Years will be around 220M. Low
end is 70M \& High End is 360M. With more annual data, we should be able
to do better annual revenue prediction.

    \section{Linear regression}\label{linear-regression}

Purpose of linear regression: Given a dataset containing predictor
variables X and outcome/response variable Y, linear regression can be
used to:

Build a predictive model to predict future values, using new data X
where Y is unknown. Model the strength of the relationship between each
independent variable X\_i and Y Many times, only a subset of independent
variables X\_i will have a linear relationship with Y Need to figure out
which X\_i contributes most information to predict Y It is in many
cases, the first pass prediction algorithm for continuous outcomes.

Linear Regression is a method to model the relationship between a set of
independent variables X (also knowns as explanatory variables, features,
predictors) and a dependent variable Y. This method assumes the
relationship between each predictor X is linearly related to the
dependent variable Y.

Independence means that the residuals are not correlated -\/- the
residual from one prediction has no effect on the residual from another
prediction. Correlated errors are common in time series analysis and
spatial analyses.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}98}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split} \PY{c+c1}{\PYZsh{} for train and test set split}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{cross\PYZus{}val\PYZus{}score} \PY{c+c1}{\PYZsh{}Sklearn.model\PYZus{}seletion is used instead of sklearn.cross\PYZus{}validation to avoid}
         \PY{c+c1}{\PYZsh{}warning}
         
         \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{size of the training feature set is}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{size of the test feature set is}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{X\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{size of the training Target set is}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{size of the test Target set is}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{}Linear regression}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LinearRegression} \PY{c+c1}{\PYZsh{}import from sklearn}
         \PY{n}{linear\PYZus{}reg}\PY{o}{=} \PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{} instantiated linreg}
         \PY{n}{linear\PYZus{}reg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)} \PY{c+c1}{\PYZsh{}fit the model}
         
         \PY{c+c1}{\PYZsh{}predict using X\PYZus{}test}
         \PY{n}{predicted\PYZus{}train}\PY{o}{=} \PY{n}{linear\PYZus{}reg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{)}
         \PY{n}{predicted\PYZus{}test}\PY{o}{=} \PY{n}{linear\PYZus{}reg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
         
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{mean\PYZus{}squared\PYZus{}error} \PY{c+c1}{\PYZsh{} import mse from sklearn}
         \PY{c+c1}{\PYZsh{}calculate root mean squarred error}
         \PY{n}{rmse\PYZus{}train}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{predicted\PYZus{}train}\PY{p}{)}\PY{p}{)}
         \PY{n}{rmse\PYZus{}test}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{predicted\PYZus{}test}\PY{p}{)}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The train root mean squarred error is :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{rmse\PYZus{}train}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The test root mean squarred error is :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{rmse\PYZus{}test}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The Linear Regression coefficient parameters are :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{linear\PYZus{}reg}\PY{o}{.}\PY{n}{coef\PYZus{}} \PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The Linear Regression intercept value is :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{linear\PYZus{}reg}\PY{o}{.}\PY{n}{intercept\PYZus{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
size of the training feature set is (2000, 11)
size of the test feature set is (501, 11)
size of the training Target set is (2000,)
size of the test Target set is (501,)
The train root mean squarred error is : 2.345908703691074
The test root mean squarred error is : 3.963200847042714
The Linear Regression coefficient parameters are : [-0.11919389  0.20419526 -0.08932699  0.17949017  0.16819986 -0.3501712
 -0.68726163  0.04346237 -0.07163668  0.56560897  0.16290692]
The Linear Regression intercept value is : 0.7734251420145459

    \end{Verbatim}

    RMSE of the test data is closer to the training RMSE (and lower) if you
have a well trained model. It will be higher if we have an overfitted
model.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}99}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics} \PY{c+c1}{\PYZsh{} import metrics from sklearn}
         
         \PY{n}{Rsquared}\PY{o}{=}\PY{n}{linear\PYZus{}reg}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)} \PY{c+c1}{\PYZsh{} to determine r square Goodness of fit}
         
         \PY{c+c1}{\PYZsh{} how good the model fits the training data can be determined by R squared metric which is here 0.12}
         \PY{n}{Rsquared}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The R squared metric is :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{Rsquared}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
The R squared metric is : 0.12086787994354309

    \end{Verbatim}

    Out R\^{}2 = 0.12

The R\^{}2 in scikit learn is the coefficient of determination. It is 1
- residual sum of square / total sum of squares.

Since R\^{}2 = 1 - RSS/TSS, the only case where RSS/TSS \textgreater{} 1
happens when our model is even worse than the worst model assumed (which
is the absolute mean model).

here RSS = sum of squares of difference between actual values(yi) and
predicted values(yi\^{}) and TSS = sum of squares of difference between
actual values (yi) and mean value (Before applying Regression). So you
can imagine TSS representing the best(actual) model, and RSS being in
between our best model and the worst absolute mean model in which case
we'll get RSS/TSS \textless{} 1. If our model is even worse than the
worst mean model then in that case RSS \textgreater{} TSS(Since
difference between actual observation and mean value \textless{}
difference predicted value and actual observation).

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}100}]:} \PY{c+c1}{\PYZsh{} K fold cross validation}
          \PY{c+c1}{\PYZsh{} cross validation score}
          \PY{n}{cv\PYZus{}score}\PY{o}{=} \PY{n}{cross\PYZus{}val\PYZus{}score}\PY{p}{(}\PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{X}\PY{p}{,}\PY{n}{y}\PY{p}{,}\PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}squared\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)} \PY{c+c1}{\PYZsh{} k =10}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cv\PYZus{}score is :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{cv\PYZus{}score}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} mean squared error}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cv\PYZus{}score is :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{cv\PYZus{}score}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Root mean squared error}
          \PY{n}{rmse\PYZus{}cv}\PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{cv\PYZus{}score}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)} \PY{o}{*} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The cross validation root mean squarred error is :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{rmse\PYZus{}cv}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
cv\_score is : [-10.41761244  -2.87528686  -6.71334008  -6.83023816  -4.73823121
  -3.93130492 -11.82537791  -7.04069096  -3.51224496 -18.03312884]
cv\_score is : -7.591745633330166
The cross validation root mean squarred error is : 2.755312256955673

    \end{Verbatim}

    With Linear regressor we are able to predict the model with RMSE: The
train RMSE = 2.349923482270037 The test RMSE = 3.9655849638809144

R squared 0.12 and cross validation root mean squarred error is : 2.75

    \section{Fitting Linear Regression using
statsmodels}\label{fitting-linear-regression-using-statsmodels}

Statsmodels is a great Python library for a lot of basic and inferential
statistics. It also provides basic regression functions using an R-like
syntax, so it's commonly used by statisticians. The version of
least-squares we will use in statsmodels is called ordinary
least-squares (OLS). There are many other versions of least-squares such
as partial least squares (PLS) and weighted least squares (WLS).

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}101}]:} \PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{sm}
          \PY{k+kn}{from} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{formula}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{import} \PY{n}{ols}
          
          \PY{c+c1}{\PYZsh{} statsmodels works nicely with pandas dataframes}
          \PY{c+c1}{\PYZsh{} The thing inside the \PYZdq{}quotes\PYZdq{} is called a formula, a bit on that below}
          \PY{n}{m\PYZus{}rate} \PY{o}{=} \PY{n}{ols}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y \PYZti{} RATE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{model\PYZus{}data}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{m\PYZus{}rate}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{m\PYZus{}home} \PY{o}{=} \PY{n}{ols}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y \PYZti{} Home}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{model\PYZus{}data}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{m\PYZus{}home}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{m\PYZus{}cltv} \PY{o}{=} \PY{n}{ols}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y \PYZti{} CLTV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{model\PYZus{}data}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{m\PYZus{}cltv}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{m\PYZus{}zip} \PY{o}{=} \PY{n}{ols}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y \PYZti{} zip\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{model\PYZus{}data}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{m\PYZus{}zip}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{m\PYZus{}Fix\PYZus{}True} \PY{o}{=} \PY{n}{ols}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y \PYZti{} Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{model\PYZus{}data}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{m\PYZus{}Fix\PYZus{}True}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{m\PYZus{}loaninmonths} \PY{o}{=} \PY{n}{ols}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y \PYZti{} LoanInMonth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{model\PYZus{}data}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{m\PYZus{}loaninmonths}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{m\PYZus{}rcpi} \PY{o}{=} \PY{n}{ols}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y \PYZti{} LoanInMonth + RATE + Home + CLTV }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{model\PYZus{}data}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{m\PYZus{}rcpi}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{fdval} \PY{o}{=} \PY{n}{m\PYZus{}rcpi}\PY{o}{.}\PY{n}{fittedvalues}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{fdval}\PY{p}{,} \PY{n}{y}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}plt.xlim(3,8)}
          \PY{c+c1}{\PYZsh{}plt.ylim(0,1)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted prices}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Original Prices}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
          
          \PY{n}{sns}\PY{o}{.}\PY{n}{regplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{fdval}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Loan Amount}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{model\PYZus{}data}\PY{p}{,} \PY{n}{fit\PYZus{}reg} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                      y   R-squared:                       0.012
Model:                            OLS   Adj. R-squared:                  0.012
Method:                 Least Squares   F-statistic:                     30.62
Date:                Mon, 04 Feb 2019   Prob (F-statistic):           3.47e-08
Time:                        00:16:39   Log-Likelihood:                -6185.5
No. Observations:                2501   AIC:                         1.238e+04
Df Residuals:                    2499   BIC:                         1.239e+04
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P>|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      2.7391      0.315      8.705      0.000       2.122       3.356
RATE           0.7521      0.136      5.533      0.000       0.486       1.019
==============================================================================
Omnibus:                     3095.324   Durbin-Watson:                   1.910
Prob(Omnibus):                  0.000   Jarque-Bera (JB):           828231.544
Skew:                           6.326   Prob(JB):                         0.00
Kurtosis:                      91.248   Cond. No.                         15.0
==============================================================================

Warnings:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                      y   R-squared:                       0.002
Model:                            OLS   Adj. R-squared:                  0.001
Method:                 Least Squares   F-statistic:                     3.826
Date:                Mon, 04 Feb 2019   Prob (F-statistic):             0.0506
Time:                        00:16:39   Log-Likelihood:                -6198.9
No. Observations:                2501   AIC:                         1.240e+04
Df Residuals:                    2499   BIC:                         1.241e+04
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P>|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      3.6952      0.391      9.458      0.000       2.929       4.461
Home           0.1294      0.066      1.956      0.051      -0.000       0.259
==============================================================================
Omnibus:                     3082.104   Durbin-Watson:                   1.900
Prob(Omnibus):                  0.000   Jarque-Bera (JB):           799024.436
Skew:                           6.287   Prob(JB):                         0.00
Kurtosis:                      89.657   Cond. No.                         41.1
==============================================================================

Warnings:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                      y   R-squared:                       0.000
Model:                            OLS   Adj. R-squared:                 -0.000
Method:                 Least Squares   F-statistic:                    0.1159
Date:                Mon, 04 Feb 2019   Prob (F-statistic):              0.734
Time:                        00:16:39   Log-Likelihood:                -6200.7
No. Observations:                2501   AIC:                         1.241e+04
Df Residuals:                    2499   BIC:                         1.242e+04
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P>|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      4.4975      0.148     30.334      0.000       4.207       4.788
CLTV          -0.0075      0.022     -0.340      0.734      -0.051       0.036
==============================================================================
Omnibus:                     3075.668   Durbin-Watson:                   1.898
Prob(Omnibus):                  0.000   Jarque-Bera (JB):           789392.170
Skew:                           6.266   Prob(JB):                         0.00
Kurtosis:                      89.128   Cond. No.                         17.6
==============================================================================

Warnings:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                      y   R-squared:                       0.016
Model:                            OLS   Adj. R-squared:                  0.015
Method:                 Least Squares   F-statistic:                     39.59
Date:                Mon, 04 Feb 2019   Prob (F-statistic):           3.68e-10
Time:                        00:16:39   Log-Likelihood:                -6181.1
No. Observations:                2501   AIC:                         1.237e+04
Df Residuals:                    2499   BIC:                         1.238e+04
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P>|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      3.6439      0.140     25.937      0.000       3.368       3.919
zip\_code       0.3109      0.049      6.292      0.000       0.214       0.408
==============================================================================
Omnibus:                     3107.849   Durbin-Watson:                   1.907
Prob(Omnibus):                  0.000   Jarque-Bera (JB):           833920.186
Skew:                           6.375   Prob(JB):                         0.00
Kurtosis:                      91.543   Cond. No.                         7.70
==============================================================================

Warnings:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                      y   R-squared:                       0.018
Model:                            OLS   Adj. R-squared:                  0.017
Method:                 Least Squares   F-statistic:                     45.11
Date:                Mon, 04 Feb 2019   Prob (F-statistic):           2.29e-11
Time:                        00:16:39   Log-Likelihood:                -6178.4
No. Observations:                2501   AIC:                         1.236e+04
Df Residuals:                    2499   BIC:                         1.237e+04
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P>|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      5.5823      0.178     31.380      0.000       5.233       5.931
Fix\_True      -1.2620      0.188     -6.717      0.000      -1.630      -0.894
==============================================================================
Omnibus:                     3102.498   Durbin-Watson:                   1.909
Prob(Omnibus):                  0.000   Jarque-Bera (JB):           846052.644
Skew:                           6.346   Prob(JB):                         0.00
Kurtosis:                      92.206   Cond. No.                         6.06
==============================================================================

Warnings:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                      y   R-squared:                       0.003
Model:                            OLS   Adj. R-squared:                  0.003
Method:                 Least Squares   F-statistic:                     8.688
Date:                Mon, 04 Feb 2019   Prob (F-statistic):            0.00323
Time:                        00:16:39   Log-Likelihood:                -6196.4
No. Observations:                2501   AIC:                         1.240e+04
Df Residuals:                    2499   BIC:                         1.241e+04
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
===============================================================================
                  coef    std err          t      P>|t|      [0.025      0.975]
-------------------------------------------------------------------------------
Intercept       4.7262      0.110     43.067      0.000       4.511       4.941
LoanInMonth    -0.1033      0.035     -2.948      0.003      -0.172      -0.035
==============================================================================
Omnibus:                     3062.707   Durbin-Watson:                   1.899
Prob(Omnibus):                  0.000   Jarque-Bera (JB):           774414.837
Skew:                           6.221   Prob(JB):                         0.00
Kurtosis:                      88.303   Cond. No.                         6.41
==============================================================================

Warnings:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                      y   R-squared:                       0.015
Model:                            OLS   Adj. R-squared:                  0.014
Method:                 Least Squares   F-statistic:                     9.611
Date:                Mon, 04 Feb 2019   Prob (F-statistic):           1.04e-07
Time:                        00:16:39   Log-Likelihood:                -6181.7
No. Observations:                2501   AIC:                         1.237e+04
Df Residuals:                    2496   BIC:                         1.240e+04
Df Model:                           4                                         
Covariance Type:            nonrobust                                         
===============================================================================
                  coef    std err          t      P>|t|      [0.025      0.975]
-------------------------------------------------------------------------------
Intercept       2.5995      0.510      5.096      0.000       1.599       3.600
LoanInMonth    -0.0888      0.035     -2.538      0.011      -0.157      -0.020
RATE            0.7139      0.139      5.122      0.000       0.441       0.987
Home            0.0658      0.067      0.986      0.324      -0.065       0.197
CLTV            0.0128      0.022      0.577      0.564      -0.031       0.056
==============================================================================
Omnibus:                     3086.155   Durbin-Watson:                   1.912
Prob(Omnibus):                  0.000   Jarque-Bera (JB):           817090.439
Skew:                           6.294   Prob(JB):                         0.00
Kurtosis:                      90.650   Cond. No.                         85.3
==============================================================================

Warnings:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_181_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_181_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    RATE R\^{}2 = 0.12 (Same as before) Home R\^{}2 = 0.12 (Same as before)
CLTV R\^{}2 = 0.00 (Same as before)

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}102}]:} \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}102}]:}            Loan Amount  city\_code  zip\_code  loan\_purpose\_code  \textbackslash{}
          1/1/2018         4.548       0.80      3.30                  4   
          1/1/2018         9.600       0.39      2.87                  0   
          1/10/2018        4.095       0.66      2.86                  4   
          1/10/2018        4.725       0.39      2.93                  4   
          1/11/2016        3.000       6.13      3.51                  4   
          
                     Qualification FICO  unit\_type\_code  loan\_type\_code  Fix\_True  CLTV  \textbackslash{}
          1/1/2018                 7.77               7               0         0     6   
          1/1/2018                 6.80              10               0         1     6   
          1/10/2018                7.02              10               1         1     7   
          1/10/2018                6.45               7               1         1     6   
          1/11/2016                7.88              10               1         1     5   
          
                     LoanInMonth  RATE  Home  
          1/1/2018           4.0  2.40   5.6  
          1/1/2018           4.0  2.40   5.6  
          1/10/2018          1.1  2.55   5.6  
          1/10/2018          1.2  2.55   5.6  
          1/11/2016          1.1  2.17   5.6  
\end{Verbatim}
            
    \section{Fitting Linear Regression using
sklearn}\label{fitting-linear-regression-using-sklearn}

Look inside lm object using dir(lm):

lm.predit() lm.fit()

lm.score() lm.coef\_ lm.intercept\_

Fit a linear model: The lm.fit() function estimates the coefficients the
linear regression using least squares.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}103}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LinearRegression}
          
          \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
          \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} This creates a LinearRegression object}
          \PY{n}{lm} \PY{o}{=} \PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Use all 13 predictors to fit linear regression model}
          \PY{n}{lm}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{)}
          \PY{n}{lm}\PY{o}{.}\PY{n}{coef\PYZus{}}
          
          \PY{n}{lm}\PY{o}{.}\PY{n}{intercept\PYZus{}}
          
          \PY{c+c1}{\PYZsh{} The mean squared error}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Mean squared error (Fix\PYZus{}True Rate): }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{(}\PY{n}{lm}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{y}\PY{p}{)} \PY{o}{*}\PY{o}{*} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
          \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{lm}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{)}
          \PY{n}{lm}\PY{o}{.}\PY{n}{coef\PYZus{}}
          
          \PY{n}{lm}\PY{o}{.}\PY{n}{intercept\PYZus{}}
          
          \PY{c+c1}{\PYZsh{} The mean squared error}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Mean squared error (loan\PYZus{}type\PYZus{}code): }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{(}\PY{n}{lm}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{y}\PY{p}{)} \PY{o}{*}\PY{o}{*} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
          \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{lm}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{)}
          \PY{n}{lm}\PY{o}{.}\PY{n}{coef\PYZus{}}
          
          \PY{n}{lm}\PY{o}{.}\PY{n}{intercept\PYZus{}}
          
          \PY{c+c1}{\PYZsh{} The mean squared error}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Mean squared error (Loan Amount): }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{(}\PY{n}{lm}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{y}\PY{p}{)} \PY{o}{*}\PY{o}{*} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unit\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
          \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unit\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{lm}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{)}
          \PY{n}{lm}\PY{o}{.}\PY{n}{coef\PYZus{}}
          
          \PY{n}{lm}\PY{o}{.}\PY{n}{intercept\PYZus{}}
          
          \PY{c+c1}{\PYZsh{} The mean squared error}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Mean squared error (unit\PYZus{}type\PYZus{}code): }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{(}\PY{n}{lm}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{y}\PY{p}{)} \PY{o}{*}\PY{o}{*} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Mean squared error (Fix\_True Rate): 0.09
Mean squared error (loan\_type\_code): 0.80
Mean squared error (Loan Amount): 7.55
Mean squared error (unit\_type\_code): 7.76

    \end{Verbatim}

    \section{Let's try Regression: with
Scale}\label{lets-try-regression-with-scale}

Here is the different types of regression we have used with
StandardScaler and GridSearchCV:

LinearRegression

Lasso

Ridge

ElasticNet

SGDRegressor

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}104}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
          \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
          \PY{k+kn}{from} \PY{n+nn}{pandas} \PY{k}{import} \PY{n}{DataFrame}\PY{p}{,}\PY{n}{Series}
          \PY{k+kn}{import} \PY{n+nn}{matplotlib}
          \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
          \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LinearRegression}\PY{p}{,} \PY{n}{Lasso}\PY{p}{,} \PY{n}{Ridge}\PY{p}{,} \PY{n}{ElasticNet}\PY{p}{,} \PY{n}{SGDRegressor}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{StandardScaler}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{grid\PYZus{}search} \PY{k}{import} \PY{n}{GridSearchCV}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cross\PYZus{}validation} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
          \PY{c+c1}{\PYZsh{}from sklearn.model\PYZus{}selection import train\PYZus{}test\PYZus{}split}
          
          
          \PY{k}{def} \PY{n+nf}{pretty\PYZus{}print\PYZus{}linear}\PY{p}{(}\PY{n}{coefs}\PY{p}{,} \PY{n}{names} \PY{o}{=} \PY{k+kc}{None}\PY{p}{,} \PY{n}{sort} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}\PY{p}{:}
              \PY{k}{if} \PY{n}{names} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
                  \PY{n}{names} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{X}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{x} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{coefs}\PY{p}{)}\PY{p}{)}\PY{p}{]}
              \PY{n}{lst} \PY{o}{=} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{coefs}\PY{p}{,} \PY{n}{names}\PY{p}{)}
              \PY{k}{if} \PY{n}{sort}\PY{p}{:}
                  \PY{n}{lst} \PY{o}{=} \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{lst}\PY{p}{,} \PY{n}{key} \PY{o}{=} \PY{k}{lambda} \PY{n}{x}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
              \PY{k}{return} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ + }\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ * }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n}{coef}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,} \PY{n}{name}\PY{p}{)} \PY{k}{for} \PY{n}{coef}\PY{p}{,} \PY{n}{name} \PY{o+ow}{in} \PY{n}{lst}\PY{p}{)}
          
          \PY{k}{def} \PY{n+nf}{scale\PYZus{}data}\PY{p}{(}\PY{n}{X}\PY{p}{)}\PY{p}{:}
              \PY{n}{scaler} \PY{o}{=} \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}
              \PY{n}{X} \PY{o}{=} \PY{n}{scaler}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X}\PY{p}{)}
              \PY{k}{return} \PY{n}{X}
          
          \PY{k}{def} \PY{n+nf}{split\PYZus{}data}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{)}\PY{p}{:}
              \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{Y\PYZus{}train}\PY{p}{,} \PY{n}{Y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{Y}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.20}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
              \PY{k}{return} \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{Y\PYZus{}train}\PY{p}{,} \PY{n}{Y\PYZus{}test}
          
          
          \PY{k}{def} \PY{n+nf}{root\PYZus{}mean\PYZus{}square\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{:}
              \PY{n}{rmse\PYZus{}train} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n+nb}{abs}\PY{p}{(}\PY{n}{y\PYZus{}pred}\PY{o}{\PYZhy{}}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}\PY{n+nb}{abs}\PY{p}{(}\PY{n}{y\PYZus{}pred}\PY{o}{\PYZhy{}}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n+nb}{len}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
              \PY{k}{return} \PY{n}{rmse\PYZus{}train}
          
          
          
          \PY{k}{def} \PY{n+nf}{plot\PYZus{}real\PYZus{}vs\PYZus{}predicted}\PY{p}{(}\PY{n}{y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{:}
              \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{real}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{real\PYZus{}vs\PYZus{}predicted           .@achowdhu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
              \PY{k}{return} \PY{n}{plt}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}sklearn\textbackslash{}cross\_validation.py:41: DeprecationWarning: This module was deprecated in version 0.18 in favor of the model\_selection module into which all the refactored classes and functions are moved. Also note that the interface of the new CV iterators are different from that of this module. This module will be removed in 0.20.
  "This module will be removed in 0.20.", DeprecationWarning)
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}sklearn\textbackslash{}grid\_search.py:42: DeprecationWarning: This module was deprecated in version 0.18 in favor of the model\_selection module into which all the refactored classes and functions are moved. This module will be removed in 0.20.
  DeprecationWarning)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}105}]:} \PY{n}{np}\PY{o}{.}\PY{n}{set\PYZus{}printoptions}\PY{p}{(}\PY{n}{precision}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{suppress}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{edgeitems}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}print(\PYZsq{}sample input data\PYZsq{}, X[10:15]) \PYZsh{} Input variable}
          \PY{c+c1}{\PYZsh{}print(\PYZsq{}sample output data\PYZsq{}, y[10:15] \PYZsh{} Target Variable}
          
          \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
          \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          
          \PY{n}{X} \PY{o}{=} \PY{n}{scale\PYZus{}data}\PY{p}{(}\PY{n}{X}\PY{p}{)}  \PY{c+c1}{\PYZsh{}Scalling Input Data}
          
          \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{split\PYZus{}data}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{y}\PY{p}{)}
\end{Verbatim}


    \section{Let's try Regular Linear
Regression:}\label{lets-try-regular-linear-regression}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}106}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Create linear regression object}
          \PY{n}{linreg} \PY{o}{=} \PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Train the model using the training sets}
          \PY{n}{linreg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Linear model: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{pretty\PYZus{}print\PYZus{}linear}\PY{p}{(}\PY{n}{linreg}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{,} \PY{n}{sort} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Predict the values using the model}
          \PY{n}{y\PYZus{}lin\PYZus{}predict} \PY{o}{=} \PY{n}{linreg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Print the root mean square error}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Linear Regression \PYZhy{} Root Mean Square Error: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{root\PYZus{}mean\PYZus{}square\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}lin\PYZus{}predict}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
          \PY{n}{plot\PYZus{}real\PYZus{}vs\PYZus{}predicted}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,}\PY{n}{y\PYZus{}lin\PYZus{}predict}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
           Loan Amount  city\_code  zip\_code  unit\_type\_code  loan\_type\_code  \textbackslash{}
1/1/2018         4.548       0.80      3.30               7               0   
1/1/2018         9.600       0.39      2.87              10               0   
1/10/2018        4.095       0.66      2.86              10               1   
1/10/2018        4.725       0.39      2.93               7               1   
1/11/2016        3.000       6.13      3.51              10               1   

           Fix\_True  CLTV  LoanInMonth  RATE  Home  
1/1/2018          0     6          4.0  2.40   5.6  
1/1/2018          1     6          4.0  2.40   5.6  
1/10/2018         1     7          1.1  2.55   5.6  
1/10/2018         1     6          1.2  2.55   5.6  
1/11/2016         1     5          1.1  2.17   5.6  
Linear model:  -0.034 * X7 + -0.034 * X0 + 0.025 * X1 + -0.015 * X2 + 0.01 * X6 + 0.009 * X8 + 0.008 * X5 + 0.002 * X3 + 0.0 * X4
Linear Regression - Root Mean Square Error:  0.2982900796002123

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_190_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}106}]:} <module 'matplotlib.pyplot' from 'C:\textbackslash{}\textbackslash{}Users\textbackslash{}\textbackslash{}achow\textbackslash{}\textbackslash{}Anaconda3\textbackslash{}\textbackslash{}lib\textbackslash{}\textbackslash{}site-packages\textbackslash{}\textbackslash{}matplotlib\textbackslash{}\textbackslash{}pyplot.py'>
\end{Verbatim}
            
    \section{Let's try Lasso Regression:}\label{lets-try-lasso-regression}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}107}]:} \PY{c+c1}{\PYZsh{} Create lasso regression object}
          \PY{n}{lasso} \PY{o}{=} \PY{n}{Lasso}\PY{p}{(}\PY{n}{alpha}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{3}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Train the model using the training sets}
          \PY{n}{lasso}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Lasso model: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{pretty\PYZus{}print\PYZus{}linear}\PY{p}{(}\PY{n}{lasso}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{,} \PY{n}{sort} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Predict the values using the model}
          \PY{n}{y\PYZus{}lasso\PYZus{}predict} \PY{o}{=} \PY{n}{lasso}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Print the root mean square error}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Lasso model \PYZhy{} Root Mean Square Error: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{root\PYZus{}mean\PYZus{}square\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}lasso\PYZus{}predict}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
          \PY{n}{plot\PYZus{}real\PYZus{}vs\PYZus{}predicted}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,}\PY{n}{y\PYZus{}lasso\PYZus{}predict}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Lasso model:  -0.0 * X0 + 0.0 * X1 + -0.0 * X2 + -0.0 * X3 + 0.0 * X4 + 0.0 * X5 + 0.0 * X6 + -0.0 * X7 + 0.0 * X8
Lasso model - Root Mean Square Error:  0.3075792710571243

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_192_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}107}]:} <module 'matplotlib.pyplot' from 'C:\textbackslash{}\textbackslash{}Users\textbackslash{}\textbackslash{}achow\textbackslash{}\textbackslash{}Anaconda3\textbackslash{}\textbackslash{}lib\textbackslash{}\textbackslash{}site-packages\textbackslash{}\textbackslash{}matplotlib\textbackslash{}\textbackslash{}pyplot.py'>
\end{Verbatim}
            
    \section{Let's try Ridge Regression:}\label{lets-try-ridge-regression}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}108}]:} \PY{n}{ridge} \PY{o}{=} \PY{n}{Ridge}\PY{p}{(}\PY{n}{fit\PYZus{}intercept}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{3}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Train the model using the training sets}
          \PY{n}{ridge}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Ridge model: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{pretty\PYZus{}print\PYZus{}linear}\PY{p}{(}\PY{n}{ridge}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{,} \PY{n}{sort} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Predict the values using the model}
          \PY{n}{y\PYZus{}ridge\PYZus{}predict} \PY{o}{=} \PY{n}{ridge}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Print the root mean square error}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Ridge Regression \PYZhy{} Root Mean Square Error: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{root\PYZus{}mean\PYZus{}square\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}ridge\PYZus{}predict}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
          \PY{n}{plot\PYZus{}real\PYZus{}vs\PYZus{}predicted}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,}\PY{n}{y\PYZus{}ridge\PYZus{}predict}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Ridge model:  -0.034 * X7 + -0.034 * X0 + 0.025 * X1 + -0.015 * X2 + 0.01 * X6 + 0.009 * X8 + 0.008 * X5 + 0.002 * X3 + 0.0 * X4
Ridge Regression - Root Mean Square Error:  0.29829010039988163

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_194_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}108}]:} <module 'matplotlib.pyplot' from 'C:\textbackslash{}\textbackslash{}Users\textbackslash{}\textbackslash{}achow\textbackslash{}\textbackslash{}Anaconda3\textbackslash{}\textbackslash{}lib\textbackslash{}\textbackslash{}site-packages\textbackslash{}\textbackslash{}matplotlib\textbackslash{}\textbackslash{}pyplot.py'>
\end{Verbatim}
            
    \section{Now let's try to do regression via Elastic
Net.}\label{now-lets-try-to-do-regression-via-elastic-net.}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}109}]:} \PY{n}{elnet} \PY{o}{=} \PY{n}{ElasticNet}\PY{p}{(}\PY{n}{fit\PYZus{}intercept}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{3}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Train the model using the training sets}
          \PY{n}{elnet}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Elastic Net model: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{pretty\PYZus{}print\PYZus{}linear}\PY{p}{(}\PY{n}{elnet}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{,} \PY{n}{sort} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Predict the values using the model}
          \PY{n}{y\PYZus{}elnet\PYZus{}predict} \PY{o}{=} \PY{n}{elnet}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Print the root mean square error}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Elastic Net \PYZhy{} Root Mean Square Error: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{root\PYZus{}mean\PYZus{}square\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}elnet\PYZus{}predict}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
          \PY{n}{plot\PYZus{}real\PYZus{}vs\PYZus{}predicted}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,}\PY{n}{y\PYZus{}elnet\PYZus{}predict}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Elastic Net model:  -0.0 * X0 + 0.0 * X1 + -0.0 * X2 + -0.0 * X3 + 0.0 * X4 + 0.0 * X5 + 0.0 * X6 + -0.0 * X7 + 0.0 * X8
Elastic Net - Root Mean Square Error:  0.3075792710571243

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_196_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}109}]:} <module 'matplotlib.pyplot' from 'C:\textbackslash{}\textbackslash{}Users\textbackslash{}\textbackslash{}achow\textbackslash{}\textbackslash{}Anaconda3\textbackslash{}\textbackslash{}lib\textbackslash{}\textbackslash{}site-packages\textbackslash{}\textbackslash{}matplotlib\textbackslash{}\textbackslash{}pyplot.py'>
\end{Verbatim}
            
    \section{Now let's try to do regression via Stochastic Gradient
Descent.}\label{now-lets-try-to-do-regression-via-stochastic-gradient-descent.}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}110}]:} \PY{n}{sgdreg} \PY{o}{=} \PY{n}{SGDRegressor}\PY{p}{(}\PY{n}{penalty}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.15}\PY{p}{,} \PY{n}{n\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Train the model using the training sets}
          \PY{n}{sgdreg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Stochastic Gradient Descent model: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{pretty\PYZus{}print\PYZus{}linear}\PY{p}{(}\PY{n}{sgdreg}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{,} \PY{n}{sort} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Predict the values using the model}
          \PY{n}{y\PYZus{}sgdreg\PYZus{}predict} \PY{o}{=} \PY{n}{sgdreg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Print the root mean square error}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Stochastic Gradient Descent \PYZhy{} Root Mean Square Error: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{root\PYZus{}mean\PYZus{}square\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}sgdreg\PYZus{}predict}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
          \PY{n}{plot\PYZus{}real\PYZus{}vs\PYZus{}predicted}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,}\PY{n}{y\PYZus{}sgdreg\PYZus{}predict}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Stochastic Gradient Descent model:  -0.028 * X7 + -0.027 * X0 + 0.021 * X1 + -0.013 * X2 + 0.008 * X8 + 0.008 * X6 + 0.007 * X5 + 0.002 * X4 + -0.001 * X3
Stochastic Gradient Descent - Root Mean Square Error:  0.29880597293830624

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}sklearn\textbackslash{}linear\_model\textbackslash{}stochastic\_gradient.py:117: DeprecationWarning: n\_iter parameter is deprecated in 0.19 and will be removed in 0.21. Use max\_iter and tol instead.
  DeprecationWarning)

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_198_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}110}]:} <module 'matplotlib.pyplot' from 'C:\textbackslash{}\textbackslash{}Users\textbackslash{}\textbackslash{}achow\textbackslash{}\textbackslash{}Anaconda3\textbackslash{}\textbackslash{}lib\textbackslash{}\textbackslash{}site-packages\textbackslash{}\textbackslash{}matplotlib\textbackslash{}\textbackslash{}pyplot.py'>
\end{Verbatim}
            
    \section{Regression Summary Report}\label{regression-summary-report}

Linear Regression - Root Mean Square Error : 0.298

Lasso model - Root Mean Square Error : 0.308

Ridge Regression - Root Mean Square Error : 0.298

Elastic Net - Root Mean Square Error : 0.308

Stochastic Gradient Descent - Root Mean Square Error : 0.298

Linear Regression, Ridge Regression, Stochastic Gradient Descent all
have - Root Mean Square Error: 0.298 are performing best with low Root
Mean Square Error

    \subsection{}\label{section}

Now we have a pandas DataFrame called model\_data containing all the
data we want to use to predict Mortgage Loan prices. Let's create a
variable called 'Loan Amount' which will contain the prices.

This information is contained in the target data.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}111}]:} \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}111}]:}            Loan Amount  city\_code  zip\_code  loan\_purpose\_code  \textbackslash{}
          1/1/2018         4.548       0.80      3.30                  4   
          1/1/2018         9.600       0.39      2.87                  0   
          1/10/2018        4.095       0.66      2.86                  4   
          1/10/2018        4.725       0.39      2.93                  4   
          1/11/2016        3.000       6.13      3.51                  4   
          
                     Qualification FICO  unit\_type\_code  loan\_type\_code  Fix\_True  CLTV  \textbackslash{}
          1/1/2018                 7.77               7               0         0     6   
          1/1/2018                 6.80              10               0         1     6   
          1/10/2018                7.02              10               1         1     7   
          1/10/2018                6.45               7               1         1     6   
          1/11/2016                7.88              10               1         1     5   
          
                     LoanInMonth  RATE  Home  
          1/1/2018           4.0  2.40   5.6  
          1/1/2018           4.0  2.40   5.6  
          1/10/2018          1.1  2.55   5.6  
          1/10/2018          1.2  2.55   5.6  
          1/11/2016          1.1  2.17   5.6  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}112}]:} \PY{n}{model\PYZus{}data}\PY{o}{=}\PY{n}{model\PYZus{}data3}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
          \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}112}]:}            Loan Amount  city\_code  zip\_code  loan\_purpose\_code  \textbackslash{}
          1/1/2018      454800.0         80       330                  4   
          1/1/2018      960000.0         39       287                  0   
          1/10/2018     409500.0         66       286                  4   
          1/10/2018     472500.0         39       293                  4   
          1/11/2016     300000.0        613       351                  4   
          
                     Qualification FICO  unit\_type\_code  loan\_type\_code  Fix\_True  CLTV  \textbackslash{}
          1/1/2018                  777               7               0         0  60.0   
          1/1/2018                  680              10               0         1  60.0   
          1/10/2018                 702              10               1         1  70.0   
          1/10/2018                 645               7               1         1  63.0   
          1/11/2016                 788              10               1         1  50.0   
          
                     LoanInMonth  RATE  Home  
          1/1/2018            40  2.40   5.6  
          1/1/2018            40  2.40   5.6  
          1/10/2018           11  2.55   5.6  
          1/10/2018           12  2.55   5.6  
          1/11/2016           11  2.17   5.6  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}113}]:} \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{columns}
          \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
          \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
          
          \PY{n}{g1}\PY{o}{=}\PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{p}{,} \PY{n}{x\PYZus{}vars}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RATE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Home}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{y\PYZus{}vars}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{,} \PY{n}{aspect}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{,} \PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{g1}\PY{o}{.}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{l+m+mi}{300000}\PY{p}{,}\PY{l+m+mi}{600000}\PY{p}{)}
          \PY{n}{g1}\PY{o}{.}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{l+m+mf}{1.5}\PY{p}{,}\PY{l+m+mf}{3.5}\PY{p}{)}
          \PY{n}{g1}\PY{o}{.}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{l+m+mf}{4.5}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_203_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{US 10-Years Interest Rate goes up loan amount
increases}\label{us-10-years-interest-rate-goes-up-loan-amount-increases}

Home Supply increases, loan amount also increases slightly but
eventually housing market will slow down

Interest Rate Chage has bigger impact on Loan Amount compare to Home
Supply

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}114}]:} \PY{n}{g}\PY{o}{=}\PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{p}{,} \PY{n}{x\PYZus{}vars}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CLTV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{y\PYZus{}vars}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{,} \PY{n}{aspect}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{,} \PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{g}\PY{o}{.}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{l+m+mi}{400000}\PY{p}{,}\PY{l+m+mi}{500000}\PY{p}{)}
          \PY{n}{g}\PY{o}{.}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{l+m+mi}{600}\PY{p}{,} \PY{l+m+mi}{820}\PY{p}{)}
          \PY{n}{g}\PY{o}{.}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_205_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Majority of the FICO scores between 600 and 820

Majority of the CLTV scores between 30\% and 100\%

\subsection{FICO goes up, Loan Amount goes
up}\label{fico-goes-up-loan-amount-goes-up}

\subsection{CLTV goes up, Loan Amount Goes
down}\label{cltv-goes-up-loan-amount-goes-down}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}115}]:} \PY{n}{g2}\PY{o}{=}\PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{p}{,} \PY{n}{x\PYZus{}vars}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unit\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RATE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{y\PYZus{}vars}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{,} \PY{n}{aspect}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{,} \PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{g2}\PY{o}{.}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{l+m+mi}{300000}\PY{p}{,}\PY{l+m+mi}{600000}\PY{p}{)}
          \PY{n}{g2}\PY{o}{.}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{12.1}\PY{p}{)}
          \PY{n}{g2}\PY{o}{.}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}
          \PY{n}{g2}\PY{o}{.}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{l+m+mf}{1.5}\PY{p}{,}\PY{l+m+mf}{3.5}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unit Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}  \PY{p}{,}\PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unit\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data\PYZus{}lc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_207_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
OneFamily      1276
TwoFamily       707
Condo           216
ThreeFamily     129
Coop             76
FourFamily       36
MixedUse         25
MultiFamily      20
Warehouse         8
PUD               6
Land              1
Industrial        1
Name: Unit Type, dtype: int64 
  7     1276
10     707
0      216
9      129
1       76
2       36
5       25
6       20
11       8
8        6
3        1
4        1
Name: unit\_type\_code, dtype: int64
Conventional    1736
FHA              418
Residential      215
Commercial       100
Other             31
VA                 1
Name: Loan Type, dtype: int64 
  1    1736
2     418
4     215
0     100
3      31
5       1
Name: loan\_type\_code, dtype: int64

    \end{Verbatim}

    As number of unit decreases ave Loan Amount also decreases

loan\_type\_code: Conventional is high volume but Slightly low average
loan amount

ARM (Adjustable Rate Mortgage) has higher loan amount thn Fix\_True Rate
mortgage Two Family (Code = 10) has higher Loan Amount that three Family
(Code = 9)

Conventional Mortgage has Higher Loan Amount FHA ARM has higher Loan
Amount compare to Fix Rate Mortgage

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}116}]:} \PY{n}{g3}\PY{o}{=}\PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{p}{,} \PY{n}{x\PYZus{}vars}\PY{o}{=}\PY{p}{[} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CLTV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Home}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LoanInMonth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{y\PYZus{}vars}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{,} \PY{n}{aspect}\PY{o}{=}\PY{l+m+mf}{1.2}\PY{p}{,} \PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{g3}\PY{o}{.}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{l+m+mi}{300000}\PY{p}{,}\PY{l+m+mi}{600000}\PY{p}{)}
          \PY{n}{g3}\PY{o}{.}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{)}
          \PY{n}{g2}\PY{o}{.}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{l+m+mf}{4.5}\PY{p}{,}\PY{l+m+mf}{7.5}\PY{p}{)}
          \PY{n}{g3}\PY{o}{.}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{80}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_209_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    NYC NJ (zip\_code between 7 \& 11) seems to be closing more loans and
generation more revenues for the Mortgage Bank. As number of loans per
month inceases, loan amount decrease

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}117}]:} \PY{n}{g4}\PY{o}{=}\PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{p}{,} \PY{n}{x\PYZus{}vars}\PY{o}{=}\PY{p}{[} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zip\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unit\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{y\PYZus{}vars}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{,} \PY{n}{aspect}\PY{o}{=}\PY{l+m+mf}{1.2}\PY{p}{,} \PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{g4}\PY{o}{.}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{l+m+mi}{300000}\PY{p}{,}\PY{l+m+mi}{600000}\PY{p}{)}
          \PY{n}{g4}\PY{o}{.}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{l+m+mi}{6}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{)}
          \PY{n}{g4}\PY{o}{.}\PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_211_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    NYC NJ (zip\_code 1st digit starting with 7 \& 11) seems to be closing
more loans and generation more revenues for the Mortgage Bank. City
shows similar results. Population density plays bigger role on Loan
Amount. As number of loans per month increases, loan amount decreases

    \section{Logistic Regression}\label{logistic-regression}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}118}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LogisticRegression}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{multiclass} \PY{k}{import} \PY{n}{OneVsRestClassifier}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cross\PYZus{}validation} \PY{k}{import} \PY{n}{cross\PYZus{}val\PYZus{}score}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cross\PYZus{}validation} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
          \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{preprocessing}\PY{p}{,} \PY{n}{cross\PYZus{}validation}\PY{p}{,} \PY{n}{neighbors}
          
          \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
          \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}knn} \PY{o}{=} \PY{n}{cross\PYZus{}validation}\PY{o}{.}\PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size} \PY{o}{=} \PY{l+m+mf}{0.2}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Create the DataFrame: numeric\PYZus{}data\PYZus{}only}
          \PY{n}{numeric\PYZus{}data\PYZus{}only} \PY{o}{=} \PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1000}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} Create training and test sets}
          \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.20}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{21}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Instantiate the classifier: clf}
          \PY{n}{clf} \PY{o}{=} \PY{n}{OneVsRestClassifier}\PY{p}{(}\PY{n}{LogisticRegression}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Fit the classifier to the training data}
          \PY{n}{clf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Print the accuracy}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Logistic Regression Accuracy: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{clf}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Logistic Regression Accuracy: 0.6866267465069861

    \end{Verbatim}

    Logistic Regression Model Accuracy for Loan Types: 69\%

    \section{Now Centering, Scaling and Logistic Regression and look at the
model
accuracy}\label{now-centering-scaling-and-logistic-regression-and-look-at-the-model-accuracy}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}119}]:} \PY{c+c1}{\PYZsh{} Import necessary packages}
          \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
          \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
          \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
          \PY{n}{plt}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{use}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ggplot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{datasets}
          \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{linear\PYZus{}model}
          \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
          
          \PY{c+c1}{\PYZsh{} Load data}
          \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
          \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{X}\PY{o}{.}\PY{n}{shape}
          \PY{n}{y}\PY{o}{.}\PY{n}{shape}
          \PY{c+c1}{\PYZsh{} Split the data into test and training sets}
          \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Train logistic regression model and print performance on the test set}
          \PY{n}{lr} \PY{o}{=} \PY{n}{linear\PYZus{}model}\PY{o}{.}\PY{n}{LogisticRegression}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} fit the model}
          \PY{n}{lr} \PY{o}{=} \PY{n}{lr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Logistic Regression score for training set: }\PY{l+s+si}{\PYZpc{}f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{lr}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}\PY{p}{)}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{classification\PYZus{}report}
          \PY{n}{y\PYZus{}true}\PY{p}{,} \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{lr}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{y\PYZus{}true}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Logistic Regression score for training set: 0.705000
             precision    recall  f1-score   support

          0       0.33      0.10      0.15        20
          1       0.68      0.99      0.80       339
          2       0.50      0.01      0.02        96
          3       0.00      0.00      0.00         5
          4       0.00      0.00      0.00        41

avg / total       0.57      0.67      0.55       501


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}sklearn\textbackslash{}metrics\textbackslash{}classification.py:1135: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn\_for)

    \end{Verbatim}

    Out of the box, this logistic regression performs little better (70\%
model accuracy with or without scaling). Lets now scale our data and
perform logistic regression:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}120}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{scale}
          \PY{n}{Xs} \PY{o}{=} \PY{n}{scale}\PY{p}{(}\PY{n}{X}\PY{p}{)}
          \PY{n}{Xs\PYZus{}train}\PY{p}{,} \PY{n}{Xs\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{Xs}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}
          \PY{n}{lr\PYZus{}2} \PY{o}{=} \PY{n}{lr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{Xs\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Scaled Logistic Regression score for test set: }\PY{l+s+si}{\PYZpc{}f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{lr\PYZus{}2}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{Xs\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
          \PY{n}{y\PYZus{}true}\PY{p}{,} \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{lr\PYZus{}2}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{Xs\PYZus{}test}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{y\PYZus{}true}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Scaled Logistic Regression score for test set: 0.684631
             precision    recall  f1-score   support

          0       1.00      0.03      0.07        29
          1       0.69      1.00      0.81       342
          2       0.00      0.00      0.00        85
          3       0.00      0.00      0.00         9
          4       0.00      0.00      0.00        36

avg / total       0.53      0.68      0.56       501


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}sklearn\textbackslash{}metrics\textbackslash{}classification.py:1135: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn\_for)

    \end{Verbatim}

    This is very interesting! The performance of logistic regression did not
improve with data scaling. Why not, particularly when we saw that
k-Nearest Neigbours performance improved substantially with scaling? The
reason is that, if there predictor variables with large ranges that do
not effect the target variable, a regression algorithm will make the
corresponding coefficients ai small so that they do not effect
predictions so much. K-nearest neighbours does not have such an inbuilt
strategy and so we very much needed to scale the data.

    \section{Scaling Synthesized Data}\label{scaling-synthesized-data}

Scaling numerical data (that is, multiplying all instances of a variable
by a constant in order to change that variable's range) has two related
purposes: i) if your measurements are in different currencies and, then,
if we both scale our data, they end up being the same \& ii) if two
variables have vastly different ranges, the one with the larger range
may dominate your predictive model, even though it may be less important
to our target variable than the variable with the smaller range. What we
saw is that this problem identified in ii) occurs with k-NN, which
explicitly looks at how close data are to one another but not in
logistic regression which, when being trained, will shrink the relevant
coefficient to account for the lack of scaling. We can see was how the
models performed before and after scaling.

    Let's now split into testing \& training sets \& plot both sets:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}121}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cross\PYZus{}validation} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
          \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{1} \PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{training set}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]} \PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}  \PY{n}{c} \PY{o}{=} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]} \PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}  \PY{n}{c} \PY{o}{=} \PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test set}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_223_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Looking good! Now let's instantiate a k-Nearest Neighbors voting
classifier \& train it on our training set

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}122}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{neighbors}\PY{p}{,} \PY{n}{linear\PYZus{}model}
          \PY{n}{knn} \PY{o}{=} \PY{n}{neighbors}\PY{o}{.}\PY{n}{KNeighborsClassifier}\PY{p}{(}\PY{p}{)}
          \PY{n}{knn\PYZus{}model} \PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}NN score for test set: }\PY{l+s+si}{\PYZpc{}f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{knn\PYZus{}model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}NN score for training set: }\PY{l+s+si}{\PYZpc{}f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{knn\PYZus{}model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}\PY{p}{)}
          
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{classification\PYZus{}report}
          \PY{n}{y\PYZus{}true}\PY{p}{,} \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{knn\PYZus{}model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{y\PYZus{}true}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
k-NN score for test set: 0.700599
k-NN score for training set: 0.767500
             precision    recall  f1-score   support

          0       0.38      0.25      0.30        20
          1       0.72      0.94      0.81       339
          2       0.65      0.29      0.40        96
          3       0.00      0.00      0.00         5
          4       0.17      0.02      0.04        41

avg / total       0.64      0.70      0.64       501


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}achow\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}sklearn\textbackslash{}metrics\textbackslash{}classification.py:1135: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn\_for)

    \end{Verbatim}

    We can notice the improvement for KNN compare to Logistic Regression Now
with scaling KNN: I'll now scale the predictor variables and then use
k-NN again:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}123}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{scale}
          \PY{n}{Xs} \PY{o}{=} \PY{n}{scale}\PY{p}{(}\PY{n}{X}\PY{p}{)}
          \PY{n}{Xs\PYZus{}train}\PY{p}{,} \PY{n}{Xs\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{Xs}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{1} \PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{Xs\PYZus{}train}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]} \PY{p}{,} \PY{n}{Xs\PYZus{}train}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}  \PY{n}{c} \PY{o}{=} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{scaled training set}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{Xs\PYZus{}test}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]} \PY{p}{,} \PY{n}{Xs\PYZus{}test}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}  \PY{n}{c} \PY{o}{=} \PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{scaled test set}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
          \PY{n}{knn\PYZus{}model\PYZus{}s} \PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{Xs\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}NN score for test set: }\PY{l+s+si}{\PYZpc{}f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{knn\PYZus{}model\PYZus{}s}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{Xs\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_227_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
k-NN score for test set: 0.678643

    \end{Verbatim}

    k-NN score for test set: 0.72 or 72\%

It doesn't perform any better with scaling! This is most likely because
both features were already around the same range. It really makes sense
to scale when variables have widely varying ranges. To see this in
action, we're going to add another feature. Moreover, this feature will
bear no relevance to the target variable: it will be mere noise.

    \section{Adding Gaussian noise to the signal
(KNN):}\label{adding-gaussian-noise-to-the-signal-knn}

We add a third variable of Gaussian noise with mean 0 and variable
standard deviation σ. We'll call σ the strength of the noise and we'll
see that the stronger the noise, the worse the performance of k-Nearest
Neighbours

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}124}]:} \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
          \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} Generate some clustered data (blobs!)}
          \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{datasets}\PY{n+nn}{.}\PY{n+nn}{samples\PYZus{}generator} \PY{k}{import} \PY{n}{make\PYZus{}blobs}
          \PY{n}{n\PYZus{}samples}\PY{o}{=}\PY{l+m+mi}{2000}
          \PY{n}{X}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{n}{make\PYZus{}blobs}\PY{p}{(}\PY{n}{n\PYZus{}samples}\PY{p}{,} \PY{n}{centers}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{,} \PY{n}{n\PYZus{}features}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,}
                            \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Add noise column to predictor variables}
          \PY{n}{ns} \PY{o}{=} \PY{l+m+mi}{10}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{)} \PY{c+c1}{\PYZsh{} Strength of noise term}
          \PY{n}{newcol} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{[}\PY{n}{ns}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{randn}\PY{p}{(}\PY{n}{n\PYZus{}samples}\PY{p}{)}\PY{p}{]}\PY{p}{)}
          \PY{n}{Xn} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{newcol}\PY{p}{)}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
          
          \PY{k+kn}{from} \PY{n+nn}{mpl\PYZus{}toolkits}\PY{n+nn}{.}\PY{n+nn}{mplot3d} \PY{k}{import} \PY{n}{Axes3D}
          \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}\PY{p}{;}
          \PY{n}{ax} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{,} \PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{3d}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}\PY{p}{;}
          \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{Xn}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{Xn}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{Xn}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{y}\PY{p}{)}\PY{p}{;}
          
          \PY{n}{Xn\PYZus{}train}\PY{p}{,} \PY{n}{Xn\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{Xn}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
          \PY{n}{knn} \PY{o}{=} \PY{n}{neighbors}\PY{o}{.}\PY{n}{KNeighborsClassifier}\PY{p}{(}\PY{n}{n\PYZus{}neighbors}\PY{o}{=}\PY{l+m+mi}{6}\PY{p}{)}
          \PY{n}{knn\PYZus{}model} \PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{Xn\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}NN score for test set: }\PY{l+s+si}{\PYZpc{}f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{knn\PYZus{}model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{Xn\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
k-NN score for test set: 0.305000

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_230_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    k-NN score for test set: 0..355 or 36\%

    This is a horrible model! How about we scale and check out performance?

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}125}]:} \PY{n}{Xns} \PY{o}{=} \PY{n}{scale}\PY{p}{(}\PY{n}{Xn}\PY{p}{)}
          \PY{n}{s} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{o}{.}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{n\PYZus{}samples}\PY{p}{)}
          \PY{n}{Xns\PYZus{}train} \PY{o}{=} \PY{n}{Xns}\PY{p}{[}\PY{n}{s}\PY{p}{:}\PY{p}{]}
          \PY{n}{y\PYZus{}train} \PY{o}{=} \PY{n}{y}\PY{p}{[}\PY{n}{s}\PY{p}{:}\PY{p}{]}
          \PY{n}{Xns\PYZus{}test} \PY{o}{=} \PY{n}{Xns}\PY{p}{[}\PY{p}{:}\PY{n}{s}\PY{p}{]}
          \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{y}\PY{p}{[}\PY{p}{:}\PY{n}{s}\PY{p}{]}
          \PY{n}{knn\PYZus{}models} \PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{Xns\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          \PY{n}{knn\PYZus{}accuracy} \PY{o}{=} \PY{n}{knn\PYZus{}models}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{Xns\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{knn\PYZus{}accuracy for test set: }\PY{l+s+s1}{\PYZsq{}} \PY{p}{,} \PY{n}{knn\PYZus{}accuracy}\PY{p}{)}
          
          \PY{n}{knn\PYZus{}prediction} \PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{Xns}\PY{p}{[}\PY{l+m+mi}{1515}\PY{p}{:}\PY{l+m+mi}{1535}\PY{p}{]}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KNN : \PYZhy{} Output of Real Data : Conv=5, FHA=4, Res=3, Comm=2: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{p}{(}\PY{n}{y}\PY{p}{[}\PY{l+m+mi}{1515}\PY{p}{:}\PY{l+m+mi}{1535}\PY{p}{]}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KNN : \PYZhy{} Output of prediction: Conv=5, FHA=4, Res=3, Comm=2: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{knn\PYZus{}prediction}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
knn\_accuracy for test set:  0.9225
KNN : - Output of Real Data : Conv=5, FHA=4, Res=3, Comm=2:  [3 3 1 2 3 1 1 2 0 3 2 3 3 1 3 2 2 1 0 0]
KNN : - Output of prediction: Conv=5, FHA=4, Res=3, Comm=2:  [3 3 1 2 3 1 1 2 0 3 2 3 3 1 3 2 2 1 0 2]

    \end{Verbatim}

    With Scale and Synthesize the data we can see huge improvement on the
model accuracy.. 36\% to 93\% Let's do same for Logistic Regression and
check out the performance.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}126}]:} \PY{n}{ns} \PY{o}{=} \PY{l+m+mi}{10}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{)} \PY{c+c1}{\PYZsh{} Strength of noise term}
          \PY{c+c1}{\PYZsh{} Set sc = True if you want to scale your features}
          \PY{n}{sc} \PY{o}{=} \PY{k+kc}{False}
          \PY{c+c1}{\PYZsh{}Import packages}
          \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cross\PYZus{}validation} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
          \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{neighbors}\PY{p}{,} \PY{n}{linear\PYZus{}model}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{scale}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{datasets}\PY{n+nn}{.}\PY{n+nn}{samples\PYZus{}generator} \PY{k}{import} \PY{n}{make\PYZus{}blobs}
              
          \PY{c+c1}{\PYZsh{}Generate some data}
          \PY{n}{n\PYZus{}samples}\PY{o}{=}\PY{l+m+mi}{2000}
          \PY{n}{X}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{n}{make\PYZus{}blobs}\PY{p}{(}\PY{n}{n\PYZus{}samples}\PY{p}{,} \PY{n}{centers}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{,} \PY{n}{n\PYZus{}features}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} Add noise column to predictor variables}
          \PY{n}{newcol} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{[}\PY{n}{ns}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{randn}\PY{p}{(}\PY{n}{n\PYZus{}samples}\PY{p}{)}\PY{p}{]}\PY{p}{)}
          \PY{n}{Xn} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{newcol}\PY{p}{)}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}Scale if desired}
          \PY{k}{if} \PY{n}{sc} \PY{o}{==} \PY{k+kc}{True}\PY{p}{:}
              \PY{n}{Xn} \PY{o}{=} \PY{n}{scale}\PY{p}{(}\PY{n}{Xn}\PY{p}{)}
              
          \PY{c+c1}{\PYZsh{}Train model and test after splitting}
          \PY{n}{Xn\PYZus{}train}\PY{p}{,} \PY{n}{Xn\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{Xn}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
          \PY{n}{lr} \PY{o}{=} \PY{n}{linear\PYZus{}model}\PY{o}{.}\PY{n}{LogisticRegression}\PY{p}{(}\PY{p}{)}
          \PY{n}{lr\PYZus{}model} \PY{o}{=} \PY{n}{lr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{Xn\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logistic regression score for test set: }\PY{l+s+si}{\PYZpc{}f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{lr\PYZus{}model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{Xn\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
logistic regression score for test set: 0.930000

    \end{Verbatim}

    logistic regression score for test set has improved from 66\% to 0.93 or
93\%

We can see big improvement. We have seen the essential place in the data
scientific pipeline by preprocessing, in its scaling and centering
incarnation, and we have done so to promote a holistic approach to
minimize the challenges of machine learning.

To conclude, we have seen the essential place occupied in the data
scientific pipeline by preprocessing, in its scaling and centering
incarnation, and we have done so to promote a holistic approach to the
challenges of machine learning.

    \section{Random Forests (RF)}\label{random-forests-rf}

Random forests is a supervised learning algorithm. It can be used both
for classification and regression. It is also the most flexible and easy
to use algorithm. A forest is comprised of trees. It is said that the
more trees it has, the more robust a forest is. Random forests creates
decision trees on randomly selected data samples, gets prediction from
each tree and selects the best solution by means of voting. It also
provides a pretty good indicator of the feature importance. Random
forests has a variety of applications, such as recommendation engines,
image classification and feature selection. It can be used to classify
loyal loan applicants, identify fraudulent activity and predict
diseases.

• Random forests is considered as a highly accurate and robust method
because of the number of decision trees participating in the process.

• It does not suffer from the over fitting problem. The main reason is
that it takes the average of all the predictions, which cancels out the
biases.

• The algorithm can be used in both classification and regression
problems.

• Random forests can also handle missing values

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}128}]:} \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
          \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
          \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{preprocessing}\PY{p}{,} \PY{n}{cross\PYZus{}validation}\PY{p}{,} \PY{n}{neighbors}\PY{p}{,} \PY{n}{svm} 
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{RandomForestClassifier}\PY{p}{,} \PY{n}{RandomForestRegressor}
          
          \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
          \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}rfc} \PY{o}{=} \PY{n}{cross\PYZus{}validation}\PY{o}{.}\PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size} \PY{o}{=} \PY{l+m+mf}{0.2}\PY{p}{)}
          
          \PY{n}{rfc} \PY{o}{=} \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{max\PYZus{}features}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{auto}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{,} \PY{n}{oob\PYZus{}score} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)} 
          \PY{n}{rfc}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          \PY{n}{rfc\PYZus{}accuracy} \PY{o}{=} \PY{n}{rfc}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}rfc}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unscalled: Random Forest Classifier Accuracy : }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{rfc\PYZus{}accuracy}\PY{p}{)}
          
          \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
          \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loan\PYZus{}type\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{scale}
          \PY{n}{X\PYZus{}scaled} \PY{o}{=} \PY{n}{scale}\PY{p}{(}\PY{n}{X}\PY{p}{)}
          
          \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}rfc} \PY{o}{=} \PY{n}{cross\PYZus{}validation}\PY{o}{.}\PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size} \PY{o}{=} \PY{l+m+mf}{0.2}\PY{p}{)}
          \PY{n}{rfc} \PY{o}{=} \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{max\PYZus{}features}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{auto}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{,} \PY{n}{oob\PYZus{}score} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)} 
          \PY{n}{rfc}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          \PY{n}{rfc\PYZus{}accuracy} \PY{o}{=} \PY{n}{rfc}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}rfc}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Scalled: Random Forest Classifier Accuracy   : }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{rfc\PYZus{}accuracy}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}Look for the confussion Matrix}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{confusion\PYZus{}matrix}
          \PY{c+c1}{\PYZsh{}confusion\PYZus{}matrix?}
          
          \PY{n}{rfc}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          \PY{n}{y\PYZus{}pred\PYZus{}rfc} \PY{o}{=} \PY{n}{rfc}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          \PY{n}{y\PYZus{}pred\PYZus{}rfc\PYZus{}out} \PY{o}{=} \PY{n}{rfc}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{l+m+mi}{975}\PY{p}{:}\PY{l+m+mi}{995}\PY{p}{,}\PY{p}{]}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RFC Confussion Matrix: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}test\PYZus{}rfc}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}rfc}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{sample\PYZus{}weight}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KNeighborsClassifier Accuracy : }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{rfc\PYZus{}accuracy}\PY{p}{)} 
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RandomForestClassifier :Input Real Data : Conv=5, FHA=4, Res=3, Comm=2: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{X}\PY{p}{[}\PY{l+m+mi}{975}\PY{p}{:}\PY{l+m+mi}{995}\PY{p}{,}\PY{p}{]}\PY{p}{)} 
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RandomForestClassifier :Output of X[975:995]:Conv=5, FHA=4, Res=3, Comm=0:}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,} \PY{n}{y}\PY{p}{[}\PY{l+m+mi}{975}\PY{p}{:}\PY{l+m+mi}{995}\PY{p}{]}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RandomForestClassifier :Output of prediction: Conv=5, FHA=4, Res=3, Comm=:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}rfc\PYZus{}out}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RandomForestClassifier : \PYZhy{} Output of prediction: Fix\PYZus{}True =1 \PYZam{} ARM =0:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}rfc}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Unscalled: Random Forest Classifier Accuracy :  0.7664670658682635
Scalled: Random Forest Classifier Accuracy   :  0.782435129740519
RFC Confussion Matrix: 
[[ 10  13   0   0   1]
 [  2 334   9   0   2]
 [  0  42  37   0   0]
 [  0   8   0   1   0]
 [  0  32   0   0  10]]
KNeighborsClassifier Accuracy :  0.782435129740519
RandomForestClassifier :Input Real Data : Conv=5, FHA=4, Res=3, Comm=2:  [[ 3.    1.55  3.17  7.    1.    6.    4.5   1.96  5.4 ]
 [ 4.47  5.83  3.37 10.    1.    8.    4.6   1.71  5.4 ]
 [ 1.64  3.36  4.32  7.    1.    9.    4.    1.71  5.4 ]
 [ 3.25  2.29  3.79  7.    0.    7.    4.6   2.03  5.4 ]
 [ 4.05  1.55  3.18  7.    1.    6.    4.7   2.03  5.4 ]
 [ 2.27  3.18  3.83  7.    1.    6.    4.8   2.03  5.4 ]
 [ 6.25  2.84  3.58  7.    1.    7.    4.7   1.76  5.4 ]
 [ 1.84  1.27  3.31  1.    1.    7.    4.8   1.76  5.4 ]
 [ 3.46  5.75  0.34  7.    1.    7.    4.7   2.86  5.4 ]
 [ 1.86  4.54  3.55  1.    1.    8.    4.9   2.86  5.4 ]
 [ 9.4   0.4   3.09 10.    1.    7.    5.    2.86  5.4 ]
 [ 2.95  0.82  1.43  7.    1.    7.    4.9   2.    5.4 ]
 [ 4.42  2.05  3.44 10.    1.    6.    5.    2.    5.4 ]
 [ 4.8   4.32  1.13  0.    1.    7.    4.1   2.36  5.4 ]
 [ 7.44  0.2   2.81  9.    1.    6.    4.2   2.36  5.4 ]
 [ 3.88  2.68  3.58 10.    1.    5.    4.3   2.36  5.4 ]
 [ 6.8   0.94  4.    7.    1.    6.    5.4   2.9   5.4 ]
 [ 4.5   0.93  4.    0.    1.    7.    5.5   2.9   5.4 ]
 [ 3.64  3.87  3.94  7.    1.    7.    5.6   2.9   5.4 ]
 [15.    0.12  2.81  6.    0.    2.    5.7   2.9   5.4 ]]
RandomForestClassifier :Output of X[975:995]:Conv=5, FHA=4, Res=3, Comm=0: [4 1 2 4 4 4 1 1 1 1 1 4 4 1 1 1 1 1 1 0]
RandomForestClassifier :Output of prediction: Conv=5, FHA=4, Res=3, Comm=: [4 1 2 4 4 4 1 1 1 1 1 4 4 1 1 1 1 1 1 0]
RandomForestClassifier : - Output of prediction: Fix\_True =1 \& ARM =0: [1 1 1 2 2 1 1 1 2 1 1 2 1 1 1 1 1 1 1 2 2 1 1 1 2 1 1 1 1 1 2 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 2 1 1 1 1 1 1 2 1 1 1 1 1 1 2 1 1 1 1 0 1 1 1 1 1 1 1 2 1 1 2 1 1 1 1 1 1 1 0 2 1 4 1 1 1 1
 1 1 1 1 1 1 1 0 1 1 1 1 1 1 2 1 1 4 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 1 1 1 1 1 1 1 1 2 1 2 1
 1 1 1 1 1 1 1 2 4 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 4 1 1 1 4 1 1 1 3 4 1 1 1 1 1 1 2 1 1 1 1
 1 1 1 1 1 1 4 1 1 1 1 1 1 1 2 4 1 1 1 1 1 1 2 1 1 2 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 0 1 2 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 2 1 1 1 1 1 2 1 1 1 1 1 1 2 1 1 1 1 1 1 1 2 1 1 0 1 1 1 1
 1 1 1 1 1 0 2 1 0 1 1 1 1 1 1 1 1 1 2 1 1 1 1 2 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 2 1 1 1 1 2 1 2 1 2 1 2 2 1 1 1 1 1 2 4 1 4 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 2 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 4 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 4 1 1 1 1 1]

    \end{Verbatim}

    Unscalled: Random Forest Classifier Accuracy : 77\%

Scalled: Random Forest Classifier Accuracy : 78\%

Both unscalled and scalled for Random Forest Model accuray is almost
close

    \section{Let's analyze Interest Rate types using Random Forest
Classifier.}\label{lets-analyze-interest-rate-types-using-random-forest-classifier.}

We have achieved greater accuracy compare to Loan Types. We have Fixed
Rate mortgage where Fix\_True = 1 \& Fix\_True = 0 for ARM (Adjustable
Rate Mortgage)

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}131}]:} \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
          \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
          \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{preprocessing}\PY{p}{,} \PY{n}{cross\PYZus{}validation}\PY{p}{,} \PY{n}{neighbors}\PY{p}{,} \PY{n}{svm}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{RandomForestClassifier}\PY{p}{,} \PY{n}{RandomForestRegressor}
          
          \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
          \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{scale}
          \PY{c+c1}{\PYZsh{} Scale the features: X\PYZus{}scaled}
          \PY{n}{X\PYZus{}scaled} \PY{o}{=} \PY{n}{scale}\PY{p}{(}\PY{n}{X}\PY{p}{)}
          
          \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}rfc} \PY{o}{=} \PY{n}{cross\PYZus{}validation}\PY{o}{.}\PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size} \PY{o}{=} \PY{l+m+mf}{0.2}\PY{p}{)}
          
          \PY{n}{rfc} \PY{o}{=} \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{max\PYZus{}features}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{auto}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{,} \PY{n}{oob\PYZus{}score} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
          
          \PY{n}{rfc}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          \PY{n}{rfc\PYZus{}accuracy} \PY{o}{=} \PY{n}{rfc}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}rfc}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Random Forest Classifier Accuracy : }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{rfc\PYZus{}accuracy}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Look for the confussion Matrix}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{confusion\PYZus{}matrix}
          \PY{c+c1}{\PYZsh{}confusion\PYZus{}matrix? \PYZsh{} Hit enter}
          
          \PY{n}{rfc}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          \PY{n}{y\PYZus{}pred\PYZus{}rfc} \PY{o}{=} \PY{n}{rfc}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          \PY{n}{y\PYZus{}pred\PYZus{}rfc\PYZus{}out} \PY{o}{=} \PY{n}{rfc}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{l+m+mi}{975}\PY{p}{:}\PY{l+m+mi}{995}\PY{p}{,}\PY{p}{]}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RFC Confussion Matrix: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}test\PYZus{}rfc}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}rfc}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{sample\PYZus{}weight}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RandomForestClassifier Accuracy : }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{rfc\PYZus{}accuracy}\PY{p}{)}
          
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RandomForestClassifier : \PYZhy{} Input of Real Data : Fix\PYZus{}True =1 \PYZam{} ARM =0: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{X}\PY{p}{[}\PY{l+m+mi}{975}\PY{p}{:}\PY{l+m+mi}{995}\PY{p}{,}\PY{p}{]}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RandomForestClassifier : \PYZhy{} Output of X[975:995]: Fix\PYZus{}True =1 \PYZam{} ARM =0:}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,} \PY{n}{y}\PY{p}{[}\PY{l+m+mi}{975}\PY{p}{:}\PY{l+m+mi}{995}\PY{p}{]}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RandomForestClassifier : \PYZhy{} Output of prediction: Fix\PYZus{}True =1 \PYZam{} ARM =0:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}rfc\PYZus{}out}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} Prediction  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RandomForestClassifier : \PYZhy{} Output of prediction: Fix\PYZus{}True =1 \PYZam{} ARM =0:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}rfc}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Random Forest Classifier Accuracy :  0.908183632734531
RFC Confussion Matrix: 
[[ 10  40]
 [  6 445]]
RandomForestClassifier Accuracy :  0.908183632734531
RandomForestClassifier : - Input of Real Data : Fix\_True =1 \& ARM =0:  [[ 300000.       155.       317.         4.       753.         7.         4.        62.
       45.         1.96       5.4 ]
 [ 447000.       583.       337.         2.       708.        10.         1.        87.82
       46.         1.71       5.4 ]
 [ 164326.25     336.       432.         4.       616.         7.         2.        95.
       40.         1.71       5.4 ]
 [ 325000.       229.       379.         2.       738.         7.         4.        75.
       46.         2.03       5.4 ]
 [ 405000.       155.       318.         2.       798.         7.         4.        66.61
       47.         2.03       5.4 ]
 [ 227500.       318.       383.         0.       767.         7.         4.        61.
       48.         2.03       5.4 ]
 [ 625000.       284.       358.         4.       733.         7.         1.        72.
       47.         1.76       5.4 ]
 [ 183750.       127.       331.         4.       719.         1.         1.        75.
       48.         1.76       5.4 ]
 [ 346000.       575.        34.         0.       706.         7.         1.        71.
       47.         2.86       5.4 ]
 [ 186400.       454.       355.         4.       734.         1.         1.        80.
       49.         2.86       5.4 ]
 [ 940000.        40.       309.         0.       700.        10.         1.        70.
       50.         2.86       5.4 ]
 [ 295000.        82.       143.         4.       730.         7.         4.        75.
       49.         2.         5.4 ]
 [ 442500.       205.       344.         4.       804.        10.         4.        68.97
       50.         2.         5.4 ]
 [ 480000.       432.       113.         4.       808.         0.         1.        75.
       41.         2.36       5.4 ]
 [ 743997.        20.       281.         2.       647.         9.         1.        62.
       42.         2.36       5.4 ]
 [ 387500.       268.       358.         4.       798.        10.         1.        50.
       43.         2.36       5.4 ]
 [ 679650.        94.       400.         0.       740.         7.         1.        68.
       54.         2.9        5.4 ]
 [ 450000.        93.       400.         0.       740.         0.         1.        75.
       55.         2.9        5.4 ]
 [ 363750.       387.       394.         0.       740.         7.         1.        75.
       56.         2.9        5.4 ]
 [1500000.        12.       281.         0.       725.         6.         0.        21.
       57.         2.9        5.4 ]]
RandomForestClassifier : - Output of X[975:995]: Fix\_True =1 \& ARM =0: [1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0]
RandomForestClassifier : - Output of prediction: Fix\_True =1 \& ARM =0: [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0]

\#\#\#\#\#\#\#\#\#\#\#\# Prediction  \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#
RandomForestClassifier : - Output of prediction: Fix\_True =1 \& ARM =0: [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1
 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 0 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 0 1 1 1 1 1]

    \end{Verbatim}

    Random Forest Classifier Accuracy for Fix or ARM is : 0.91 or 91\%

    \section{Using Random Forest finding Important Features in
Scikit-learn}\label{using-random-forest-finding-important-features-in-scikit-learn}

Here, we are finding important features or selecting features in the
Mortgage Loan dataset. In scikit-learn, we can perform this task in the
following steps:

• First, we need to create a random forests model.

• Second, use the feature importance variable to see feature importance
scores.

• Third, visualize these scores using the seaborn library.'''

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}133}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{RandomForestClassifier}
          \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{preprocessing}\PY{p}{,} \PY{n}{cross\PYZus{}validation}\PY{p}{,} \PY{n}{neighbors}\PY{p}{,} \PY{n}{svm}
          
          \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
          \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{scale}
          \PY{c+c1}{\PYZsh{} Scale the features: X\PYZus{}scaled}
          \PY{n}{X\PYZus{}scaled} \PY{o}{=} \PY{n}{scale}\PY{p}{(}\PY{n}{X}\PY{p}{)}
          
          \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}rfc} \PY{o}{=} \PY{n}{cross\PYZus{}validation}\PY{o}{.}\PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size} \PY{o}{=} \PY{l+m+mf}{0.2}\PY{p}{)}
          
          \PY{n}{rfc} \PY{o}{=} \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{max\PYZus{}features}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{auto}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{,} \PY{n}{oob\PYZus{}score} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
          
          \PY{n}{rfc}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          \PY{n}{rfc\PYZus{}accuracy} \PY{o}{=} \PY{n}{rfc}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}rfc}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Random Forest Classifier Accuracy : }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{rfc\PYZus{}accuracy}\PY{p}{)}
          
          
          \PY{c+c1}{\PYZsh{}Create a Gaussian Classifier}
          \PY{n}{clf}\PY{o}{=}\PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}Train the model using the training sets y\PYZus{}pred=clf.predict(X\PYZus{}test)}
          \PY{n}{clf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}
          
          \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{bootstrap}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{class\PYZus{}weight}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{criterion}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                      \PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{max\PYZus{}features}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{auto}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{max\PYZus{}leaf\PYZus{}nodes}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,}
                      \PY{n}{min\PYZus{}impurity\PYZus{}decrease}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,} \PY{n}{min\PYZus{}impurity\PYZus{}split}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,}
                      \PY{n}{min\PYZus{}samples\PYZus{}leaf}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{min\PYZus{}samples\PYZus{}split}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,}
                      \PY{n}{min\PYZus{}weight\PYZus{}fraction\PYZus{}leaf}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,} \PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
                      \PY{n}{oob\PYZus{}score}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}
                      \PY{n}{warm\PYZus{}start}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
          
          
          \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
          \PY{c+c1}{\PYZsh{}col\PYZus{}names = (fit\PYZus{}data.columns)}
          
          \PY{n}{X} \PY{o}{=} \PY{p}{(}\PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualification FICO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{feature\PYZus{}cols} \PY{o}{=} \PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{columns}
          
          \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{columns}
          \PY{n}{feature\PYZus{}names} \PY{o}{=} \PY{n}{feature\PYZus{}cols}
          \PY{n}{feature\PYZus{}imp} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{clf}\PY{o}{.}\PY{n}{feature\PYZus{}importances\PYZus{}}\PY{p}{,}\PY{n}{index}\PY{o}{=}\PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
          \PY{n}{feature\PYZus{}imp}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Random Forest Classifier Accuracy :  0.8982035928143712

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}133}]:} RATE                 0.148499
          Loan Amount          0.126198
          unit\_type\_code       0.111566
          zip\_code             0.107917
          LoanInMonth          0.104603
          city\_code            0.101437
          CLTV                 0.083989
          Fix\_True             0.082615
          Home                 0.061437
          loan\_type\_code       0.038747
          loan\_purpose\_code    0.032993
          dtype: float64
\end{Verbatim}
            
    We can also visualize the feature importance. Visualizations are easy to
understand and interpretable. For visualization, we have used a
combination of matplotlib and seaborn.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}134}]:} \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
          \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
          \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
          \PY{c+c1}{\PYZsh{} Creating a bar plot}
          \PY{n}{sns}\PY{o}{.}\PY{n}{barplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{feature\PYZus{}imp}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{n}{feature\PYZus{}imp}\PY{o}{.}\PY{n}{index}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} Add labels to your graph}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Feature Importance Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Visualizing Important Features}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
No handles with labels found to put in legend.

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_246_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Higher the value, greater the feature importance

    \section{Support Vector Regression
(SVR)}\label{support-vector-regression-svr}

SUPPORT VECTOR REGRESSION. Those who are in Machine Learning or Data
Science are quite familiar with the term SVM or Support Vector Machine.
But SVR is a bit different from SVM. As the name suggest the SVR is an
regression algorithm, so we can use SVR for working with continuous
Values instead of Classification which is SVM.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}135}]:} \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
          \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} We want to use svm now}
          \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{preprocessing}\PY{p}{,} \PY{n}{cross\PYZus{}validation}\PY{p}{,} \PY{n}{svm}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LinearRegression}
          \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
          \PY{k+kn}{from} \PY{n+nn}{matplotlib} \PY{k}{import} \PY{n}{style}
          
          \PY{n}{clf} \PY{o}{=} \PY{n}{svm}\PY{o}{.}\PY{n}{SVR}\PY{p}{(}\PY{p}{)}
          \PY{n}{clf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          \PY{n}{accuracy} \PY{o}{=} \PY{n}{clf}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SVM accuracy: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{accuracy}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
SVM accuracy:  -0.025991264219975774

    \end{Verbatim}

    SVM-SVR accuracy: -0.026 which is unacceptable for our Mortgage Loan
Data Sets

    \section{Support Vector Machine (SVM)}\label{support-vector-machine-svm}

A Support Vector Machine (SVM) is a discriminative classifier formally
defined by a separating hyperplane. In other words, given labeled
training data (supervised learning), the algorithm outputs an optimal
hyperplane which categorizes new examples. In two dimensional space this
hyperplane is a line dividing a plane in two parts where in each class
lay in either side.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}136}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{preprocessing}\PY{p}{,} \PY{n}{cross\PYZus{}validation}\PY{p}{,} \PY{n}{neighbors}\PY{p}{,} \PY{n}{svm}
          
          \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
          \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}Define SVM support vector classifier}
          \PY{n}{svmc} \PY{o}{=} \PY{n}{svm}\PY{o}{.}\PY{n}{SVC}\PY{p}{(}\PY{n}{kernel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rbf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{C}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{gamma}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{svmc}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          \PY{n}{svm\PYZus{}accuracy} \PY{o}{=} \PY{n}{svmc}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Support Vector Classifier Accuracy : }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{svm\PYZus{}accuracy}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Look for the confussion Matrix}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{confusion\PYZus{}matrix}
          \PY{c+c1}{\PYZsh{}confusion\PYZus{}matrix? \PYZsh{} Hit enter}
          
          \PY{n}{svmc}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          \PY{n}{y\PYZus{}pred\PYZus{}svm} \PY{o}{=} \PY{n}{svmc}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SVC Confussion Matrix: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{sample\PYZus{}weight}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{)}
          
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cross\PYZus{}validation} \PY{k}{import} \PY{n}{cross\PYZus{}val\PYZus{}score}
          \PY{n}{svm\PYZus{}scores} \PY{o}{=} \PY{n}{cross\PYZus{}val\PYZus{}score}\PY{p}{(}\PY{n}{svmc}\PY{p}{,} \PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{7}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SVM: cross\PYZus{}val\PYZus{}score accuracy : }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{svm\PYZus{}scores}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Support Vector Classifier Accuracy :  0.8962075848303394
SVC Confussion Matrix: 
[[  6  47   0   0]
 [  7 392  43   6]
 [  0   0   0   0]
 [  0   0   0   0]]
SVM: cross\_val\_score accuracy :  [0.9 0.9 0.9 0.9 0.9 0.9 0.9]

    \end{Verbatim}

    Support Vector Classifier Accuracy : 0.896 or 90\%

    \section{k-Nearest Neighbors (KNN)}\label{k-nearest-neighbors-knn}

k-Nearest Neighbors: FIT

Having explored the Congressional mortgage records dataset, we have
build our classifier. Here, we will fit a k-Nearest Neighbors classifier
to the mortgage dataset. The features need to be in an array where each
column is a feature and each row a different observation or data point.
The target needs to be a single column with the same number of
observations as the feature data. Notice we named the feature array X
and response variable y: This is in accordance with the common
scikit-learn practice. We need create an instance of a k-NN classifier
with 6 neighbors (by specifying the n\_neighbors parameter) and then fit
it to the data.

    \section{k-Nearest Neighbors:
Predict}\label{k-nearest-neighbors-predict}

Having fit a k-NN classifier, we can use it to predict the label of a
new data point. However, there is no unlabeled data available since all
of it was used to fit the model! We will use your classifier to predict
the label for this new data point, as well as on the training data X
that the model has already seen.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}141}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{neighbors} \PY{k}{import} \PY{n}{KNeighborsClassifier}
          \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{preprocessing}\PY{p}{,} \PY{n}{cross\PYZus{}validation}\PY{p}{,} \PY{n}{neighbors}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{confusion\PYZus{}matrix}\PY{p}{,} \PY{n}{classification\PYZus{}report}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split} \PY{c+c1}{\PYZsh{} for train and test set split}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{cross\PYZus{}val\PYZus{}score}
          
          \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
          \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{model\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}knn} \PY{o}{=} \PY{n}{cross\PYZus{}validation}\PY{o}{.}\PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size} \PY{o}{=} \PY{l+m+mf}{0.2}\PY{p}{)}
          
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{neighbors} \PY{k}{import} \PY{n}{KNeighborsClassifier}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{size of the training feature set is}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{size of the test feature set is}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{X\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{size of the training Target set is}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{size of the test Target set is}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Import scale}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{scale}
          
          \PY{c+c1}{\PYZsh{} Scale the features: X\PYZus{}scaled}
          \PY{n}{X\PYZus{}scaled} \PY{o}{=} \PY{n}{scale}\PY{p}{(}\PY{n}{X}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Print the mean and standard deviation of the unscaled features}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Mean of Unscaled Features: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{X}\PY{p}{)}\PY{p}{)}\PY{p}{)} 
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Standard Deviation of Unscaled Features: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{X}\PY{p}{)}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Print the mean and standard deviation of the scaled features}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Mean of Scaled Features: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{X\PYZus{}scaled}\PY{p}{)}\PY{p}{)}\PY{p}{)} 
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Standard Deviation of Scaled Features: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{X\PYZus{}scaled}\PY{p}{)}\PY{p}{)}\PY{p}{)}
          \PY{n}{knn} \PY{o}{=} \PY{n}{neighbors}\PY{o}{.}\PY{n}{KNeighborsClassifier}\PY{p}{(}\PY{n}{n\PYZus{}neighbors}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{)}
          \PY{n}{knn}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          \PY{n}{knn\PYZus{}accuracy} \PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}knn}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{KNeighborsClassifier Accuracy : }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{knn\PYZus{}accuracy}\PY{p}{)} 
          \PY{n}{knn\PYZus{}prediction} \PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{l+m+mi}{1200}\PY{p}{:}\PY{l+m+mi}{1220}\PY{p}{,}\PY{p}{]}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{KNN : \PYZhy{} Input of Real Data :: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{X}\PY{p}{[}\PY{l+m+mi}{1200}\PY{p}{:}\PY{l+m+mi}{1220}\PY{p}{,}\PY{p}{]}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KNN : \PYZhy{} Output of Real Data :: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{p}{[}\PY{l+m+mi}{1200}\PY{p}{:}\PY{l+m+mi}{1220}\PY{p}{,}\PY{p}{]}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KNN : \PYZhy{} Output of prediction:: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{knn\PYZus{}prediction}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
size of the training feature set is (2000, 11)
size of the test feature set is (501, 11)
size of the training Target set is (2000,)
size of the test Target set is (501,)


Mean of Unscaled Features: 40588.84442139507
Standard Deviation of Unscaled Features: 154733.50862580768


Mean of Scaled Features: -4.132413860696304e-18
Standard Deviation of Scaled Features: 1.0

KNeighborsClassifier Accuracy :  0.8882235528942116

KNN : - Input of Real Data ::  [[ 403200.       268.       358.         4.       694.        10.         1.        70.
       58.         2.38       5.3 ]
 [ 891000.       457.       348.         4.       745.         5.         0.        73.
       38.         2.78       5.3 ]
 [1116250.        38.       223.         4.       750.        10.         0.        55.3
       39.         2.78       5.3 ]
 [ 329670.       615.       337.         4.       762.         7.         1.        90.
       45.         1.89       5.3 ]
 [ 240000.       628.       306.         0.       788.         1.         1.        69.
       46.         1.89       5.3 ]
 [ 680000.       254.       333.         4.       724.        10.         1.        64.76
       47.         1.89       5.3 ]
 [ 424000.       578.       320.         4.       767.         7.         1.        53.
       59.         2.42       5.3 ]
 [ 289250.       288.       410.         4.       805.         7.         1.        65.
       60.         2.42       5.3 ]
 [ 360000.       378.       184.         4.       803.         1.         1.        80.
       61.         2.42       5.3 ]
 [ 353000.       628.       309.         0.       785.        10.         1.        51.
       48.         1.81       5.3 ]
 [ 337097.       653.       135.         2.       791.         7.         1.        97.
       49.         1.81       5.3 ]
 [ 779690.       628.       308.         0.       797.         9.         1.        48.
       50.         1.81       5.3 ]
 [ 367317.5      214.       406.         4.       639.         7.         2.         0.
       51.         1.81       5.3 ]
 [ 332500.       310.       108.         4.       732.         7.         1.        95.
       52.         1.81       5.3 ]
 [ 850000.       379.       188.         4.       771.         1.         1.        75.
       62.         2.39       5.3 ]
 [ 221000.       382.        54.         4.       778.         0.         1.        85.
       63.         2.39       5.3 ]
 [ 169000.       432.       113.         4.       763.         0.         1.        74.
       64.         2.39       5.3 ]
 [ 376000.       432.       113.         4.       683.         0.         1.        80.
       40.         2.74       5.3 ]
 [ 465000.       256.       359.         4.       714.         5.         0.        73.7
       41.         2.74       5.3 ]
 [ 119250.24      13.       153.         4.       657.         7.         2.        96.5
       42.         2.74       5.3 ]]
KNN : - Output of Real Data ::  [1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 0 1]
KNN : - Output of prediction::  [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]

    \end{Verbatim}

    KNeighborsClassifier Accuracy : 0.888 or 89\%

    \section{How do we improve the KNN
model}\label{how-do-we-improve-the-knn-model}

\section{Preprocessing: scaling}\label{preprocessing-scaling}

Here below I will take following steps to improve the model.

\begin{enumerate}
\def\labelenumi{(\roman{enumi})}
\item
  scale the data,
\item
  use k-Nearest Neighbors
\item
  check the model performance.
\end{enumerate}

I'll use scikit-learn's scale function, which standardizes all features
(columns) in the array passed to it.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}145}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{scale}
          \PY{n}{Xs} \PY{o}{=} \PY{n}{scale}\PY{p}{(}\PY{n}{X}\PY{p}{)}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cross\PYZus{}validation} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
          \PY{n}{Xs\PYZus{}train}\PY{p}{,} \PY{n}{Xs\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{Xs}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}
          \PY{n}{knn\PYZus{}model\PYZus{}2} \PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{Xs\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}NN score for test set: }\PY{l+s+si}{\PYZpc{}f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{knn\PYZus{}model\PYZus{}2}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{Xs\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}NN score for training set: }\PY{l+s+si}{\PYZpc{}f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{knn\PYZus{}model\PYZus{}2}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{Xs\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}\PY{p}{)}
          \PY{n}{y\PYZus{}true}\PY{p}{,} \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{knn\PYZus{}model\PYZus{}2}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{Xs\PYZus{}test}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{y\PYZus{}true}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
k-NN score for test set: 0.878244
k-NN score for training set: 0.913000
             precision    recall  f1-score   support

          0       0.60      0.10      0.16        63
          1       0.88      0.99      0.93       438

avg / total       0.85      0.88      0.84       501


    \end{Verbatim}

    All these measures improved by 3.25\% improvement and significant! As
hinted at above, before scaling there were a number of predictor
variables with ranges of different order of magnitudes, meaning that one
or two of them could dominate in the context of an algorithm such as
k-NN. The two main reasons for scaling our data are

Our predictor variables may have significantly different ranges and, in
certain situations, such as when implementing k-NN, this needs to be
mitigated so that certain features do not dominate the algorithm; We
want our features to be unit-independent, that is, not reliant on the
scale of the measurement involved. If we both scale our respective data,
this feature will be the same for each of us.

    \section{Decision Tree Classifier}\label{decision-tree-classifier}

Using Scikit-learn, optimization of decision tree classifier performed
by only pre-pruning. Maximum depth of the tree can be used as a control
variable for pre-pruning. In the following the example, we can plot a
decision tree on the same data with max\_depth=4. Other than pre-pruning
parameters, We have also tried other attribute selection measure such as
entropy This pruned model is less complex, explainable, and easy to
understand than the previous decision tree model plot.

Pros

Decision trees are easy to interpret and visualize.

It can easily capture Non-linear patterns.

It requires fewer data preprocessing from the user, for example, there
is no need to normalize columns.

It can be used for feature engineering such as predicting missing
values, suitable for variable selection.

The decision tree has no assumptions about distribution because of the
non-parametric nature of the algorithm.

Cons

Sensitive to noisy data. It can overfit noisy data.

The small variation(or variance) in data can result in the different
decision tree.

Decision trees are biased with imbalance dataset, so we can balance out
the dataset before creating the decision tree.

    \section{Decision Tree Algorithm}\label{decision-tree-algorithm}

A decision tree is a flowchart-like tree structure where an internal
node represents feature(or attribute), the branch represents a decision
rule, and each leaf node represents the outcome. The topmost node in a
decision tree is known as the root node. It learns to partition on the
basis of the attribute value. It partitions the tree in recursively
manner call recursive partitioning. This flowchart-like structure helps
you in decision making. It's visualization like a flowchart diagram
which easily mimics the human level thinking. That is why decision trees
are easy to understand and interpret.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}146}]:} \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{tree} \PY{k}{import} \PY{n}{DecisionTreeClassifier} \PY{c+c1}{\PYZsh{} Import Decision Tree Classifier}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split} \PY{c+c1}{\PYZsh{} Import train\PYZus{}test\PYZus{}split function}
          \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics} \PY{c+c1}{\PYZsh{}Import scikit\PYZhy{}learn metrics module for accuracy calculation}
          \PY{c+c1}{\PYZsh{} Split dataset into training set and test set}
          \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
          \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fix\PYZus{}True}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          
          \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)} \PY{c+c1}{\PYZsh{} 70\PYZpc{} training and 30\PYZpc{} test}
          
          \PY{c+c1}{\PYZsh{}Building Decision Tree Model Let\PYZsq{}s create a Decision Tree Model using Scikit\PYZhy{}learn.}
          \PY{c+c1}{\PYZsh{} Create Decision Tree classifer object}
          \PY{n}{clf} \PY{o}{=} \PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Train Decision Tree Classifer}
          \PY{n}{clf} \PY{o}{=} \PY{n}{clf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}Predict the response for test dataset}
          \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{clf}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Model Accuracy, how often is the classifier correct?}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} Import scale}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{scale}
          \PY{c+c1}{\PYZsh{} Scale the features: X\PYZus{}scaled}
          \PY{n}{X\PYZus{}scaled} \PY{o}{=} \PY{n}{scale}\PY{p}{(}\PY{n}{X}\PY{p}{)}
          
          \PY{n}{clf}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          \PY{n}{y\PYZus{}pred\PYZus{}dt} \PY{o}{=} \PY{n}{clf}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          \PY{n}{y\PYZus{}pred\PYZus{}dt\PYZus{}out} \PY{o}{=} \PY{n}{clf}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{l+m+mi}{975}\PY{p}{:}\PY{l+m+mi}{995}\PY{p}{,}\PY{p}{]}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DecisionTre Confussion Matrix: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}dt}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{sample\PYZus{}weight}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{dt\PYZus{}accuracy} \PY{o}{=} \PY{n}{clf}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Decision Tree Classifier Accuracy : }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{dt\PYZus{}accuracy}\PY{p}{)} 
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Decision Tree Classifier : \PYZhy{} Input of Real Data : Fix\PYZus{}True =1 \PYZam{} ARM =0: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{X}\PY{p}{[}\PY{l+m+mi}{975}\PY{p}{:}\PY{l+m+mi}{995}\PY{p}{,}\PY{p}{]}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Decision Tree Classifier : \PYZhy{} Output of X[975:995]: Fix\PYZus{}True =1 \PYZam{} ARM =0:}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,} \PY{n}{y}\PY{p}{[}\PY{l+m+mi}{975}\PY{p}{:}\PY{l+m+mi}{995}\PY{p}{]}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Decision Tree Classifier : \PYZhy{} Output of prediction: Fix\PYZus{}True =1 \PYZam{} ARM =0:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}dt\PYZus{}out}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy: 0.8388814913448736
DecisionTre Confussion Matrix: 
[[ 20  50]
 [ 71 610]]
Decision Tree Classifier Accuracy :  0.8388814913448736
Decision Tree Classifier : - Input of Real Data : Fix\_True =1 \& ARM =0:  [[ 3.    1.55  3.17  7.    4.    6.    4.5   1.96  5.4 ]
 [ 4.47  5.83  3.37 10.    1.    8.    4.6   1.71  5.4 ]
 [ 1.64  3.36  4.32  7.    2.    9.    4.    1.71  5.4 ]
 [ 3.25  2.29  3.79  7.    4.    7.    4.6   2.03  5.4 ]
 [ 4.05  1.55  3.18  7.    4.    6.    4.7   2.03  5.4 ]
 [ 2.27  3.18  3.83  7.    4.    6.    4.8   2.03  5.4 ]
 [ 6.25  2.84  3.58  7.    1.    7.    4.7   1.76  5.4 ]
 [ 1.84  1.27  3.31  1.    1.    7.    4.8   1.76  5.4 ]
 [ 3.46  5.75  0.34  7.    1.    7.    4.7   2.86  5.4 ]
 [ 1.86  4.54  3.55  1.    1.    8.    4.9   2.86  5.4 ]
 [ 9.4   0.4   3.09 10.    1.    7.    5.    2.86  5.4 ]
 [ 2.95  0.82  1.43  7.    4.    7.    4.9   2.    5.4 ]
 [ 4.42  2.05  3.44 10.    4.    6.    5.    2.    5.4 ]
 [ 4.8   4.32  1.13  0.    1.    7.    4.1   2.36  5.4 ]
 [ 7.44  0.2   2.81  9.    1.    6.    4.2   2.36  5.4 ]
 [ 3.88  2.68  3.58 10.    1.    5.    4.3   2.36  5.4 ]
 [ 6.8   0.94  4.    7.    1.    6.    5.4   2.9   5.4 ]
 [ 4.5   0.93  4.    0.    1.    7.    5.5   2.9   5.4 ]
 [ 3.64  3.87  3.94  7.    1.    7.    5.6   2.9   5.4 ]
 [15.    0.12  2.81  6.    0.    2.    5.7   2.9   5.4 ]]
Decision Tree Classifier : - Output of X[975:995]: Fix\_True =1 \& ARM =0: [1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0]
Decision Tree Classifier : - Output of prediction: Fix\_True =1 \& ARM =0: [1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]

    \end{Verbatim}

    Decision Tree Classifier Accuracy : 0.838 or 84\%

    \section{Visualizing Decision Trees}\label{visualizing-decision-trees}

We have used Scikit-learn's export\_graphviz function for display the
tree within a Jupyter notebook. For plotting tree, you also need to
install graphviz and pydotplus. export\_graphviz function converts
decision tree classifier into dot file and pydotplus convert this dot
file to png or displayable form on Jupyter Notebook.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}147}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{tree} \PY{k}{import} \PY{n}{export\PYZus{}graphviz}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{externals}\PY{n+nn}{.}\PY{n+nn}{six} \PY{k}{import} \PY{n}{StringIO}
          \PY{k+kn}{from} \PY{n+nn}{IPython}\PY{n+nn}{.}\PY{n+nn}{display} \PY{k}{import} \PY{n}{Image}
          \PY{k+kn}{import} \PY{n+nn}{pydotplus}
          
          \PY{n}{col\PYZus{}names} \PY{o}{=} \PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
          
          \PY{n}{X} \PY{o}{=} \PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}X = (model\PYZus{}data.drop([\PYZsq{}Qualification FICO\PYZsq{}],1))}
          \PY{c+c1}{\PYZsh{}X = (model\PYZus{}data.drop([\PYZsq{}Home\PYZsq{}],1))}
          \PY{n}{y} \PY{o}{=} \PY{p}{(}\PY{n}{fit\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loan Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          
          \PY{n}{feature\PYZus{}cols} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{columns}
          
          \PY{n}{fit\PYZus{}data}\PY{o}{.}\PY{n}{columns}
          
          \PY{n}{dot\PYZus{}data} \PY{o}{=} \PY{n}{StringIO}\PY{p}{(}\PY{p}{)}
          \PY{n}{export\PYZus{}graphviz}\PY{p}{(}\PY{n}{clf}\PY{p}{,} \PY{n}{out\PYZus{}file}\PY{o}{=}\PY{n}{dot\PYZus{}data}\PY{p}{,}
                          \PY{n}{filled}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{rounded}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
                          \PY{n}{special\PYZus{}characters}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{feature\PYZus{}names} \PY{o}{=} \PY{n}{feature\PYZus{}cols}\PY{p}{,}\PY{n}{class\PYZus{}names}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{graph} \PY{o}{=} \PY{n}{pydotplus}\PY{o}{.}\PY{n}{graph\PYZus{}from\PYZus{}dot\PYZus{}data}\PY{p}{(}\PY{n}{dot\PYZus{}data}\PY{o}{.}\PY{n}{getvalue}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          \PY{n}{graph}\PY{o}{.}\PY{n}{write\PYZus{}png}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{c:/scripts/mwb/mortgage\PYZus{}dt.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{Image}\PY{p}{(}\PY{n}{graph}\PY{o}{.}\PY{n}{create\PYZus{}png}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

\texttt{\color{outcolor}Out[{\color{outcolor}147}]:}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_266_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    In Scikit-learn, optimization of decision tree classifier performed by
only pre-pruning. Maximum depth of the tree can be used as a control
variable for pre-pruning.

We can plot a decision tree on the same data with max\_depth=3. Other
than pre-pruning parameters, We can also try other attribute selection
measure such as entropy.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}153}]:} \PY{c+c1}{\PYZsh{} Create Decision Tree classifer object}
          \PY{n}{clf} \PY{o}{=} \PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{criterion}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{entropy}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Train Decision Tree Classifer}
          \PY{n}{clf} \PY{o}{=} \PY{n}{clf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}Predict the response for test dataset}
          \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{clf}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Model Accuracy, how often is the classifier correct?}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}Visualizing Decision Trees}
          \PY{n}{dot\PYZus{}data} \PY{o}{=} \PY{n}{StringIO}\PY{p}{(}\PY{p}{)}
          \PY{n}{export\PYZus{}graphviz}\PY{p}{(}\PY{n}{clf}\PY{p}{,} \PY{n}{out\PYZus{}file}\PY{o}{=}\PY{n}{dot\PYZus{}data}\PY{p}{,}
                          \PY{n}{filled}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{rounded}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
                          \PY{n}{special\PYZus{}characters}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{feature\PYZus{}names} \PY{o}{=} \PY{n}{feature\PYZus{}cols}\PY{p}{,}\PY{n}{class\PYZus{}names}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{graph} \PY{o}{=} \PY{n}{pydotplus}\PY{o}{.}\PY{n}{graph\PYZus{}from\PYZus{}dot\PYZus{}data}\PY{p}{(}\PY{n}{dot\PYZus{}data}\PY{o}{.}\PY{n}{getvalue}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          \PY{n}{graph}\PY{o}{.}\PY{n}{write\PYZus{}png}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{c:/scripts/mwb/mortgage\PYZus{}dt.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{Image}\PY{p}{(}\PY{n}{graph}\PY{o}{.}\PY{n}{create\PYZus{}png}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy: 0.9041278295605859

    \end{Verbatim}
\texttt{\color{outcolor}Out[{\color{outcolor}153}]:}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_268_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    plotted a decision tree on the same data with max\_depth=3. Easy to
visualize..

Decision tree model accuracy has also improved.


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
